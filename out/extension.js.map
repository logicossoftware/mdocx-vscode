{
  "version": 3,
  "sources": ["../node_modules/fflate/esm/index.mjs", "../node_modules/fzstd/esm/index.mjs", "../node_modules/@bokuweb/zstd-wasm/lib/zstd.ts", "../node_modules/@bokuweb/zstd-wasm/lib/module.ts", "../node_modules/@bokuweb/zstd-wasm/lib/errors/index.ts", "../node_modules/@bokuweb/zstd-wasm/lib/simple/decompress.ts", "../node_modules/@bokuweb/zstd-wasm/lib/simple/compress.ts", "../node_modules/@bokuweb/zstd-wasm/lib/simple/decompress_using_dict.ts", "../node_modules/@bokuweb/zstd-wasm/lib/simple/compress_using_dict.ts", "../node_modules/@bokuweb/zstd-wasm/lib/index.node.ts", "../node_modules/lz4js/util.js", "../node_modules/lz4js/xxh32.js", "../node_modules/lz4js/lz4.js", "../node_modules/ts-mdocx/src/mdocx/types.ts", "../node_modules/ts-mdocx/src/mdocx/constants.ts", "../node_modules/ts-mdocx/src/mdocx/binary.ts", "../node_modules/ts-mdocx/src/mdocx/compression.ts", "../node_modules/ts-mdocx/src/gob/internal.ts", "../node_modules/ts-mdocx/src/gob/decoder.ts", "../node_modules/ts-mdocx/src/mdocx/read.ts", "../node_modules/ts-mdocx/src/gob/encoder.ts", "../node_modules/ts-mdocx/src/mdocx/write.ts", "../node_modules/ts-mdocx/src/mdocx/validate.ts", "../node_modules/ts-mdocx/src/mdocx/resolve.ts", "../node_modules/ts-mdocx/src/mdocx/builder.ts", "../src/extension.ts", "../src/mdocxPreviewEditorProvider.ts", "../node_modules/marked/src/defaults.ts", "../node_modules/marked/src/helpers.ts", "../node_modules/marked/src/Tokenizer.ts", "../node_modules/marked/src/rules.ts", "../node_modules/marked/src/Lexer.ts", "../node_modules/marked/src/Renderer.ts", "../node_modules/marked/src/TextRenderer.ts", "../node_modules/marked/src/Parser.ts", "../node_modules/marked/src/Hooks.ts", "../node_modules/marked/src/Instance.ts", "../node_modules/marked/src/marked.ts", "../src/mdocxFileSystemProvider.ts", "../src/mdocxCompletionProvider.ts"],
  "sourcesContent": ["import { createRequire } from 'module';\nvar require = createRequire('/');\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\n// Mediocre shim\nvar Worker;\nvar workerAdd = \";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global\";\ntry {\n    Worker = require('worker_threads').Worker;\n}\ncatch (e) {\n}\nvar wk = Worker ? function (c, _, msg, transfer, cb) {\n    var done = false;\n    var w = new Worker(c + workerAdd, { eval: true })\n        .on('error', function (e) { return cb(e, null); })\n        .on('message', function (m) { return cb(null, m); })\n        .on('exit', function (c) {\n        if (c && !done)\n            cb(new Error('exited with code ' + c), null);\n    });\n    w.postMessage(msg, transfer);\n    w.terminate = function () {\n        done = true;\n        return Worker.prototype.terminate.call(w);\n    };\n    return w;\n} : function (_, __, ___, ____, cb) {\n    setImmediate(function () { return cb(new Error('async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)'), null); });\n    var NOP = function () { };\n    return {\n        terminate: NOP,\n        postMessage: NOP\n    };\n};\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return { b: b, r: r };\n};\nvar _a = freb(fleb, 2), fl = _a.b, revfl = _a.r;\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b.b, revfd = _b.r;\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    return new u8(v.subarray(s, e));\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, st, buf, dict) {\n    // source length       dict length\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n        return buf || new u8(0);\n    var noBuf = !buf;\n    // have to estimate size\n    var resize = noBuf || st.i != 2;\n    // no state\n    var noSt = st.i;\n    // Assumes roughly 33% compression ratio average\n    if (noBuf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (resize)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17\n        if (resize)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (resize)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                if (bt < dt) {\n                    var shift = dl - dt, dend = Math.min(dt, end);\n                    if (shift + bt < 0)\n                        err(3);\n                    for (; bt < dend; ++bt)\n                        buf[bt] = dict[shift + bt];\n                }\n                for (; bt < end; ++bt)\n                    buf[bt] = buf[bt - dt];\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    // don't reallocate for streams or user buffers\n    return bt != buf.length && noBuf ? slc(buf, 0, bt) : buf.subarray(0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n    d[o + 2] |= v >> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return { t: et, l: 0 };\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return { t: v, l: 1 };\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return { t: new u8(tr), l: mbt };\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return { c: cl.subarray(0, cli), n: s };\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a.t, mlb = _a.l;\n    var _b = hTree(df, 15), ddt = _b.t, mdb = _b.l;\n    var _c = lc(dlt), lclt = _c.c, nlc = _c.n;\n    var _d = lc(ddt), lcdt = _d.c, ndc = _d.n;\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        ++lcfreq[lclt[i] & 31];\n    for (var i = 0; i < lcdt.length; ++i)\n        ++lcfreq[lcdt[i] & 31];\n    var _e = hTree(lcfreq, 7), lct = _e.t, mlcb = _e.l;\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n    if (bs >= 0 && flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        var sym = syms[i];\n        if (sym > 255) {\n            var len = (sym >> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n            var dst = sym & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[sym]), p += ll[sym];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, st) {\n    var s = st.z || dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var lst = st.l;\n    var pos = (st.r || 0) & 7;\n    if (lvl) {\n        if (pos)\n            w[0] = st.r >> 3;\n        var opt = deo[lvl - 1];\n        var n = opt >> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = st.p || new u16(32768), head = st.h || new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new i32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n        var lc_1 = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n        for (; i + 2 < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && (rem > 423 || !lst)) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = i - dif + j & 32767;\n                                    var pti = prev[ti];\n                                    var cd = ti - pti & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += imod - pimod & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one int32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        for (i = Math.max(i, wi); i < s; ++i) {\n            syms[li++] = dat[i];\n            ++lf[dat[i]];\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        if (!lst) {\n            st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n            // shft(pos) now 1 less if pos & 7 != 0\n            pos -= 7;\n            st.h = head, st.p = prev, st.i = i, st.w = wi;\n        }\n    }\n    else {\n        for (var i = st.w || 0; i < s + lst; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[(pos / 8) | 0] = lst;\n                e = s;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n        st.i = s;\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Adler32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    if (!st) {\n        st = { l: 1 };\n        if (opt.dictionary) {\n            var dict = opt.dictionary.subarray(-32768);\n            var newDat = new u8(dict.length + dat.length);\n            newDat.set(dict);\n            newDat.set(dat, dict.length);\n            dat = newDat;\n            st.w = dict.length;\n        }\n    }\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? (st.l ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 20) : (12 + opt.mem), pre, post, st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return fnStr;\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            fnStr = wcln(fns[i], fnStr, td_1);\n        ch[id] = { c: wcln(fns[m], fnStr, td_1), e: td_1 };\n    }\n    var td = mrg({}, ch[id].e);\n    return wk(ch[id].c + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, i32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gopt]; };\nvar bDflt = function () { return [u8, u16, i32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zls]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get opts\nvar gopt = function (o) { return o && {\n    out: o.size && new u8(o.size),\n    dictionary: o.dictionary\n}; };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) {\n        if (ev.data.length) {\n            strm.push(ev.data[0], ev.data[1]);\n            postMessage([ev.data[0].length]);\n        }\n        else\n            strm.flush();\n    };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id, flush, ext) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else if (!Array.isArray(dat))\n            ext(dat);\n        else if (dat.length == 1) {\n            strm.queuedSize -= dat[0];\n            if (strm.ondrain)\n                strm.ondrain(dat[0]);\n        }\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.queuedSize = 0;\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        strm.queuedSize += d.length;\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n    if (flush) {\n        strm.flush = function () { w.postMessage([]); };\n    }\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + (o.filename ? o.filename.length + 1 : 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (o.dictionary && 32);\n    c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n    if (o.dictionary) {\n        var h = adler();\n        h.p(o.dictionary);\n        wbytes(c, 2, h.d());\n    }\n};\n// zlib start\nvar zls = function (d, dict) {\n    if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if ((d[1] >> 5 & 1) == +!dict)\n        err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n    return (d[1] >> 3 & 4) + 2;\n};\nfunction StrmOpt(opts, cb) {\n    if (typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n        this.s = { l: 0, i: 32768, w: 32768, z: 32768 };\n        // Buffer length must always be 0 mod 32768 for index calculations to be correct when modifying head and prev\n        // 98304 = 32768 (lookback) + 65536 (common chunk size)\n        this.b = new u8(98304);\n        if (this.o.dictionary) {\n            var dict = this.o.dictionary.subarray(-32768);\n            this.b.set(dict, 32768 - dict.length);\n            this.s.i = 32768 - dict.length;\n        }\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, this.s), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        var endLen = chunk.length + this.s.z;\n        if (endLen > this.b.length) {\n            if (endLen > 2 * this.b.length - 32768) {\n                var newBuf = new u8(endLen & -32768);\n                newBuf.set(this.b.subarray(0, this.s.z));\n                this.b = newBuf;\n            }\n            var split = this.b.length - this.s.z;\n            this.b.set(chunk.subarray(0, split), this.s.z);\n            this.s.z = this.b.length;\n            this.p(this.b, false);\n            this.b.set(this.b.subarray(-32768));\n            this.b.set(chunk.subarray(split), 32768);\n            this.s.z = chunk.length - split + 32768;\n            this.s.i = 32766, this.s.w = 32768;\n        }\n        else {\n            this.b.set(chunk, this.s.z);\n            this.s.z += chunk.length;\n        }\n        this.s.l = final & 1;\n        if (this.s.z > this.s.w + 8191 || final) {\n            this.p(this.b, final || false);\n            this.s.w = this.s.i, this.s.i -= 2;\n        }\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * deflated output for small inputs.\n     */\n    Deflate.prototype.flush = function () {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        this.p(this.b, false);\n        this.s.w = this.s.i, this.s.i -= 2;\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6, 1);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    function Inflate(opts, cb) {\n        // no StrmOpt here to avoid adding to workerizer\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        var dict = opts && opts.dictionary && opts.dictionary.subarray(-32768);\n        this.s = { i: 0, b: dict ? dict.length : 0 };\n        this.o = new u8(32768);\n        this.p = new u8(0);\n        if (dict)\n            this.o.set(dict);\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        if (!this.p.length)\n            this.p = c;\n        else if (c.length) {\n            var n = new u8(this.p.length + c.length);\n            n.set(this.p), n.set(c, this.p.length), this.p = n;\n        }\n    };\n    Inflate.prototype.c = function (final) {\n        this.s.i = +(this.d = final || false);\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.s, this.o);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    function AsyncInflate(opts, cb) {\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Inflate(ev.data);\n            onmessage = astrm(strm);\n        }, 7, 0);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gopt(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        this.l += chunk.length;\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, this.s);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * GZIPped output for small inputs.\n     */\n    Gzip.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8, 1);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming single or multi-member GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    function Gunzip(opts, cb) {\n        this.v = 1;\n        this.r = 0;\n        Inflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        this.r += chunk.length;\n        if (this.v) {\n            var p = this.p.subarray(this.v - 1);\n            var s = p.length > 3 ? gzs(p) : 4;\n            if (s > p.length) {\n                if (!final)\n                    return;\n            }\n            else if (this.v > 1 && this.onmember) {\n                this.onmember(this.r - p.length);\n            }\n            this.p = p.subarray(s), this.v = 0;\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n        // process concatenated GZIP\n        if (this.s.f && !this.s.l && !final) {\n            this.v = shft(this.s.p) + 9;\n            this.s = { i: 0 };\n            this.o = new u8(0);\n            this.push(new u8(0), final);\n        }\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming single or multi-member GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    function AsyncGunzip(opts, cb) {\n        var _this = this;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gunzip(ev.data);\n            strm.onmember = function (offset) { return postMessage(offset); };\n            onmessage = astrm(strm);\n        }, 9, 0, function (offset) { return _this.onmember && _this.onmember(offset); });\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0], ev.data[1])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n        err(6, 'invalid gzip data');\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && (this.o.dictionary ? 6 : 2), f && 4, this.s);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * zlibbed output for small inputs.\n     */\n    Zlib.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10, 1);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    function Unzlib(opts, cb) {\n        Inflate.call(this, opts, cb);\n        this.v = opts && opts.dictionary ? 2 : 1;\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 6 && !final)\n                return;\n            this.p = this.p.subarray(zls(this.p, this.v - 1)), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    function AsyncUnzlib(opts, cb) {\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Unzlib(ev.data);\n            onmessage = astrm(strm);\n        }, 11, 0);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gopt(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    function Decompress(opts, cb) {\n        this.o = StrmOpt.call(this, opts, cb) || {};\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n    }\n    // init substream\n    // overriden by AsyncDecompress\n    Decompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (dat, final) {\n            _this.ondata(dat, final);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(this.o)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(this.o)\n                        : new this.Z(this.o);\n                this.i();\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    function AsyncDecompress(opts, cb) {\n        Decompress.call(this, opts, cb);\n        this.queuedSize = 0;\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n    }\n    AsyncDecompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        };\n        this.s.ondrain = function (size) {\n            _this.queuedSize -= size;\n            if (_this.ondrain)\n                _this.ondrain(size);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        this.queuedSize += chunk.length;\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, opts) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, opts)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, opts)\n            : unzlibSync(data, opts);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return { s: r, r: slc(d, i - 1) };\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (final) {\n            if (r.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = r;\n        this.ondata(s, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td) {\n        return td.decode(dat);\n    }\n    else {\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (r.length)\n            err(8);\n        return s;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this.ondata(err, dat, final);\n                    _this.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this.d & 1))\n                        return;\n                    _this.u.splice(-1, 1);\n                    _this.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this = this;\n        this.i = new Inflate(function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this.k[0] == chks_3 && _this.c)\n                                        _this.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    // Synchronously decompress under 512KB, or barely-compressed data\n                    if (su < 524288 || sc > 0.8 * su) {\n                        try {\n                            cbl(null, inflateSync(infl, { out: new u8(su) }));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), { out: new u8(su) });\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n", "// Some numerical data is initialized as -1 even when it doesn't need initialization to help the JIT infer types\n// aliases for shorter compressed code (most minifers don't do this)\nvar ab = ArrayBuffer, u8 = Uint8Array, u16 = Uint16Array, i16 = Int16Array, u32 = Uint32Array, i32 = Int32Array;\nvar slc = function (v, s, e) {\n    if (u8.prototype.slice)\n        return u8.prototype.slice.call(v, s, e);\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    var n = new u8(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\nvar fill = function (v, n, s, e) {\n    if (u8.prototype.fill)\n        return u8.prototype.fill.call(v, n, s, e);\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    for (; s < e; ++s)\n        v[s] = n;\n    return v;\n};\nvar cpw = function (v, t, s, e) {\n    if (u8.prototype.copyWithin)\n        return u8.prototype.copyWithin.call(v, t, s, e);\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    while (s < e) {\n        v[t++] = v[s++];\n    }\n};\n/**\n * Codes for errors generated within this library\n */\nexport var ZstdErrorCode = {\n    InvalidData: 0,\n    WindowSizeTooLarge: 1,\n    InvalidBlockType: 2,\n    FSEAccuracyTooHigh: 3,\n    DistanceTooFarBack: 4,\n    UnexpectedEOF: 5\n};\n// error codes\nvar ec = [\n    'invalid zstd data',\n    'window size too large (>2046MB)',\n    'invalid block type',\n    'FSE accuracy too high',\n    'match distance too far back',\n    'unexpected EOF'\n];\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\nvar rb = function (d, b, n) {\n    var i = 0, o = 0;\n    for (; i < n; ++i)\n        o |= d[b++] << (i << 3);\n    return o;\n};\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\n// read Zstandard frame header\nvar rzfh = function (dat, w) {\n    var n3 = dat[0] | (dat[1] << 8) | (dat[2] << 16);\n    if (n3 == 0x2FB528 && dat[3] == 253) {\n        // Zstandard\n        var flg = dat[4];\n        //    single segment       checksum             dict flag     frame content flag\n        var ss = (flg >> 5) & 1, cc = (flg >> 2) & 1, df = flg & 3, fcf = flg >> 6;\n        if (flg & 8)\n            err(0);\n        // byte\n        var bt = 6 - ss;\n        // dict bytes\n        var db = df == 3 ? 4 : df;\n        // dictionary id\n        var di = rb(dat, bt, db);\n        bt += db;\n        // frame size bytes\n        var fsb = fcf ? (1 << fcf) : ss;\n        // frame source size\n        var fss = rb(dat, bt, fsb) + ((fcf == 1) && 256);\n        // window size\n        var ws = fss;\n        if (!ss) {\n            // window descriptor\n            var wb = 1 << (10 + (dat[5] >> 3));\n            ws = wb + (wb >> 3) * (dat[5] & 7);\n        }\n        if (ws > 2145386496)\n            err(1);\n        var buf = new u8((w == 1 ? (fss || ws) : w ? 0 : ws) + 12);\n        buf[0] = 1, buf[4] = 4, buf[8] = 8;\n        return {\n            b: bt + fsb,\n            y: 0,\n            l: 0,\n            d: di,\n            w: (w && w != 1) ? w : buf.subarray(12),\n            e: ws,\n            o: new i32(buf.buffer, 0, 3),\n            u: fss,\n            c: cc,\n            m: Math.min(131072, ws)\n        };\n    }\n    else if (((n3 >> 4) | (dat[3] << 20)) == 0x184D2A5) {\n        // skippable\n        return b4(dat, 4) + 8;\n    }\n    err(0);\n};\n// most significant bit for nonzero\nvar msb = function (val) {\n    var bits = 0;\n    for (; (1 << bits) <= val; ++bits)\n        ;\n    return bits - 1;\n};\n// read finite state entropy\nvar rfse = function (dat, bt, mal) {\n    // table pos\n    var tpos = (bt << 3) + 4;\n    // accuracy log\n    var al = (dat[bt] & 15) + 5;\n    if (al > mal)\n        err(3);\n    // size\n    var sz = 1 << al;\n    // probabilities symbols  repeat   index   high threshold\n    var probs = sz, sym = -1, re = -1, i = -1, ht = sz;\n    // optimization: single allocation is much faster\n    var buf = new ab(512 + (sz << 2));\n    var freq = new i16(buf, 0, 256);\n    // same view as freq\n    var dstate = new u16(buf, 0, 256);\n    var nstate = new u16(buf, 512, sz);\n    var bb1 = 512 + (sz << 1);\n    var syms = new u8(buf, bb1, sz);\n    var nbits = new u8(buf, bb1 + sz);\n    while (sym < 255 && probs > 0) {\n        var bits = msb(probs + 1);\n        var cbt = tpos >> 3;\n        // mask\n        var msk = (1 << (bits + 1)) - 1;\n        var val = ((dat[cbt] | (dat[cbt + 1] << 8) | (dat[cbt + 2] << 16)) >> (tpos & 7)) & msk;\n        // mask (1 fewer bit)\n        var msk1fb = (1 << bits) - 1;\n        // max small value\n        var msv = msk - probs - 1;\n        // small value\n        var sval = val & msk1fb;\n        if (sval < msv)\n            tpos += bits, val = sval;\n        else {\n            tpos += bits + 1;\n            if (val > msk1fb)\n                val -= msv;\n        }\n        freq[++sym] = --val;\n        if (val == -1) {\n            probs += val;\n            syms[--ht] = sym;\n        }\n        else\n            probs -= val;\n        if (!val) {\n            do {\n                // repeat byte\n                var rbt = tpos >> 3;\n                re = ((dat[rbt] | (dat[rbt + 1] << 8)) >> (tpos & 7)) & 3;\n                tpos += 2;\n                sym += re;\n            } while (re == 3);\n        }\n    }\n    if (sym > 255 || probs)\n        err(0);\n    var sympos = 0;\n    // sym step (coprime with sz - formula from zstd source)\n    var sstep = (sz >> 1) + (sz >> 3) + 3;\n    // sym mask\n    var smask = sz - 1;\n    for (var s = 0; s <= sym; ++s) {\n        var sf = freq[s];\n        if (sf < 1) {\n            dstate[s] = -sf;\n            continue;\n        }\n        // This is split into two loops in zstd to avoid branching, but as JS is higher-level that is unnecessary\n        for (i = 0; i < sf; ++i) {\n            syms[sympos] = s;\n            do {\n                sympos = (sympos + sstep) & smask;\n            } while (sympos >= ht);\n        }\n    }\n    // After spreading symbols, should be zero again\n    if (sympos)\n        err(0);\n    for (i = 0; i < sz; ++i) {\n        // next state\n        var ns = dstate[syms[i]]++;\n        // num bits\n        var nb = nbits[i] = al - msb(ns);\n        nstate[i] = (ns << nb) - sz;\n    }\n    return [(tpos + 7) >> 3, {\n            b: al,\n            s: syms,\n            n: nbits,\n            t: nstate\n        }];\n};\n// read huffman\nvar rhu = function (dat, bt) {\n    //  index  weight count\n    var i = 0, wc = -1;\n    //    buffer             header byte\n    var buf = new u8(292), hb = dat[bt];\n    // huffman weights\n    var hw = buf.subarray(0, 256);\n    // rank count\n    var rc = buf.subarray(256, 268);\n    // rank index\n    var ri = new u16(buf.buffer, 268);\n    // NOTE: at this point bt is 1 less than expected\n    if (hb < 128) {\n        // end byte, fse decode table\n        var _a = rfse(dat, bt + 1, 6), ebt = _a[0], fdt = _a[1];\n        bt += hb;\n        var epos = ebt << 3;\n        // last byte\n        var lb = dat[bt];\n        if (!lb)\n            err(0);\n        //  state1   state2   state1 bits   state2 bits\n        var st1 = 0, st2 = 0, btr1 = fdt.b, btr2 = btr1;\n        // fse pos\n        // pre-increment to account for original deficit of 1\n        var fpos = (++bt << 3) - 8 + msb(lb);\n        for (;;) {\n            fpos -= btr1;\n            if (fpos < epos)\n                break;\n            var cbt = fpos >> 3;\n            st1 += ((dat[cbt] | (dat[cbt + 1] << 8)) >> (fpos & 7)) & ((1 << btr1) - 1);\n            hw[++wc] = fdt.s[st1];\n            fpos -= btr2;\n            if (fpos < epos)\n                break;\n            cbt = fpos >> 3;\n            st2 += ((dat[cbt] | (dat[cbt + 1] << 8)) >> (fpos & 7)) & ((1 << btr2) - 1);\n            hw[++wc] = fdt.s[st2];\n            btr1 = fdt.n[st1];\n            st1 = fdt.t[st1];\n            btr2 = fdt.n[st2];\n            st2 = fdt.t[st2];\n        }\n        if (++wc > 255)\n            err(0);\n    }\n    else {\n        wc = hb - 127;\n        for (; i < wc; i += 2) {\n            var byte = dat[++bt];\n            hw[i] = byte >> 4;\n            hw[i + 1] = byte & 15;\n        }\n        ++bt;\n    }\n    // weight exponential sum\n    var wes = 0;\n    for (i = 0; i < wc; ++i) {\n        var wt = hw[i];\n        // bits must be at most 11, same as weight\n        if (wt > 11)\n            err(0);\n        wes += wt && (1 << (wt - 1));\n    }\n    // max bits\n    var mb = msb(wes) + 1;\n    // table size\n    var ts = 1 << mb;\n    // remaining sum\n    var rem = ts - wes;\n    // must be power of 2\n    if (rem & (rem - 1))\n        err(0);\n    hw[wc++] = msb(rem) + 1;\n    for (i = 0; i < wc; ++i) {\n        var wt = hw[i];\n        ++rc[hw[i] = wt && (mb + 1 - wt)];\n    }\n    // huf buf\n    var hbuf = new u8(ts << 1);\n    //    symbols                      num bits\n    var syms = hbuf.subarray(0, ts), nb = hbuf.subarray(ts);\n    ri[mb] = 0;\n    for (i = mb; i > 0; --i) {\n        var pv = ri[i];\n        fill(nb, i, pv, ri[i - 1] = pv + rc[i] * (1 << (mb - i)));\n    }\n    if (ri[0] != ts)\n        err(0);\n    for (i = 0; i < wc; ++i) {\n        var bits = hw[i];\n        if (bits) {\n            var code = ri[bits];\n            fill(syms, i, code, ri[bits] = code + (1 << (mb - bits)));\n        }\n    }\n    return [bt, {\n            n: nb,\n            b: mb,\n            s: syms\n        }];\n};\n// Tables generated using this:\n// https://gist.github.com/101arrowz/a979452d4355992cbf8f257cbffc9edd\n// default literal length table\nvar dllt = /*#__PURE__*/ rfse(/*#__PURE__*/ new u8([\n    81, 16, 99, 140, 49, 198, 24, 99, 12, 33, 196, 24, 99, 102, 102, 134, 70, 146, 4\n]), 0, 6)[1];\n// default match length table\nvar dmlt = /*#__PURE__*/ rfse(/*#__PURE__*/ new u8([\n    33, 20, 196, 24, 99, 140, 33, 132, 16, 66, 8, 33, 132, 16, 66, 8, 33, 68, 68, 68, 68, 68, 68, 68, 68, 36, 9\n]), 0, 6)[1];\n// default offset code table\nvar doct = /*#__PURE__ */ rfse(/*#__PURE__*/ new u8([\n    32, 132, 16, 66, 102, 70, 68, 68, 68, 68, 36, 73, 2\n]), 0, 5)[1];\n// bits to baseline\nvar b2bl = function (b, s) {\n    var len = b.length, bl = new i32(len);\n    for (var i = 0; i < len; ++i) {\n        bl[i] = s;\n        s += 1 << b[i];\n    }\n    return bl;\n};\n// literal length bits\nvar llb = /*#__PURE__ */ new u8(( /*#__PURE__ */new i32([\n    0, 0, 0, 0, 16843009, 50528770, 134678020, 202050057, 269422093\n])).buffer, 0, 36);\n// literal length baseline\nvar llbl = /*#__PURE__ */ b2bl(llb, 0);\n// match length bits\nvar mlb = /*#__PURE__ */ new u8(( /*#__PURE__ */new i32([\n    0, 0, 0, 0, 0, 0, 0, 0, 16843009, 50528770, 117769220, 185207048, 252579084, 16\n])).buffer, 0, 53);\n// match length baseline\nvar mlbl = /*#__PURE__ */ b2bl(mlb, 3);\n// decode huffman stream\nvar dhu = function (dat, out, hu) {\n    var len = dat.length, ss = out.length, lb = dat[len - 1], msk = (1 << hu.b) - 1, eb = -hu.b;\n    if (!lb)\n        err(0);\n    var st = 0, btr = hu.b, pos = (len << 3) - 8 + msb(lb) - btr, i = -1;\n    for (; pos > eb && i < ss;) {\n        var cbt = pos >> 3;\n        var val = (dat[cbt] | (dat[cbt + 1] << 8) | (dat[cbt + 2] << 16)) >> (pos & 7);\n        st = ((st << btr) | val) & msk;\n        out[++i] = hu.s[st];\n        pos -= (btr = hu.n[st]);\n    }\n    if (pos != eb || i + 1 != ss)\n        err(0);\n};\n// decode huffman stream 4x\n// TODO: use workers to parallelize\nvar dhu4 = function (dat, out, hu) {\n    var bt = 6;\n    var ss = out.length, sz1 = (ss + 3) >> 2, sz2 = sz1 << 1, sz3 = sz1 + sz2;\n    dhu(dat.subarray(bt, bt += dat[0] | (dat[1] << 8)), out.subarray(0, sz1), hu);\n    dhu(dat.subarray(bt, bt += dat[2] | (dat[3] << 8)), out.subarray(sz1, sz2), hu);\n    dhu(dat.subarray(bt, bt += dat[4] | (dat[5] << 8)), out.subarray(sz2, sz3), hu);\n    dhu(dat.subarray(bt), out.subarray(sz3), hu);\n};\n// read Zstandard block\nvar rzb = function (dat, st, out) {\n    var _a;\n    var bt = st.b;\n    //    byte 0        block type\n    var b0 = dat[bt], btype = (b0 >> 1) & 3;\n    st.l = b0 & 1;\n    var sz = (b0 >> 3) | (dat[bt + 1] << 5) | (dat[bt + 2] << 13);\n    // end byte for block\n    var ebt = (bt += 3) + sz;\n    if (btype == 1) {\n        if (bt >= dat.length)\n            return;\n        st.b = bt + 1;\n        if (out) {\n            fill(out, dat[bt], st.y, st.y += sz);\n            return out;\n        }\n        return fill(new u8(sz), dat[bt]);\n    }\n    if (ebt > dat.length)\n        return;\n    if (btype == 0) {\n        st.b = ebt;\n        if (out) {\n            out.set(dat.subarray(bt, ebt), st.y);\n            st.y += sz;\n            return out;\n        }\n        return slc(dat, bt, ebt);\n    }\n    if (btype == 2) {\n        //    byte 3        lit btype     size format\n        var b3 = dat[bt], lbt = b3 & 3, sf = (b3 >> 2) & 3;\n        // lit src size  lit cmp sz 4 streams\n        var lss = b3 >> 4, lcs = 0, s4 = 0;\n        if (lbt < 2) {\n            if (sf & 1)\n                lss |= (dat[++bt] << 4) | ((sf & 2) && (dat[++bt] << 12));\n            else\n                lss = b3 >> 3;\n        }\n        else {\n            s4 = sf;\n            if (sf < 2)\n                lss |= ((dat[++bt] & 63) << 4), lcs = (dat[bt] >> 6) | (dat[++bt] << 2);\n            else if (sf == 2)\n                lss |= (dat[++bt] << 4) | ((dat[++bt] & 3) << 12), lcs = (dat[bt] >> 2) | (dat[++bt] << 6);\n            else\n                lss |= (dat[++bt] << 4) | ((dat[++bt] & 63) << 12), lcs = (dat[bt] >> 6) | (dat[++bt] << 2) | (dat[++bt] << 10);\n        }\n        ++bt;\n        // add literals to end - can never overlap with backreferences because unused literals always appended\n        var buf = out ? out.subarray(st.y, st.y + st.m) : new u8(st.m);\n        // starting point for literals\n        var spl = buf.length - lss;\n        if (lbt == 0)\n            buf.set(dat.subarray(bt, bt += lss), spl);\n        else if (lbt == 1)\n            fill(buf, dat[bt++], spl);\n        else {\n            // huffman table\n            var hu = st.h;\n            if (lbt == 2) {\n                var hud = rhu(dat, bt);\n                // subtract description length\n                lcs += bt - (bt = hud[0]);\n                st.h = hu = hud[1];\n            }\n            else if (!hu)\n                err(0);\n            (s4 ? dhu4 : dhu)(dat.subarray(bt, bt += lcs), buf.subarray(spl), hu);\n        }\n        // num sequences\n        var ns = dat[bt++];\n        if (ns) {\n            if (ns == 255)\n                ns = (dat[bt++] | (dat[bt++] << 8)) + 0x7F00;\n            else if (ns > 127)\n                ns = ((ns - 128) << 8) | dat[bt++];\n            // symbol compression modes\n            var scm = dat[bt++];\n            if (scm & 3)\n                err(0);\n            var dts = [dmlt, doct, dllt];\n            for (var i = 2; i > -1; --i) {\n                var md = (scm >> ((i << 1) + 2)) & 3;\n                if (md == 1) {\n                    // rle buf\n                    var rbuf = new u8([0, 0, dat[bt++]]);\n                    dts[i] = {\n                        s: rbuf.subarray(2, 3),\n                        n: rbuf.subarray(0, 1),\n                        t: new u16(rbuf.buffer, 0, 1),\n                        b: 0\n                    };\n                }\n                else if (md == 2) {\n                    // accuracy log 8 for offsets, 9 for others\n                    _a = rfse(dat, bt, 9 - (i & 1)), bt = _a[0], dts[i] = _a[1];\n                }\n                else if (md == 3) {\n                    if (!st.t)\n                        err(0);\n                    dts[i] = st.t[i];\n                }\n            }\n            var _b = st.t = dts, mlt = _b[0], oct = _b[1], llt = _b[2];\n            var lb = dat[ebt - 1];\n            if (!lb)\n                err(0);\n            var spos = (ebt << 3) - 8 + msb(lb) - llt.b, cbt = spos >> 3, oubt = 0;\n            var lst = ((dat[cbt] | (dat[cbt + 1] << 8)) >> (spos & 7)) & ((1 << llt.b) - 1);\n            cbt = (spos -= oct.b) >> 3;\n            var ost = ((dat[cbt] | (dat[cbt + 1] << 8)) >> (spos & 7)) & ((1 << oct.b) - 1);\n            cbt = (spos -= mlt.b) >> 3;\n            var mst = ((dat[cbt] | (dat[cbt + 1] << 8)) >> (spos & 7)) & ((1 << mlt.b) - 1);\n            for (++ns; --ns;) {\n                var llc = llt.s[lst];\n                var lbtr = llt.n[lst];\n                var mlc = mlt.s[mst];\n                var mbtr = mlt.n[mst];\n                var ofc = oct.s[ost];\n                var obtr = oct.n[ost];\n                cbt = (spos -= ofc) >> 3;\n                var ofp = 1 << ofc;\n                var off = ofp + (((dat[cbt] | (dat[cbt + 1] << 8) | (dat[cbt + 2] << 16) | (dat[cbt + 3] << 24)) >>> (spos & 7)) & (ofp - 1));\n                cbt = (spos -= mlb[mlc]) >> 3;\n                var ml = mlbl[mlc] + (((dat[cbt] | (dat[cbt + 1] << 8) | (dat[cbt + 2] << 16)) >> (spos & 7)) & ((1 << mlb[mlc]) - 1));\n                cbt = (spos -= llb[llc]) >> 3;\n                var ll = llbl[llc] + (((dat[cbt] | (dat[cbt + 1] << 8) | (dat[cbt + 2] << 16)) >> (spos & 7)) & ((1 << llb[llc]) - 1));\n                cbt = (spos -= lbtr) >> 3;\n                lst = llt.t[lst] + (((dat[cbt] | (dat[cbt + 1] << 8)) >> (spos & 7)) & ((1 << lbtr) - 1));\n                cbt = (spos -= mbtr) >> 3;\n                mst = mlt.t[mst] + (((dat[cbt] | (dat[cbt + 1] << 8)) >> (spos & 7)) & ((1 << mbtr) - 1));\n                cbt = (spos -= obtr) >> 3;\n                ost = oct.t[ost] + (((dat[cbt] | (dat[cbt + 1] << 8)) >> (spos & 7)) & ((1 << obtr) - 1));\n                if (off > 3) {\n                    st.o[2] = st.o[1];\n                    st.o[1] = st.o[0];\n                    st.o[0] = off -= 3;\n                }\n                else {\n                    var idx = off - (ll != 0);\n                    if (idx) {\n                        off = idx == 3 ? st.o[0] - 1 : st.o[idx];\n                        if (idx > 1)\n                            st.o[2] = st.o[1];\n                        st.o[1] = st.o[0];\n                        st.o[0] = off;\n                    }\n                    else\n                        off = st.o[0];\n                }\n                for (var i = 0; i < ll; ++i) {\n                    buf[oubt + i] = buf[spl + i];\n                }\n                oubt += ll, spl += ll;\n                var stin = oubt - off;\n                if (stin < 0) {\n                    var len = -stin;\n                    var bs = st.e + stin;\n                    if (len > ml)\n                        len = ml;\n                    for (var i = 0; i < len; ++i) {\n                        buf[oubt + i] = st.w[bs + i];\n                    }\n                    oubt += len, ml -= len, stin = 0;\n                }\n                for (var i = 0; i < ml; ++i) {\n                    buf[oubt + i] = buf[stin + i];\n                }\n                oubt += ml;\n            }\n            if (oubt != spl) {\n                while (spl < buf.length) {\n                    buf[oubt++] = buf[spl++];\n                }\n            }\n            else\n                oubt = buf.length;\n            if (out)\n                st.y += oubt;\n            else\n                buf = slc(buf, 0, oubt);\n        }\n        else if (out) {\n            st.y += lss;\n            if (spl) {\n                for (var i = 0; i < lss; ++i) {\n                    buf[i] = buf[spl + i];\n                }\n            }\n        }\n        else if (spl)\n            buf = slc(buf, spl);\n        st.b = ebt;\n        return buf;\n    }\n    err(2);\n};\n// concat\nvar cct = function (bufs, ol) {\n    if (bufs.length == 1)\n        return bufs[0];\n    var buf = new u8(ol);\n    for (var i = 0, b = 0; i < bufs.length; ++i) {\n        var chk = bufs[i];\n        buf.set(chk, b);\n        b += chk.length;\n    }\n    return buf;\n};\n/**\n * Decompresses Zstandard data\n * @param dat The input data\n * @param buf The output buffer. If unspecified, the function will allocate\n *            exactly enough memory to fit the decompressed data. If your\n *            data has multiple frames and you know the output size, specifying\n *            it will yield better performance.\n * @returns The decompressed data\n */\nexport function decompress(dat, buf) {\n    var bufs = [], nb = +!buf;\n    var bt = 0, ol = 0;\n    for (; dat.length;) {\n        var st = rzfh(dat, nb || buf);\n        if (typeof st == 'object') {\n            if (nb) {\n                buf = null;\n                if (st.w.length == st.u) {\n                    bufs.push(buf = st.w);\n                    ol += st.u;\n                }\n            }\n            else {\n                bufs.push(buf);\n                st.e = 0;\n            }\n            for (; !st.l;) {\n                var blk = rzb(dat, st, buf);\n                if (!blk)\n                    err(5);\n                if (buf)\n                    st.e = st.y;\n                else {\n                    bufs.push(blk);\n                    ol += blk.length;\n                    cpw(st.w, 0, blk.length);\n                    st.w.set(blk, st.w.length - blk.length);\n                }\n            }\n            bt = st.b + (st.c * 4);\n        }\n        else\n            bt = st;\n        dat = dat.subarray(bt);\n    }\n    return cct(bufs, ol);\n}\n/**\n * Decompressor for Zstandard streamed data\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zstandard decompressor\n     * @param ondata The handler for stream data\n     */\n    function Decompress(ondata) {\n        this.ondata = ondata;\n        this.c = [];\n        this.l = 0;\n        this.z = 0;\n    }\n    /**\n     * Pushes data to be decompressed\n     * @param chunk The chunk of data to push\n     * @param final Whether or not this is the last chunk in the stream\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (typeof this.s == 'number') {\n            var sub = Math.min(chunk.length, this.s);\n            chunk = chunk.subarray(sub);\n            this.s -= sub;\n        }\n        var sl = chunk.length;\n        var ncs = sl + this.l;\n        if (!this.s) {\n            if (final) {\n                if (!ncs) {\n                    this.ondata(new u8(0), true);\n                    return;\n                }\n                // min for frame + one block\n                if (ncs < 5)\n                    err(5);\n            }\n            else if (ncs < 18) {\n                this.c.push(chunk);\n                this.l = ncs;\n                return;\n            }\n            if (this.l) {\n                this.c.push(chunk);\n                chunk = cct(this.c, ncs);\n                this.c = [];\n                this.l = 0;\n            }\n            if (typeof (this.s = rzfh(chunk)) == 'number')\n                return this.push(chunk, final);\n        }\n        if (typeof this.s != 'number') {\n            if (ncs < (this.z || 3)) {\n                if (final)\n                    err(5);\n                this.c.push(chunk);\n                this.l = ncs;\n                return;\n            }\n            if (this.l) {\n                this.c.push(chunk);\n                chunk = cct(this.c, ncs);\n                this.c = [];\n                this.l = 0;\n            }\n            if (!this.z && ncs < (this.z = (chunk[this.s.b] & 2) ? 4 : 3 + ((chunk[this.s.b] >> 3) | (chunk[this.s.b + 1] << 5) | (chunk[this.s.b + 2] << 13)))) {\n                if (final)\n                    err(5);\n                this.c.push(chunk);\n                this.l = ncs;\n                return;\n            }\n            else\n                this.z = 0;\n            for (;;) {\n                var blk = rzb(chunk, this.s);\n                if (!blk) {\n                    if (final)\n                        err(5);\n                    var adc = chunk.subarray(this.s.b);\n                    this.s.b = 0;\n                    this.c.push(adc), this.l += adc.length;\n                    return;\n                }\n                else {\n                    this.ondata(blk, false);\n                    cpw(this.s.w, 0, blk.length);\n                    this.s.w.set(blk, this.s.w.length - blk.length);\n                }\n                if (this.s.l) {\n                    var rest = chunk.subarray(this.s.b);\n                    this.s = this.s.c * 4;\n                    this.push(rest, final);\n                    return;\n                }\n            }\n        }\n        else if (final)\n            err(5);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n", null, null, null, null, null, null, null, null, "// Simple hash function, from: http://burtleburtle.net/bob/hash/integer.html.\n// Chosen because it doesn't use multiply and achieves full avalanche.\nexports.hashU32 = function hashU32 (a) {\n  a = a | 0;\n  a = a + 2127912214 + (a << 12) | 0;\n  a = a ^ -949894596 ^ a >>> 19;\n  a = a + 374761393 + (a << 5) | 0;\n  a = a + -744332180 ^ a << 9;\n  a = a + -42973499 + (a << 3) | 0;\n  return a ^ -1252372727 ^ a >>> 16 | 0;\n};\n\n// Reads a 64-bit little-endian integer from an array.\nexports.readU64 = function readU64 (b, n) {\n  var x = 0;\n  x |= b[n++] << 0;\n  x |= b[n++] << 8;\n  x |= b[n++] << 16;\n  x |= b[n++] << 24;\n  x |= b[n++] << 32;\n  x |= b[n++] << 40;\n  x |= b[n++] << 48;\n  x |= b[n++] << 56;\n  return x;\n};\n\n// Reads a 32-bit little-endian integer from an array.\nexports.readU32 = function readU32 (b, n) {\n  var x = 0;\n  x |= b[n++] << 0;\n  x |= b[n++] << 8;\n  x |= b[n++] << 16;\n  x |= b[n++] << 24;\n  return x;\n};\n\n// Writes a 32-bit little-endian integer from an array.\nexports.writeU32 = function writeU32 (b, n, x) {\n  b[n++] = (x >> 0) & 0xff;\n  b[n++] = (x >> 8) & 0xff;\n  b[n++] = (x >> 16) & 0xff;\n  b[n++] = (x >> 24) & 0xff;\n};\n\n// Multiplies two numbers using 32-bit integer multiplication.\n// Algorithm from Emscripten.\nexports.imul = function imul (a, b) {\n  var ah = a >>> 16;\n  var al = a & 65535;\n  var bh = b >>> 16;\n  var bl = b & 65535;\n\n  return al * bl + (ah * bl + al * bh << 16) | 0;\n};\n", "// xxh32.js - implementation of xxhash32 in plain JavaScript\nvar util = require('./util.js');\n\n// xxhash32 primes\nvar prime1 = 0x9e3779b1;\nvar prime2 = 0x85ebca77;\nvar prime3 = 0xc2b2ae3d;\nvar prime4 = 0x27d4eb2f;\nvar prime5 = 0x165667b1;\n\n// Utility functions/primitives\n// --\n\nfunction rotl32 (x, r) {\n  x = x | 0;\n  r = r | 0;\n\n  return x >>> (32 - r | 0) | x << r | 0;\n}\n\nfunction rotmul32 (h, r, m) {\n  h = h | 0;\n  r = r | 0;\n  m = m | 0;\n\n  return util.imul(h >>> (32 - r | 0) | h << r, m) | 0;\n}\n\nfunction shiftxor32 (h, s) {\n  h = h | 0;\n  s = s | 0;\n\n  return h >>> s ^ h | 0;\n}\n\n// Implementation\n// --\n\nfunction xxhapply (h, src, m0, s, m1) {\n  return rotmul32(util.imul(src, m0) + h, s, m1);\n}\n\nfunction xxh1 (h, src, index) {\n  return rotmul32((h + util.imul(src[index], prime5)), 11, prime1);\n}\n\nfunction xxh4 (h, src, index) {\n  return xxhapply(h, util.readU32(src, index), prime3, 17, prime4);\n}\n\nfunction xxh16 (h, src, index) {\n  return [\n    xxhapply(h[0], util.readU32(src, index + 0), prime2, 13, prime1),\n    xxhapply(h[1], util.readU32(src, index + 4), prime2, 13, prime1),\n    xxhapply(h[2], util.readU32(src, index + 8), prime2, 13, prime1),\n    xxhapply(h[3], util.readU32(src, index + 12), prime2, 13, prime1)\n  ];\n}\n\nfunction xxh32 (seed, src, index, len) {\n  var h, l;\n  l = len;\n  if (len >= 16) {\n    h = [\n      seed + prime1 + prime2,\n      seed + prime2,\n      seed,\n      seed - prime1\n    ];\n\n    while (len >= 16) {\n      h = xxh16(h, src, index);\n\n      index += 16;\n      len -= 16;\n    }\n\n    h = rotl32(h[0], 1) + rotl32(h[1], 7) + rotl32(h[2], 12) + rotl32(h[3], 18) + l;\n  } else {\n    h = (seed + prime5 + len) >>> 0;\n  }\n\n  while (len >= 4) {\n    h = xxh4(h, src, index);\n\n    index += 4;\n    len -= 4;\n  }\n\n  while (len > 0) {\n    h = xxh1(h, src, index);\n\n    index++;\n    len--;\n  }\n\n  h = shiftxor32(util.imul(shiftxor32(util.imul(shiftxor32(h, 15), prime2), 13), prime3), 16);\n\n  return h >>> 0;\n}\n\nexports.hash = xxh32;\n", "// lz4.js - An implementation of Lz4 in plain JavaScript.\n//\n// TODO:\n// - Unify header parsing/writing.\n// - Support options (block size, checksums)\n// - Support streams\n// - Better error handling (handle bad offset, etc.)\n// - HC support (better search algorithm)\n// - Tests/benchmarking\n\nvar xxhash = require('./xxh32.js');\nvar util = require('./util.js');\n\n// Constants\n// --\n\n// Compression format parameters/constants.\nvar minMatch = 4;\nvar minLength = 13;\nvar searchLimit = 5;\nvar skipTrigger = 6;\nvar hashSize = 1 << 16;\n\n// Token constants.\nvar mlBits = 4;\nvar mlMask = (1 << mlBits) - 1;\nvar runBits = 4;\nvar runMask = (1 << runBits) - 1;\n\n// Shared buffers\nvar blockBuf = makeBuffer(5 << 20);\nvar hashTable = makeHashTable();\n\n// Frame constants.\nvar magicNum = 0x184D2204;\n\n// Frame descriptor flags.\nvar fdContentChksum = 0x4;\nvar fdContentSize = 0x8;\nvar fdBlockChksum = 0x10;\n// var fdBlockIndep = 0x20;\nvar fdVersion = 0x40;\nvar fdVersionMask = 0xC0;\n\n// Block sizes.\nvar bsUncompressed = 0x80000000;\nvar bsDefault = 7;\nvar bsShift = 4;\nvar bsMask = 7;\nvar bsMap = {\n  4: 0x10000,\n  5: 0x40000,\n  6: 0x100000,\n  7: 0x400000\n};\n\n// Utility functions/primitives\n// --\n\n// Makes our hashtable. On older browsers, may return a plain array.\nfunction makeHashTable () {\n  try {\n    return new Uint32Array(hashSize);\n  } catch (error) {\n    var hashTable = new Array(hashSize);\n\n    for (var i = 0; i < hashSize; i++) {\n      hashTable[i] = 0;\n    }\n\n    return hashTable;\n  }\n}\n\n// Clear hashtable.\nfunction clearHashTable (table) {\n  for (var i = 0; i < hashSize; i++) {\n    hashTable[i] = 0;\n  }\n}\n\n// Makes a byte buffer. On older browsers, may return a plain array.\nfunction makeBuffer (size) {\n  try {\n    return new Uint8Array(size);\n  } catch (error) {\n    var buf = new Array(size);\n\n    for (var i = 0; i < size; i++) {\n      buf[i] = 0;\n    }\n\n    return buf;\n  }\n}\n\nfunction sliceArray (array, start, end) {\n  if (typeof array.buffer !== undefined) {\n    if (Uint8Array.prototype.slice) {\n      return array.slice(start, end);\n    } else {\n      // Uint8Array#slice polyfill.\n      var len = array.length;\n\n      // Calculate start.\n      start = start | 0;\n      start = (start < 0) ? Math.max(len + start, 0) : Math.min(start, len);\n\n      // Calculate end.\n      end = (end === undefined) ? len : end | 0;\n      end = (end < 0) ? Math.max(len + end, 0) : Math.min(end, len);\n\n      // Copy into new array.\n      var arraySlice = new Uint8Array(end - start);\n      for (var i = start, n = 0; i < end;) {\n        arraySlice[n++] = array[i++];\n      }\n\n      return arraySlice;\n    }\n  } else {\n    // Assume normal array.\n    return array.slice(start, end);\n  }\n}\n\n// Implementation\n// --\n\n// Calculates an upper bound for lz4 compression.\nexports.compressBound = function compressBound (n) {\n  return (n + (n / 255) + 16) | 0;\n};\n\n// Calculates an upper bound for lz4 decompression, by reading the data.\nexports.decompressBound = function decompressBound (src) {\n  var sIndex = 0;\n\n  // Read magic number\n  if (util.readU32(src, sIndex) !== magicNum) {\n    throw new Error('invalid magic number');\n  }\n\n  sIndex += 4;\n\n  // Read descriptor\n  var descriptor = src[sIndex++];\n\n  // Check version\n  if ((descriptor & fdVersionMask) !== fdVersion) {\n    throw new Error('incompatible descriptor version ' + (descriptor & fdVersionMask));\n  }\n\n  // Read flags\n  var useBlockSum = (descriptor & fdBlockChksum) !== 0;\n  var useContentSize = (descriptor & fdContentSize) !== 0;\n\n  // Read block size\n  var bsIdx = (src[sIndex++] >> bsShift) & bsMask;\n\n  if (bsMap[bsIdx] === undefined) {\n    throw new Error('invalid block size ' + bsIdx);\n  }\n\n  var maxBlockSize = bsMap[bsIdx];\n\n  // Get content size\n  if (useContentSize) {\n    return util.readU64(src, sIndex);\n  }\n\n  // Checksum\n  sIndex++;\n\n  // Read blocks.\n  var maxSize = 0;\n  while (true) {\n    var blockSize = util.readU32(src, sIndex);\n    sIndex += 4;\n\n    if (blockSize & bsUncompressed) {\n      blockSize &= ~bsUncompressed;\n      maxSize += blockSize;\n    } else {\n      maxSize += maxBlockSize;\n    }\n\n    if (blockSize === 0) {\n      return maxSize;\n    }\n\n    if (useBlockSum) {\n      sIndex += 4;\n    }\n\n    sIndex += blockSize;\n  }\n};\n\n// Creates a buffer of a given byte-size, falling back to plain arrays.\nexports.makeBuffer = makeBuffer;\n\n// Decompresses a block of Lz4.\nexports.decompressBlock = function decompressBlock (src, dst, sIndex, sLength, dIndex) {\n  var mLength, mOffset, sEnd, n, i;\n\n  // Setup initial state.\n  sEnd = sIndex + sLength;\n\n  // Consume entire input block.\n  while (sIndex < sEnd) {\n    var token = src[sIndex++];\n\n    // Copy literals.\n    var literalCount = (token >> 4);\n    if (literalCount > 0) {\n      // Parse length.\n      if (literalCount === 0xf) {\n        while (true) {\n          literalCount += src[sIndex];\n          if (src[sIndex++] !== 0xff) {\n            break;\n          }\n        }\n      }\n\n      // Copy literals\n      for (n = sIndex + literalCount; sIndex < n;) {\n        dst[dIndex++] = src[sIndex++];\n      }\n    }\n\n    if (sIndex >= sEnd) {\n      break;\n    }\n\n    // Copy match.\n    mLength = (token & 0xf);\n\n    // Parse offset.\n    mOffset = src[sIndex++] | (src[sIndex++] << 8);\n\n    // Parse length.\n    if (mLength === 0xf) {\n      while (true) {\n        mLength += src[sIndex];\n        if (src[sIndex++] !== 0xff) {\n          break;\n        }\n      }\n    }\n\n    mLength += minMatch;\n\n    // Copy match.\n    for (i = dIndex - mOffset, n = i + mLength; i < n;) {\n      dst[dIndex++] = dst[i++] | 0;\n    }\n  }\n\n  return dIndex;\n};\n\n// Compresses a block with Lz4.\nexports.compressBlock = function compressBlock (src, dst, sIndex, sLength, hashTable) {\n  var mIndex, mAnchor, mLength, mOffset, mStep;\n  var literalCount, dIndex, sEnd, n;\n\n  // Setup initial state.\n  dIndex = 0;\n  sEnd = sLength + sIndex;\n  mAnchor = sIndex;\n\n  // Process only if block is large enough.\n  if (sLength >= minLength) {\n    var searchMatchCount = (1 << skipTrigger) + 3;\n\n    // Consume until last n literals (Lz4 spec limitation.)\n    while (sIndex + minMatch < sEnd - searchLimit) {\n      var seq = util.readU32(src, sIndex);\n      var hash = util.hashU32(seq) >>> 0;\n\n      // Crush hash to 16 bits.\n      hash = ((hash >> 16) ^ hash) >>> 0 & 0xffff;\n\n      // Look for a match in the hashtable. NOTE: remove one; see below.\n      mIndex = hashTable[hash] - 1;\n\n      // Put pos in hash table. NOTE: add one so that zero = invalid.\n      hashTable[hash] = sIndex + 1;\n\n      // Determine if there is a match (within range.)\n      if (mIndex < 0 || ((sIndex - mIndex) >>> 16) > 0 || util.readU32(src, mIndex) !== seq) {\n        mStep = searchMatchCount++ >> skipTrigger;\n        sIndex += mStep;\n        continue;\n      }\n\n      searchMatchCount = (1 << skipTrigger) + 3;\n\n      // Calculate literal count and offset.\n      literalCount = sIndex - mAnchor;\n      mOffset = sIndex - mIndex;\n\n      // We've already matched one word, so get that out of the way.\n      sIndex += minMatch;\n      mIndex += minMatch;\n\n      // Determine match length.\n      // N.B.: mLength does not include minMatch, Lz4 adds it back\n      // in decoding.\n      mLength = sIndex;\n      while (sIndex < sEnd - searchLimit && src[sIndex] === src[mIndex]) {\n        sIndex++;\n        mIndex++;\n      }\n      mLength = sIndex - mLength;\n\n      // Write token + literal count.\n      var token = mLength < mlMask ? mLength : mlMask;\n      if (literalCount >= runMask) {\n        dst[dIndex++] = (runMask << mlBits) + token;\n        for (n = literalCount - runMask; n >= 0xff; n -= 0xff) {\n          dst[dIndex++] = 0xff;\n        }\n        dst[dIndex++] = n;\n      } else {\n        dst[dIndex++] = (literalCount << mlBits) + token;\n      }\n\n      // Write literals.\n      for (var i = 0; i < literalCount; i++) {\n        dst[dIndex++] = src[mAnchor + i];\n      }\n\n      // Write offset.\n      dst[dIndex++] = mOffset;\n      dst[dIndex++] = (mOffset >> 8);\n\n      // Write match length.\n      if (mLength >= mlMask) {\n        for (n = mLength - mlMask; n >= 0xff; n -= 0xff) {\n          dst[dIndex++] = 0xff;\n        }\n        dst[dIndex++] = n;\n      }\n\n      // Move the anchor.\n      mAnchor = sIndex;\n    }\n  }\n\n  // Nothing was encoded.\n  if (mAnchor === 0) {\n    return 0;\n  }\n\n  // Write remaining literals.\n  // Write literal token+count.\n  literalCount = sEnd - mAnchor;\n  if (literalCount >= runMask) {\n    dst[dIndex++] = (runMask << mlBits);\n    for (n = literalCount - runMask; n >= 0xff; n -= 0xff) {\n      dst[dIndex++] = 0xff;\n    }\n    dst[dIndex++] = n;\n  } else {\n    dst[dIndex++] = (literalCount << mlBits);\n  }\n\n  // Write literals.\n  sIndex = mAnchor;\n  while (sIndex < sEnd) {\n    dst[dIndex++] = src[sIndex++];\n  }\n\n  return dIndex;\n};\n\n// Decompresses a frame of Lz4 data.\nexports.decompressFrame = function decompressFrame (src, dst) {\n  var useBlockSum, useContentSum, useContentSize, descriptor;\n  var sIndex = 0;\n  var dIndex = 0;\n\n  // Read magic number\n  if (util.readU32(src, sIndex) !== magicNum) {\n    throw new Error('invalid magic number');\n  }\n\n  sIndex += 4;\n\n  // Read descriptor\n  descriptor = src[sIndex++];\n\n  // Check version\n  if ((descriptor & fdVersionMask) !== fdVersion) {\n    throw new Error('incompatible descriptor version');\n  }\n\n  // Read flags\n  useBlockSum = (descriptor & fdBlockChksum) !== 0;\n  useContentSum = (descriptor & fdContentChksum) !== 0;\n  useContentSize = (descriptor & fdContentSize) !== 0;\n\n  // Read block size\n  var bsIdx = (src[sIndex++] >> bsShift) & bsMask;\n\n  if (bsMap[bsIdx] === undefined) {\n    throw new Error('invalid block size');\n  }\n\n  if (useContentSize) {\n    // TODO: read content size\n    sIndex += 8;\n  }\n\n  sIndex++;\n\n  // Read blocks.\n  while (true) {\n    var compSize;\n\n    compSize = util.readU32(src, sIndex);\n    sIndex += 4;\n\n    if (compSize === 0) {\n      break;\n    }\n\n    if (useBlockSum) {\n      // TODO: read block checksum\n      sIndex += 4;\n    }\n\n    // Check if block is compressed\n    if ((compSize & bsUncompressed) !== 0) {\n      // Mask off the 'uncompressed' bit\n      compSize &= ~bsUncompressed;\n\n      // Copy uncompressed data into destination buffer.\n      for (var j = 0; j < compSize; j++) {\n        dst[dIndex++] = src[sIndex++];\n      }\n    } else {\n      // Decompress into blockBuf\n      dIndex = exports.decompressBlock(src, dst, sIndex, compSize, dIndex);\n      sIndex += compSize;\n    }\n  }\n\n  if (useContentSum) {\n    // TODO: read content checksum\n    sIndex += 4;\n  }\n\n  return dIndex;\n};\n\n// Compresses data to an Lz4 frame.\nexports.compressFrame = function compressFrame (src, dst) {\n  var dIndex = 0;\n\n  // Write magic number.\n  util.writeU32(dst, dIndex, magicNum);\n  dIndex += 4;\n\n  // Descriptor flags.\n  dst[dIndex++] = fdVersion;\n  dst[dIndex++] = bsDefault << bsShift;\n\n  // Descriptor checksum.\n  dst[dIndex] = xxhash.hash(0, dst, 4, dIndex - 4) >> 8;\n  dIndex++;\n\n  // Write blocks.\n  var maxBlockSize = bsMap[bsDefault];\n  var remaining = src.length;\n  var sIndex = 0;\n\n  // Clear the hashtable.\n  clearHashTable(hashTable);\n\n  // Split input into blocks and write.\n  while (remaining > 0) {\n    var compSize = 0;\n    var blockSize = remaining > maxBlockSize ? maxBlockSize : remaining;\n\n    compSize = exports.compressBlock(src, blockBuf, sIndex, blockSize, hashTable);\n\n    if (compSize > blockSize || compSize === 0) {\n      // Output uncompressed.\n      util.writeU32(dst, dIndex, 0x80000000 | blockSize);\n      dIndex += 4;\n\n      for (var z = sIndex + blockSize; sIndex < z;) {\n        dst[dIndex++] = src[sIndex++];\n      }\n\n      remaining -= blockSize;\n    } else {\n      // Output compressed.\n      util.writeU32(dst, dIndex, compSize);\n      dIndex += 4;\n\n      for (var j = 0; j < compSize;) {\n        dst[dIndex++] = blockBuf[j++];\n      }\n\n      sIndex += blockSize;\n      remaining -= blockSize;\n    }\n  }\n\n  // Write blank end block.\n  util.writeU32(dst, dIndex, 0);\n  dIndex += 4;\n\n  return dIndex;\n};\n\n// Decompresses a buffer containing an Lz4 frame. maxSize is optional; if not\n// provided, a maximum size will be determined by examining the data. The\n// buffer returned will always be perfectly-sized.\nexports.decompress = function decompress (src, maxSize) {\n  var dst, size;\n\n  if (maxSize === undefined) {\n    maxSize = exports.decompressBound(src);\n  }\n\n  dst = exports.makeBuffer(maxSize);\n  size = exports.decompressFrame(src, dst);\n\n  if (size !== maxSize) {\n    dst = sliceArray(dst, 0, size);\n  }\n\n  return dst;\n};\n\n// Compresses a buffer to an Lz4 frame. maxSize is optional; if not provided,\n// a buffer will be created based on the theoretical worst output size for a\n// given input size. The buffer returned will always be perfectly-sized.\nexports.compress = function compress (src, maxSize) {\n  var dst, size;\n\n  if (maxSize === undefined) {\n    maxSize = exports.compressBound(src.length);\n  }\n\n  dst = exports.makeBuffer(maxSize);\n  size = exports.compressFrame(src, dst);\n\n  if (size !== maxSize) {\n    dst = sliceArray(dst, 0, size);\n  }\n\n  return dst;\n};\n", "/**\r\n * MDOCX file format types.\r\n * Based on the MDOCX RFC specification v1.0.\r\n * \r\n * @see https://github.com/logicossoftware/go-mdocx/blob/main/rfc.md\r\n */\r\n\r\n/**\r\n * Fixed header structure (32 bytes).\r\n * All integer fields are little-endian.\r\n */\r\nexport type MdocxHeader = {\r\n  /** Magic bytes: \"MDOCX\\r\\n\" + 0x1A (8 bytes) */\r\n  magic: Uint8Array;\r\n  /** Format version (MUST be 1 for this spec) */\r\n  version: number;\r\n  /** Header flags bitmask */\r\n  headerFlags: number;\r\n  /** Fixed header size (MUST be 32) */\r\n  fixedHeaderSize: number;\r\n  /** Length in bytes of metadata block */\r\n  metadataLength: number;\r\n  /** Reserved field (MUST be 0 for v1) */\r\n  reserved0: number;\r\n  /** Reserved field (MUST be 0 for v1) */\r\n  reserved1: bigint;\r\n};\r\n\r\n/**\r\n * Metadata block (optional).\r\n * When present, MUST be UTF-8 JSON text with an object at the top level.\r\n * \r\n * Recommended keys (non-exhaustive):\r\n * - `title`: Document title\r\n * - `description`: Document description\r\n * - `creator`: Creator name\r\n * - `created_at`: RFC3339 timestamp\r\n * - `root`: Primary markdown file path\r\n * - `tags`: Array of tag strings\r\n */\r\nexport type MdocxMetadata = Record<string, unknown>;\r\n\r\n/**\r\n * A single Markdown file within the bundle.\r\n */\r\nexport type MarkdownFile = {\r\n  /** \r\n   * Container path (e.g., \"docs/readme.md\").\r\n   * MUST be non-empty, unique, and a safe relative path.\r\n   * Uses forward slashes, no leading \"/\" or \"..\" segments.\r\n   */\r\n  path: string;\r\n  \r\n  /** UTF-8 Markdown content */\r\n  content: Uint8Array;\r\n  \r\n  /** \r\n   * Referenced media IDs.\r\n   * Each ID corresponds to a MediaItem.id in the media bundle.\r\n   */\r\n  mediaRefs?: string[];\r\n  \r\n  /** Arbitrary per-file attributes */\r\n  attributes?: Record<string, string>;\r\n};\r\n\r\n/**\r\n * Markdown bundle (Section Type 1).\r\n */\r\nexport type MarkdownBundle = {\r\n  /** Bundle version (MUST be 1) */\r\n  bundleVersion: number;\r\n  \r\n  /** \r\n   * Primary markdown path.\r\n   * Overrides metadata.root if non-empty.\r\n   */\r\n  rootPath?: string;\r\n  \r\n  /** \r\n   * Markdown files in the bundle.\r\n   * MUST contain at least one entry.\r\n   */\r\n  files: MarkdownFile[];\r\n};\r\n\r\n/**\r\n * A single media item within the bundle.\r\n */\r\nexport type MediaItem = {\r\n  /** \r\n   * Stable unique identifier.\r\n   * Used for mdocx://media/<ID> references.\r\n   */\r\n  id: string;\r\n  \r\n  /** Container path (e.g., \"assets/logo.png\") */\r\n  path?: string;\r\n  \r\n  /** MIME type (e.g., \"image/png\", \"audio/mpeg\") */\r\n  mimeType?: string;\r\n  \r\n  /** Raw media data */\r\n  data: Uint8Array;\r\n  \r\n  /** \r\n   * SHA-256 hash of data (32 bytes).\r\n   * RECOMMENDED for integrity verification.\r\n   */\r\n  sha256?: Uint8Array;\r\n  \r\n  /** Arbitrary attributes (e.g., \"alt\": \"Logo\") */\r\n  attributes?: Record<string, string>;\r\n};\r\n\r\n/**\r\n * Media bundle (Section Type 2).\r\n */\r\nexport type MediaBundle = {\r\n  /** Bundle version (MUST be 1) */\r\n  bundleVersion: number;\r\n  \r\n  /** Media items (may be empty) */\r\n  items: MediaItem[];\r\n};\r\n\r\n/**\r\n * Section type values.\r\n */\r\nexport type MdocxSectionType = 1 | 2;\r\n\r\n/**\r\n * Compression algorithm identifiers.\r\n * \r\n * - `none`: No compression (raw gob bytes)\r\n * - `zip`: ZIP container with single payload.gob entry\r\n * - `zstd`: Zstandard compressed stream (recommended default)\r\n * - `lz4`: LZ4 compressed stream (max speed)\r\n * - `br`: Brotli compressed stream (max ratio)\r\n */\r\nexport type MdocxCompression = 'none' | 'zip' | 'zstd' | 'lz4' | 'br';\r\n\r\n/**\r\n * Complete MDOCX document structure.\r\n */\r\nexport type MdocxDocument = {\r\n  /** Fixed header */\r\n  header: MdocxHeader;\r\n  \r\n  /** Optional metadata block */\r\n  metadata?: MdocxMetadata;\r\n  \r\n  /** Markdown bundle (required) */\r\n  markdown: MarkdownBundle;\r\n  \r\n  /** Media bundle (required, may be empty) */\r\n  media: MediaBundle;\r\n};\r\n\r\n/**\r\n * Configurable limits for reading MDOCX files.\r\n * Protects against oversized allocations and decompression bombs.\r\n */\r\nexport type ReadLimits = {\r\n  /** Max metadata block size (default: 1 MiB) */\r\n  maxMetadataLength: number;\r\n  \r\n  /** Max compressed section payload size (default: 1 GiB) */\r\n  maxSectionPayloadLen: number;\r\n  \r\n  /** Max uncompressed markdown section size (default: 256 MiB) */\r\n  maxMarkdownUncompressed: number;\r\n  \r\n  /** Max uncompressed media section size (default: 2 GiB) */\r\n  maxMediaUncompressed: number;\r\n};\r\n\r\n/**\r\n * Default read limits per RFC recommendations.\r\n */\r\nexport const defaultReadLimits: ReadLimits = {\r\n  maxMetadataLength: 1024 * 1024,              // 1 MiB\r\n  maxSectionPayloadLen: 1024 * 1024 * 1024,    // 1 GiB\r\n  maxMarkdownUncompressed: 256 * 1024 * 1024,  // 256 MiB\r\n  maxMediaUncompressed: 2 * 1024 * 1024 * 1024 // 2 GiB\r\n};\r\n", "export const MDOCX_MAGIC = Uint8Array.from([\r\n  0x4d, 0x44, 0x4f, 0x43, 0x58, 0x0d, 0x0a, 0x1a\r\n]);\r\n\r\nexport const FIXED_HEADER_SIZE_V1 = 32;\r\n\r\nexport const HEADERFLAG_METADATA_JSON = 0x0001;\r\n\r\nexport const SECTION_TYPE_MARKDOWN = 1;\r\nexport const SECTION_TYPE_MEDIA = 2;\r\n\r\nexport const SECTION_HEADER_SIZE = 16;\r\n\r\n// SectionFlags bits 0..3\r\nexport const COMP_NONE = 0x0;\r\nexport const COMP_ZIP = 0x1;\r\nexport const COMP_ZSTD = 0x2;\r\nexport const COMP_LZ4 = 0x3;\r\nexport const COMP_BR = 0x4;\r\n\r\nexport const SECTIONFLAG_HAS_UNCOMPRESSED_LEN = 0x0010;\r\n", "export class ByteReader {\r\n  private view: DataView;\r\n  private buf: Uint8Array;\r\n  public offset = 0;\r\n\r\n  constructor(bytes: Uint8Array) {\r\n    this.buf = bytes;\r\n    this.view = new DataView(bytes.buffer, bytes.byteOffset, bytes.byteLength);\r\n  }\r\n\r\n  remaining(): number {\r\n    return this.buf.byteLength - this.offset;\r\n  }\r\n\r\n  readBytes(n: number): Uint8Array {\r\n    if (n < 0) throw new Error('readBytes: negative length');\r\n    if (this.offset + n > this.buf.byteLength) {\r\n      throw new Error(`Unexpected EOF (need ${n}, have ${this.remaining()})`);\r\n    }\r\n    const out = this.buf.subarray(this.offset, this.offset + n);\r\n    this.offset += n;\r\n    return out;\r\n  }\r\n\r\n  readU16LE(): number {\r\n    const v = this.view.getUint16(this.offset, true);\r\n    this.offset += 2;\r\n    return v;\r\n  }\r\n\r\n  readU32LE(): number {\r\n    const v = this.view.getUint32(this.offset, true);\r\n    this.offset += 4;\r\n    return v;\r\n  }\r\n\r\n  readU64LE(): bigint {\r\n    const v = this.view.getBigUint64(this.offset, true);\r\n    this.offset += 8;\r\n    return v;\r\n  }\r\n}\r\n\r\nexport class ByteWriter {\r\n  private chunks: Uint8Array[] = [];\r\n\r\n  writeBytes(bytes: Uint8Array): void {\r\n    this.chunks.push(bytes);\r\n  }\r\n\r\n  writeU16LE(v: number): void {\r\n    const b = new Uint8Array(2);\r\n    new DataView(b.buffer).setUint16(0, v, true);\r\n    this.chunks.push(b);\r\n  }\r\n\r\n  writeU32LE(v: number): void {\r\n    const b = new Uint8Array(4);\r\n    new DataView(b.buffer).setUint32(0, v, true);\r\n    this.chunks.push(b);\r\n  }\r\n\r\n  writeU64LE(v: bigint): void {\r\n    const b = new Uint8Array(8);\r\n    new DataView(b.buffer).setBigUint64(0, v, true);\r\n    this.chunks.push(b);\r\n  }\r\n\r\n  concat(): Uint8Array {\r\n    const total = this.chunks.reduce((acc, c) => acc + c.byteLength, 0);\r\n    const out = new Uint8Array(total);\r\n    let o = 0;\r\n    for (const c of this.chunks) {\r\n      out.set(c, o);\r\n      o += c.byteLength;\r\n    }\r\n    return out;\r\n  }\r\n}\r\n\r\nexport function bytesEqual(a: Uint8Array, b: Uint8Array): boolean {\r\n  if (a.byteLength !== b.byteLength) return false;\r\n  for (let i = 0; i < a.byteLength; i++) if (a[i] !== b[i]) return false;\r\n  return true;\r\n}\r\n\r\nexport function decodeUtf8(bytes: Uint8Array): string {\r\n  return new TextDecoder('utf-8', { fatal: false }).decode(bytes);\r\n}\r\n\r\nexport function encodeUtf8(text: string): Uint8Array {\r\n  return new TextEncoder().encode(text);\r\n}\r\n", "import { brotliDecompressSync, brotliCompressSync } from 'node:zlib';\r\nimport { unzipSync, zipSync } from 'fflate';\r\nimport { decompress as zstdDecompress } from 'fzstd';\r\nimport { compress as zstdWasmCompress, init as initZstdWasm } from '@bokuweb/zstd-wasm';\r\nimport { decompress as lz4Decompress, compress as lz4Compress } from 'lz4js';\r\n\r\nexport type Compression = 'none' | 'zip' | 'zstd' | 'lz4' | 'br';\r\n\r\n/** Default ZSTD compression level (3 is a good balance of speed and ratio) */\r\nexport const DEFAULT_ZSTD_LEVEL = 3;\r\n\r\nlet zstdWasmInitialized = false;\r\n\r\n/**\r\n * Initialize the ZSTD WASM module. Must be called before using ZSTD compression.\r\n * This is automatically called by compressPayload when needed.\r\n */\r\nexport async function initZstd(): Promise<void> {\r\n  if (!zstdWasmInitialized) {\r\n    await initZstdWasm();\r\n    zstdWasmInitialized = true;\r\n  }\r\n}\r\n\r\n/**\r\n * Check if ZSTD compression is available (WASM module initialized).\r\n */\r\nexport function isZstdCompressionAvailable(): boolean {\r\n  return zstdWasmInitialized;\r\n}\r\n\r\nexport function decompressPayload(alg: Compression, compressed: Uint8Array, expectedSize: number): Uint8Array {\r\n  if (expectedSize < 0) throw new Error('expectedSize < 0');\r\n\r\n  switch (alg) {\r\n    case 'none':\r\n      if (compressed.byteLength !== expectedSize) {\r\n        // Caller supplies expectedSize for compressed algs; for none this is just a consistency check.\r\n        // Still allow mismatch because for COMP_NONE caller will set expectedSize=payloadLen.\r\n      }\r\n      return compressed;\r\n\r\n    case 'br': {\r\n      const out = brotliDecompressSync(compressed);\r\n      if (out.byteLength !== expectedSize) throw new Error(`Brotli size mismatch (got ${out.byteLength}, expected ${expectedSize})`);\r\n      return out;\r\n    }\r\n\r\n    case 'zstd': {\r\n      const out = zstdDecompress(compressed);\r\n      if (out.byteLength !== expectedSize) throw new Error(`ZSTD size mismatch (got ${out.byteLength}, expected ${expectedSize})`);\r\n      return out;\r\n    }\r\n\r\n    case 'lz4': {\r\n      const out = lz4Decompress(compressed);\r\n      if (out.byteLength !== expectedSize) throw new Error(`LZ4 size mismatch (got ${out.byteLength}, expected ${expectedSize})`);\r\n      return out;\r\n    }\r\n\r\n    case 'zip': {\r\n      const files = unzipSync(compressed);\r\n      const keys = Object.keys(files);\r\n      if (keys.length !== 1 || keys[0] !== 'payload.gob') {\r\n        throw new Error('ZIP must contain exactly one file named payload.gob');\r\n      }\r\n      const out = files['payload.gob'];\r\n      if (!out) throw new Error('ZIP missing payload.gob');\r\n      if (out.byteLength !== expectedSize) throw new Error(`ZIP size mismatch (got ${out.byteLength}, expected ${expectedSize})`);\r\n      return out;\r\n    }\r\n  }\r\n}\r\n\r\nexport function compressPayload(alg: Compression, raw: Uint8Array): Uint8Array {\r\n  switch (alg) {\r\n    case 'none':\r\n      return raw;\r\n    case 'br':\r\n      return brotliCompressSync(raw);\r\n    case 'zstd': {\r\n      if (!zstdWasmInitialized) {\r\n        throw new Error('ZSTD compression requires initialization. Call `await initZstd()` first, or use `compressPayloadAsync`.');\r\n      }\r\n      return zstdWasmCompress(raw, DEFAULT_ZSTD_LEVEL);\r\n    }\r\n    case 'lz4':\r\n      return lz4Compress(raw);\r\n    case 'zip':\r\n      return zipSync({ 'payload.gob': raw });\r\n  }\r\n}\r\n\r\n/**\r\n * Async version of compressPayload that auto-initializes ZSTD if needed.\r\n */\r\nexport async function compressPayloadAsync(alg: Compression, raw: Uint8Array): Promise<Uint8Array> {\r\n  if (alg === 'zstd') {\r\n    await initZstd();\r\n  }\r\n  return compressPayload(alg, raw);\r\n}\r\n", "import { TextDecoder, TextEncoder } from 'node:util';\r\n\r\nconst textDecoder = new TextDecoder();\r\nconst textEncoder = new TextEncoder();\r\n\r\nexport type GobTypeId = number;\r\n\r\ntype GobType =\r\n  | { kind: 'bool' }\r\n  | { kind: 'int' }\r\n  | { kind: 'uint' }\r\n  | { kind: 'float' }\r\n  | { kind: 'bytes' }\r\n  | { kind: 'string' }\r\n  | { kind: 'complex' }\r\n  | { kind: 'interface' }\r\n  | { kind: 'array'; elem: GobTypeId; len: number; name?: string }\r\n  | { kind: 'slice'; elem: GobTypeId; name?: string }\r\n  | { kind: 'map'; key: GobTypeId; elem: GobTypeId; name?: string }\r\n  | { kind: 'struct'; fields: Array<{ name: string; typeId: GobTypeId }>; name?: string };\r\n\r\nclass GobReader {\r\n  private off = 0;\r\n\r\n  constructor(private readonly bytes: Uint8Array) {}\r\n\r\n  remaining(): number {\r\n    return this.bytes.byteLength - this.off;\r\n  }\r\n\r\n  readByte(): number {\r\n    if (this.off >= this.bytes.byteLength) throw new Error('Unexpected EOF');\r\n    return this.bytes[this.off++]!;\r\n  }\r\n\r\n  readBytes(n: number): Uint8Array {\r\n    if (n < 0) throw new Error('Invalid length');\r\n    if (this.off + n > this.bytes.byteLength) throw new Error('Unexpected EOF');\r\n    const out = this.bytes.subarray(this.off, this.off + n);\r\n    this.off += n;\r\n    return out;\r\n  }\r\n\r\n  readGobUint(): bigint {\r\n    const b = this.readByte();\r\n    if (b <= 0x7f) return BigInt(b);\r\n    const n = 256 - b; // -int8(b)\r\n    let x = 0n;\r\n    for (let i = 0; i < n; i++) {\r\n      x = (x << 8n) | BigInt(this.readByte());\r\n    }\r\n    return x;\r\n  }\r\n\r\n  readGobInt(): bigint {\r\n    const u = this.readGobUint();\r\n    // Signed ints are encoded by complementing negative values and shifting left 1 with LSB sign.\r\n    // Decode: if u is odd -> negative; magnitude = u >> 1.\r\n    if ((u & 1n) === 0n) return u >> 1n;\r\n    return ~(u >> 1n);\r\n  }\r\n\r\n  readGobString(): string {\r\n    const n = this.readGobUint();\r\n    const len = toSafeNumber(n, 'string length');\r\n    const b = this.readBytes(len);\r\n    return textDecoder.decode(b);\r\n  }\r\n\r\n  readGobBytes(): Uint8Array {\r\n    const n = this.readGobUint();\r\n    const len = toSafeNumber(n, 'bytes length');\r\n    return this.readBytes(len);\r\n  }\r\n}\r\n\r\nclass GobWriter {\r\n  private chunks: Uint8Array[] = [];\r\n\r\n  writeByte(b: number): void {\r\n    const bb = new Uint8Array(1);\r\n    bb[0] = b & 0xff;\r\n    this.chunks.push(bb);\r\n  }\r\n\r\n  writeBytes(b: Uint8Array): void {\r\n    this.chunks.push(b);\r\n  }\r\n\r\n  writeGobUint(x: bigint): void {\r\n    if (x < 0n) throw new Error('uint must be non-negative');\r\n    if (x <= 0x7fn) {\r\n      this.writeByte(Number(x));\r\n      return;\r\n    }\r\n\r\n    // big-endian minimal bytes\r\n    const bytes: number[] = [];\r\n    let v = x;\r\n    while (v > 0n) {\r\n      bytes.push(Number(v & 0xffn));\r\n      v >>= 8n;\r\n    }\r\n    bytes.reverse();\r\n\r\n    if (bytes.length > 255) throw new Error('uint too large');\r\n    this.writeByte(256 - bytes.length);\r\n    this.writeBytes(Uint8Array.from(bytes));\r\n  }\r\n\r\n  writeGobInt(x: bigint): void {\r\n    // Encode signed: map to uint with sign in LSB and magnitude in higher bits.\r\n    // For negative x, use ^x.\r\n    if (x < 0n) {\r\n      const u = ((~x) << 1n) | 1n;\r\n      this.writeGobUint(u);\r\n    } else {\r\n      const u = x << 1n;\r\n      this.writeGobUint(u);\r\n    }\r\n  }\r\n\r\n  writeGobString(s: string): void {\r\n    const b = textEncoder.encode(s);\r\n    this.writeGobUint(BigInt(b.byteLength));\r\n    this.writeBytes(b);\r\n  }\r\n\r\n  writeGobBytes(b: Uint8Array): void {\r\n    this.writeGobUint(BigInt(b.byteLength));\r\n    this.writeBytes(b);\r\n  }\r\n\r\n  concat(): Uint8Array {\r\n    const total = this.chunks.reduce((acc, c) => acc + c.byteLength, 0);\r\n    const out = new Uint8Array(total);\r\n    let off = 0;\r\n    for (const c of this.chunks) {\r\n      out.set(c, off);\r\n      off += c.byteLength;\r\n    }\r\n    return out;\r\n  }\r\n}\r\n\r\nfunction toSafeNumber(x: bigint, what: string): number {\r\n  if (x > BigInt(Number.MAX_SAFE_INTEGER)) throw new Error(`${what} exceeds MAX_SAFE_INTEGER`);\r\n  if (x < BigInt(Number.MIN_SAFE_INTEGER)) throw new Error(`${what} below MIN_SAFE_INTEGER`);\r\n  return Number(x);\r\n}\r\n\r\nfunction isAllZeroBytes(b: Uint8Array): boolean {\r\n  for (const x of b) if (x !== 0) return false;\r\n  return true;\r\n}\r\n\r\nclass TypeRegistry {\r\n  private types = new Map<GobTypeId, GobType>();\r\n\r\n  constructor(withBuiltins: boolean) {\r\n    if (!withBuiltins) return;\r\n\r\n    // Primitive type IDs per Go encoding/gob.\r\n    this.types.set(1, { kind: 'bool' });\r\n    this.types.set(2, { kind: 'int' });\r\n    this.types.set(3, { kind: 'uint' });\r\n    this.types.set(4, { kind: 'float' });\r\n    this.types.set(5, { kind: 'bytes' });\r\n    this.types.set(6, { kind: 'string' });\r\n    this.types.set(7, { kind: 'complex' });\r\n    this.types.set(8, { kind: 'interface' });\r\n\r\n    // Built-in gob wire type definitions.\r\n    // 18 CommonType: { Name string; Id int }\r\n    this.types.set(18, {\r\n      kind: 'struct',\r\n      name: 'CommonType',\r\n      fields: [\r\n        { name: 'Name', typeId: 6 },\r\n        { name: 'Id', typeId: 2 }\r\n      ]\r\n    });\r\n\r\n    // 17 arrayType: { CommonType; Elem int; Len int }\r\n    this.types.set(17, {\r\n      kind: 'struct',\r\n      name: 'arrayType',\r\n      fields: [\r\n        { name: 'CommonType', typeId: 18 },\r\n        { name: 'Elem', typeId: 2 },\r\n        { name: 'Len', typeId: 2 }\r\n      ]\r\n    });\r\n\r\n    // 19 sliceType: { CommonType; Elem int }\r\n    this.types.set(19, {\r\n      kind: 'struct',\r\n      name: 'sliceType',\r\n      fields: [\r\n        { name: 'CommonType', typeId: 18 },\r\n        { name: 'Elem', typeId: 2 }\r\n      ]\r\n    });\r\n\r\n    // 21 fieldType: { Name string; Id int }\r\n    this.types.set(21, {\r\n      kind: 'struct',\r\n      name: 'fieldType',\r\n      fields: [\r\n        { name: 'Name', typeId: 6 },\r\n        { name: 'Id', typeId: 2 }\r\n      ]\r\n    });\r\n\r\n    // 22 = []fieldType (built-in)\r\n    this.types.set(22, { kind: 'slice', name: '[]fieldType', elem: 21 });\r\n\r\n    // 20 structType: { CommonType; Field []fieldType }\r\n    this.types.set(20, {\r\n      kind: 'struct',\r\n      name: 'structType',\r\n      fields: [\r\n        { name: 'CommonType', typeId: 18 },\r\n        { name: 'Field', typeId: 22 }\r\n      ]\r\n    });\r\n\r\n    // 23 mapType: { CommonType; Key int; Elem int }\r\n    this.types.set(23, {\r\n      kind: 'struct',\r\n      name: 'mapType',\r\n      fields: [\r\n        { name: 'CommonType', typeId: 18 },\r\n        { name: 'Key', typeId: 2 },\r\n        { name: 'Elem', typeId: 2 }\r\n      ]\r\n    });\r\n\r\n    // 16 wireType: { ArrayT *arrayType; SliceT *sliceType; StructT *structType; MapT *mapType; ... }\r\n    // We only model the first 4 fields; the Go encoder won't emit later fields unless using external encodings.\r\n    this.types.set(16, {\r\n      kind: 'struct',\r\n      name: 'wireType',\r\n      fields: [\r\n        { name: 'ArrayT', typeId: 17 },\r\n        { name: 'SliceT', typeId: 19 },\r\n        { name: 'StructT', typeId: 20 },\r\n        { name: 'MapT', typeId: 23 }\r\n      ]\r\n    });\r\n  }\r\n\r\n  get(id: GobTypeId): GobType {\r\n    const t = this.types.get(id);\r\n    if (!t) throw new Error(`Unknown gob type id: ${id}`);\r\n    return t;\r\n  }\r\n\r\n  has(id: GobTypeId): boolean {\r\n    return this.types.has(id);\r\n  }\r\n\r\n  set(id: GobTypeId, t: GobType): void {\r\n    this.types.set(id, t);\r\n  }\r\n}\r\n\r\nfunction decodeValue(r: GobReader, reg: TypeRegistry, typeId: GobTypeId): unknown {\r\n  const t = reg.get(typeId);\r\n  switch (t.kind) {\r\n    case 'bool': {\r\n      const u = r.readGobUint();\r\n      return u !== 0n;\r\n    }\r\n    case 'int': {\r\n      return toSafeNumber(r.readGobInt(), 'int');\r\n    }\r\n    case 'uint': {\r\n      return toSafeNumber(r.readGobUint(), 'uint');\r\n    }\r\n    case 'float': {\r\n      // Go encodes floats as uint64 bits for float64.\r\n      const u = r.readGobUint();\r\n      if (u > 0xffff_ffff_ffff_ffffn) throw new Error('float bits too large');\r\n      const buf = new ArrayBuffer(8);\r\n      const dv = new DataView(buf);\r\n      dv.setBigUint64(0, u, false);\r\n      return dv.getFloat64(0, false);\r\n    }\r\n    case 'bytes': {\r\n      return r.readGobBytes();\r\n    }\r\n    case 'string': {\r\n      return r.readGobString();\r\n    }\r\n    case 'complex': {\r\n      const real = decodeValue(r, reg, 4);\r\n      const imag = decodeValue(r, reg, 4);\r\n      return { real, imag };\r\n    }\r\n    case 'interface': {\r\n      // Not needed for MDOCX; implement minimal.\r\n      const name = r.readGobString();\r\n      if (name === '') return null;\r\n      const concreteId = toSafeNumber(r.readGobInt(), 'interface concrete type id');\r\n      return { name, value: decodeValue(r, reg, concreteId) };\r\n    }\r\n    case 'array': {\r\n      const n = toSafeNumber(r.readGobUint(), 'array len');\r\n      if (n !== t.len) throw new Error(`Array length mismatch: got ${n}, expected ${t.len}`);\r\n      const elemType = reg.get(t.elem);\r\n      if (elemType.kind === 'uint' && t.len > 0) {\r\n        const out = new Uint8Array(t.len);\r\n        for (let i = 0; i < t.len; i++) {\r\n          const v = toSafeNumber(r.readGobUint(), 'array uint elem');\r\n          if (!Number.isInteger(v) || v < 0 || v > 255) throw new Error('uint8 out of range');\r\n          out[i] = v;\r\n        }\r\n        return out;\r\n      }\r\n      const arr: unknown[] = [];\r\n      for (let i = 0; i < t.len; i++) arr.push(decodeValue(r, reg, t.elem));\r\n      return arr;\r\n    }\r\n    case 'slice': {\r\n      const n = toSafeNumber(r.readGobUint(), 'slice len');\r\n      const elemType = reg.get(t.elem);\r\n      if (elemType.kind === 'uint') {\r\n        // encoding/gob has a special-case for []uint8/[]byte, but named aliases can show up\r\n        // as a user-defined slice of uint. Treat it as bytes when values are uint8.\r\n        const out = new Uint8Array(n);\r\n        for (let i = 0; i < n; i++) {\r\n          const v = toSafeNumber(r.readGobUint(), 'slice uint elem');\r\n          if (!Number.isInteger(v) || v < 0 || v > 255) throw new Error('uint8 out of range');\r\n          out[i] = v;\r\n        }\r\n        return out;\r\n      }\r\n\r\n      const out: unknown[] = [];\r\n      for (let i = 0; i < n; i++) out.push(decodeValue(r, reg, t.elem));\r\n      return out;\r\n    }\r\n    case 'map': {\r\n      const n = toSafeNumber(r.readGobUint(), 'map len');\r\n      const obj: Record<string, unknown> = {};\r\n      for (let i = 0; i < n; i++) {\r\n        const k = decodeValue(r, reg, t.key);\r\n        const v = decodeValue(r, reg, t.elem);\r\n        if (typeof k !== 'string') throw new Error('Only string keys supported in this decoder');\r\n        obj[k] = v;\r\n      }\r\n      return obj;\r\n    }\r\n    case 'struct': {\r\n      const result: Record<string, unknown> = {};\r\n      let fieldNum = -1;\r\n      while (true) {\r\n        const delta = toSafeNumber(r.readGobUint(), 'field delta');\r\n        if (delta === 0) break;\r\n        fieldNum += delta;\r\n        if (fieldNum < 0 || fieldNum >= t.fields.length) {\r\n          throw new Error(`Struct field out of range: ${fieldNum} (have ${t.fields.length})`);\r\n        }\r\n        const field = t.fields[fieldNum]!;\r\n        result[field.name] = decodeValue(r, reg, field.typeId);\r\n      }\r\n      return result;\r\n    }\r\n  }\r\n}\r\n\r\nfunction encodeValue(w: GobWriter, reg: TypeRegistry, typeId: GobTypeId, value: unknown): void {\r\n  const t = reg.get(typeId);\r\n  switch (t.kind) {\r\n    case 'bool': {\r\n      w.writeGobUint((value ? 1n : 0n));\r\n      return;\r\n    }\r\n    case 'int': {\r\n      if (typeof value !== 'number' || !Number.isFinite(value) || !Number.isInteger(value)) {\r\n        throw new Error('Expected int number');\r\n      }\r\n      w.writeGobInt(BigInt(value));\r\n      return;\r\n    }\r\n    case 'uint': {\r\n      if (typeof value !== 'number' || !Number.isFinite(value) || !Number.isInteger(value) || value < 0) {\r\n        throw new Error('Expected uint number');\r\n      }\r\n      w.writeGobUint(BigInt(value));\r\n      return;\r\n    }\r\n    case 'float': {\r\n      if (typeof value !== 'number' || !Number.isFinite(value)) throw new Error('Expected float number');\r\n      const buf = new ArrayBuffer(8);\r\n      const dv = new DataView(buf);\r\n      dv.setFloat64(0, value, false);\r\n      w.writeGobUint(dv.getBigUint64(0, false));\r\n      return;\r\n    }\r\n    case 'bytes': {\r\n      if (!(value instanceof Uint8Array)) throw new Error('Expected Uint8Array for bytes');\r\n      w.writeGobBytes(value);\r\n      return;\r\n    }\r\n    case 'string': {\r\n      if (typeof value !== 'string') throw new Error('Expected string');\r\n      w.writeGobString(value);\r\n      return;\r\n    }\r\n    case 'complex': {\r\n      throw new Error('complex not supported for encoding');\r\n    }\r\n    case 'interface': {\r\n      throw new Error('interface not supported for encoding');\r\n    }\r\n    case 'array': {\r\n      if (!(value instanceof Uint8Array) && !Array.isArray(value)) throw new Error('Expected array');\r\n      w.writeGobUint(BigInt(t.len));\r\n      const elemType = reg.get(t.elem);\r\n      if (value instanceof Uint8Array) {\r\n        if (value.byteLength !== t.len) throw new Error('Array byte length mismatch');\r\n        if (elemType.kind !== 'uint') throw new Error('Uint8Array arrays only supported for uint elements');\r\n        for (const b of value) w.writeGobUint(BigInt(b));\r\n        return;\r\n      }\r\n      if (value.length !== t.len) throw new Error('Array length mismatch');\r\n      for (const v of value) encodeValue(w, reg, t.elem, v);\r\n      return;\r\n    }\r\n    case 'slice': {\r\n      const elemType = reg.get(t.elem);\r\n      if (value instanceof Uint8Array && elemType.kind === 'uint') {\r\n        w.writeGobUint(BigInt(value.byteLength));\r\n        for (const b of value) w.writeGobUint(BigInt(b));\r\n        return;\r\n      }\r\n      if (!Array.isArray(value)) throw new Error('Expected slice as JS array');\r\n      w.writeGobUint(BigInt(value.length));\r\n      for (const v of value) encodeValue(w, reg, t.elem, v);\r\n      return;\r\n    }\r\n    case 'map': {\r\n      if (!value || typeof value !== 'object' || Array.isArray(value)) throw new Error('Expected map object');\r\n      const entries = Object.entries(value as Record<string, unknown>);\r\n      w.writeGobUint(BigInt(entries.length));\r\n      for (const [k, v] of entries) {\r\n        encodeValue(w, reg, t.key, k);\r\n        encodeValue(w, reg, t.elem, v);\r\n      }\r\n      return;\r\n    }\r\n    case 'struct': {\r\n      if (!value || typeof value !== 'object' || Array.isArray(value)) throw new Error('Expected struct object');\r\n      const obj = value as Record<string, unknown>;\r\n\r\n      let lastField = -1;\r\n      for (let i = 0; i < t.fields.length; i++) {\r\n        const field = t.fields[i]!;\r\n        const v = obj[field.name];\r\n\r\n        const fieldType = reg.get(field.typeId);\r\n        const shouldAlwaysSend = fieldType.kind === 'array';\r\n\r\n        // gob omits zero-value fields (except arrays). We approximate:\r\n        // - undefined => omitted\r\n        // - empty string => omitted\r\n        // - 0 => omitted\r\n        // - empty slice => omitted\r\n        // - map omitted only when undefined\r\n        let shouldSend = shouldAlwaysSend;\r\n        if (!shouldSend) {\r\n          if (v === undefined) {\r\n            shouldSend = false;\r\n          } else if (fieldType.kind === 'string' && v === '') {\r\n            shouldSend = false;\r\n          } else if ((fieldType.kind === 'int' || fieldType.kind === 'uint') && v === 0) {\r\n            shouldSend = false;\r\n          } else if (fieldType.kind === 'bytes' && v instanceof Uint8Array && v.byteLength === 0) {\r\n            shouldSend = false;\r\n          } else if (fieldType.kind === 'slice' && Array.isArray(v) && v.length === 0) {\r\n            shouldSend = false;\r\n          } else {\r\n            shouldSend = true;\r\n          }\r\n        }\r\n\r\n        if (!shouldSend) continue;\r\n\r\n        const delta = i - lastField;\r\n        w.writeGobUint(BigInt(delta));\r\n        encodeValue(w, reg, field.typeId, v);\r\n        lastField = i;\r\n      }\r\n      w.writeGobUint(0n);\r\n      return;\r\n    }\r\n  }\r\n}\r\n\r\nfunction encodeMessage(payload: Uint8Array): Uint8Array {\r\n  const w = new GobWriter();\r\n  w.writeGobUint(BigInt(payload.byteLength));\r\n  w.writeBytes(payload);\r\n  return w.concat();\r\n}\r\n\r\nfunction decodeWireTypeObject(reg: TypeRegistry, bytes: Uint8Array): Record<string, unknown> {\r\n  const r = new GobReader(bytes);\r\n  return decodeValue(r, reg, 16) as Record<string, unknown>;\r\n}\r\n\r\nfunction wireTypeToType(wire: Record<string, unknown>): GobType {\r\n  const pick = (k: string) => {\r\n    const v = wire[k];\r\n    if (v && typeof v === 'object' && !Array.isArray(v)) return v as Record<string, unknown>;\r\n    return undefined;\r\n  };\r\n\r\n  const arrayT = pick('ArrayT');\r\n  if (arrayT) {\r\n    const ct = arrayT['CommonType'] as Record<string, unknown>;\r\n    const elem = Number(arrayT['Elem']);\r\n    const len = Number(arrayT['Len']);\r\n    return { kind: 'array', name: String(ct?.['Name'] ?? ''), elem, len };\r\n  }\r\n\r\n  const sliceT = pick('SliceT');\r\n  if (sliceT) {\r\n    const ct = sliceT['CommonType'] as Record<string, unknown>;\r\n    const elem = Number(sliceT['Elem']);\r\n    return { kind: 'slice', name: String(ct?.['Name'] ?? ''), elem };\r\n  }\r\n\r\n  const structT = pick('StructT');\r\n  if (structT) {\r\n    const ct = structT['CommonType'] as Record<string, unknown>;\r\n    const fieldArr = structT['Field'];\r\n    if (!Array.isArray(fieldArr)) throw new Error('structType.Field must be an array');\r\n    const fields = fieldArr.map((f) => {\r\n      if (!f || typeof f !== 'object' || Array.isArray(f)) throw new Error('fieldType must be object');\r\n      const ff = f as Record<string, unknown>;\r\n      return { name: String(ff['Name']), typeId: Number(ff['Id']) };\r\n    });\r\n    return { kind: 'struct', name: String(ct?.['Name'] ?? ''), fields };\r\n  }\r\n\r\n  const mapT = pick('MapT');\r\n  if (mapT) {\r\n    const ct = mapT['CommonType'] as Record<string, unknown>;\r\n    const key = Number(mapT['Key']);\r\n    const elem = Number(mapT['Elem']);\r\n    return { kind: 'map', name: String(ct?.['Name'] ?? ''), key, elem };\r\n  }\r\n\r\n  throw new Error('Unsupported wireType (no ArrayT/SliceT/StructT/MapT)');\r\n}\r\n\r\nexport type DecodedGob = { typeId: number; value: unknown };\r\n\r\nexport function decodeGobSingleValue(stream: Uint8Array): DecodedGob {\r\n  const reg = new TypeRegistry(true);\r\n  const r = new GobReader(stream);\r\n\r\n  while (r.remaining() > 0) {\r\n    const msgLen = r.readGobUint();\r\n    const n = toSafeNumber(msgLen, 'message length');\r\n    const msg = r.readBytes(n);\r\n\r\n    const mr = new GobReader(msg);\r\n    const id = toSafeNumber(mr.readGobInt(), 'message type id');\r\n\r\n    if (id < 0) {\r\n      const typeId = -id;\r\n      if (typeId < 64) throw new Error(`Received reserved/builtin type id: ${typeId}`);\r\n      const wire = decodeWireTypeObject(reg, mr.readBytes(mr.remaining()));\r\n      reg.set(typeId, wireTypeToType(wire));\r\n      continue;\r\n    }\r\n\r\n    const value = decodeValue(mr, reg, id);\r\n    return { typeId: id, value };\r\n  }\r\n\r\n  throw new Error('No gob value found');\r\n}\r\n\r\nexport type EncodedTypeDef = { id: number; type: GobType };\r\n\r\nexport function encodeGobSingleValue(typeId: number, reg: Map<number, GobType>, value: unknown): Uint8Array {\r\n  const runtime = new TypeRegistry(true);\r\n  for (const [id, t] of reg.entries()) runtime.set(id, t);\r\n\r\n  const messages: Uint8Array[] = [];\r\n\r\n  // Emit type definitions in ascending id order for determinism.\r\n  const defs = [...reg.entries()].sort((a, b) => a[0] - b[0]);\r\n  for (const [id, t] of defs) {\r\n    const wireTypeValue = typeToWireTypeValue(id, t);\r\n    const payloadWriter = new GobWriter();\r\n    payloadWriter.writeGobInt(BigInt(-id));\r\n    encodeValue(payloadWriter, runtime, 16, wireTypeValue);\r\n    messages.push(encodeMessage(payloadWriter.concat()));\r\n  }\r\n\r\n  const payloadWriter = new GobWriter();\r\n  payloadWriter.writeGobInt(BigInt(typeId));\r\n  encodeValue(payloadWriter, runtime, typeId, value);\r\n  messages.push(encodeMessage(payloadWriter.concat()));\r\n\r\n  const total = messages.reduce((acc, b) => acc + b.byteLength, 0);\r\n  const out = new Uint8Array(total);\r\n  let off = 0;\r\n  for (const m of messages) {\r\n    out.set(m, off);\r\n    off += m.byteLength;\r\n  }\r\n  return out;\r\n}\r\n\r\nfunction typeToWireTypeValue(id: number, t: GobType): Record<string, unknown> {\r\n  const common = (name: string) => ({ Name: name, Id: id });\r\n\r\n  const wire: Record<string, unknown> = {};\r\n\r\n  if (t.kind === 'array') {\r\n    wire['ArrayT'] = { CommonType: common(t.name ?? ''), Elem: t.elem, Len: t.len };\r\n    return wire;\r\n  }\r\n  if (t.kind === 'slice') {\r\n    wire['SliceT'] = { CommonType: common(t.name ?? ''), Elem: t.elem };\r\n    return wire;\r\n  }\r\n  if (t.kind === 'map') {\r\n    wire['MapT'] = { CommonType: common(t.name ?? ''), Key: t.key, Elem: t.elem };\r\n    return wire;\r\n  }\r\n  if (t.kind === 'struct') {\r\n    wire['StructT'] = {\r\n      CommonType: common(t.name ?? ''),\r\n      Field: t.fields.map((f) => ({ Name: f.name, Id: f.typeId }))\r\n    };\r\n    return wire;\r\n  }\r\n\r\n  throw new Error(`Type kind ${t.kind} cannot be sent as a user type`);\r\n}\r\n\r\nexport function normalizeOptionalSha256(bytes: Uint8Array): Uint8Array | undefined {\r\n  if (bytes.byteLength !== 32) throw new Error('sha256 must be 32 bytes');\r\n  return isAllZeroBytes(bytes) ? undefined : bytes;\r\n}\r\n", "import type { MarkdownBundle, MediaBundle } from '../mdocx/types.js';\r\nimport { decodeGobSingleValue, normalizeOptionalSha256 } from './internal.js';\r\n\r\n/**\r\n * Minimal gob decoder for the MDOCX v1 canonical structs.\r\n *\r\n * NOTE: Go's encoding/gob wire format is non-trivial; this implementation supports\r\n * a constrained subset sufficient for the RFC payloads emitted by go-mdocx.\r\n */\r\nexport class GobDecoder {\r\n  decodeMarkdownBundle(_bytes: Uint8Array): MarkdownBundle {\r\n    const decoded = decodeGobSingleValue(_bytes);\r\n    const v = decoded.value;\r\n    if (!v || typeof v !== 'object' || Array.isArray(v)) throw new Error('MarkdownBundle gob must decode to an object');\r\n    const obj = v as Record<string, unknown>;\r\n\r\n    const bundleVersion = requireNumber(obj['BundleVersion'], 'BundleVersion');\r\n    const rootPath = optionalString(obj['RootPath']);\r\n    const filesRaw = obj['Files'];\r\n    if (!Array.isArray(filesRaw)) throw new Error('Files must be an array');\r\n\r\n    const files = filesRaw.map((f, idx) => {\r\n      if (!f || typeof f !== 'object' || Array.isArray(f)) throw new Error(`Files[${idx}] must be an object`);\r\n      const ff = f as Record<string, unknown>;\r\n      const path = requireString(ff['Path'], 'Path');\r\n      const content = ff['Content'] === undefined ? new Uint8Array() : requireBytes(ff['Content'], 'Content');\r\n      const mediaRefs = optionalStringArray(ff['MediaRefs']);\r\n      const attributes = optionalStringMap(ff['Attributes']);\r\n      return {\r\n        path,\r\n        content,\r\n        ...(mediaRefs ? { mediaRefs } : {}),\r\n        ...(attributes ? { attributes } : {})\r\n      };\r\n    });\r\n\r\n    return {\r\n      bundleVersion,\r\n      ...(rootPath ? { rootPath } : {}),\r\n      files\r\n    };\r\n  }\r\n\r\n  decodeMediaBundle(_bytes: Uint8Array): MediaBundle {\r\n    const decoded = decodeGobSingleValue(_bytes);\r\n    const v = decoded.value;\r\n    if (!v || typeof v !== 'object' || Array.isArray(v)) throw new Error('MediaBundle gob must decode to an object');\r\n    const obj = v as Record<string, unknown>;\r\n\r\n    const bundleVersion = requireNumber(obj['BundleVersion'], 'BundleVersion');\r\n    const itemsRaw = obj['Items'];\r\n    if (itemsRaw === undefined) {\r\n      return { bundleVersion, items: [] };\r\n    }\r\n    if (!Array.isArray(itemsRaw)) throw new Error('Items must be an array');\r\n\r\n    const items = itemsRaw.map((it, idx) => {\r\n      if (!it || typeof it !== 'object' || Array.isArray(it)) throw new Error(`Items[${idx}] must be an object`);\r\n      const ii = it as Record<string, unknown>;\r\n      const id = requireString(ii['ID'], 'ID');\r\n      const path = optionalString(ii['Path']);\r\n      const mimeType = optionalString(ii['MimeType'] ?? ii['MIMEType']);\r\n      const data = ii['Data'] === undefined ? new Uint8Array() : requireBytes(ii['Data'], 'Data');\r\n      const sha256Raw = ii['SHA256'];\r\n      const sha256 = sha256Raw instanceof Uint8Array ? normalizeOptionalSha256(sha256Raw) : undefined;\r\n      const attributes = optionalStringMap(ii['Attributes']);\r\n      return {\r\n        id,\r\n        ...(path ? { path } : {}),\r\n        ...(mimeType ? { mimeType } : {}),\r\n        data,\r\n        ...(sha256 ? { sha256 } : {}),\r\n        ...(attributes ? { attributes } : {})\r\n      };\r\n    });\r\n\r\n    return { bundleVersion, items };\r\n  }\r\n}\r\n\r\nfunction requireString(v: unknown, field: string): string {\r\n  if (typeof v !== 'string') throw new Error(`${field} must be a string`);\r\n  return v;\r\n}\r\n\r\nfunction requireNumber(v: unknown, field: string): number {\r\n  if (typeof v !== 'number' || !Number.isFinite(v)) throw new Error(`${field} must be a number`);\r\n  return v;\r\n}\r\n\r\nfunction requireBytes(v: unknown, field: string): Uint8Array {\r\n  if (!(v instanceof Uint8Array)) throw new Error(`${field} must be bytes`);\r\n  return v;\r\n}\r\n\r\nfunction optionalString(v: unknown): string | undefined {\r\n  if (v === undefined) return undefined;\r\n  if (typeof v !== 'string') throw new Error('Expected optional string');\r\n  return v.length ? v : undefined;\r\n}\r\n\r\nfunction optionalStringArray(v: unknown): string[] | undefined {\r\n  if (v === undefined) return undefined;\r\n  if (!Array.isArray(v)) throw new Error('Expected optional string array');\r\n  const arr = v.map((x) => {\r\n    if (typeof x !== 'string') throw new Error('Expected string in array');\r\n    return x;\r\n  });\r\n  return arr.length ? arr : undefined;\r\n}\r\n\r\nfunction optionalStringMap(v: unknown): Record<string, string> | undefined {\r\n  if (v === undefined) return undefined;\r\n  if (!v || typeof v !== 'object' || Array.isArray(v)) throw new Error('Expected optional map');\r\n  const out: Record<string, string> = {};\r\n  for (const [k, val] of Object.entries(v as Record<string, unknown>)) {\r\n    if (typeof val !== 'string') throw new Error('Expected string map values');\r\n    out[k] = val;\r\n  }\r\n  return Object.keys(out).length ? out : undefined;\r\n}\r\n", "import {\r\n  COMP_BR,\r\n  COMP_LZ4,\r\n  COMP_NONE,\r\n  COMP_ZIP,\r\n  COMP_ZSTD,\r\n  FIXED_HEADER_SIZE_V1,\r\n  HEADERFLAG_METADATA_JSON,\r\n  MDOCX_MAGIC,\r\n  SECTIONFLAG_HAS_UNCOMPRESSED_LEN,\r\n  SECTION_HEADER_SIZE,\r\n  SECTION_TYPE_MARKDOWN,\r\n  SECTION_TYPE_MEDIA\r\n} from './constants.js';\r\nimport { ByteReader, bytesEqual, decodeUtf8 } from './binary.js';\r\nimport type { MdocxDocument, MdocxHeader, MdocxMetadata, ReadLimits } from './types.js';\r\nimport { defaultReadLimits } from './types.js';\r\nimport { decompressPayload, type Compression } from './compression.js';\r\nimport { GobDecoder } from '../gob/decoder.js';\r\n\r\ntype SectionHeader = {\r\n  sectionType: number;\r\n  sectionFlags: number;\r\n  payloadLen: bigint;\r\n  reserved: number;\r\n};\r\n\r\nfunction parseHeader(r: ByteReader): MdocxHeader {\r\n  const magic = r.readBytes(8);\r\n  const version = r.readU16LE();\r\n  const headerFlags = r.readU16LE();\r\n  const fixedHeaderSize = r.readU32LE();\r\n  const metadataLength = r.readU32LE();\r\n  const reserved0 = r.readU32LE();\r\n  const reserved1 = r.readU64LE();\r\n  return { magic, version, headerFlags, fixedHeaderSize, metadataLength, reserved0, reserved1 };\r\n}\r\n\r\nfunction parseSectionHeader(r: ByteReader): SectionHeader {\r\n  const sectionType = r.readU16LE();\r\n  const sectionFlags = r.readU16LE();\r\n  const payloadLen = r.readU64LE();\r\n  const reserved = r.readU32LE();\r\n  return { sectionType, sectionFlags, payloadLen, reserved };\r\n}\r\n\r\nfunction compressionFromFlags(sectionFlags: number): { alg: Compression; hasUncompressedLen: boolean } {\r\n  const algBits = sectionFlags & 0x000f;\r\n  const hasUncompressedLen = (sectionFlags & SECTIONFLAG_HAS_UNCOMPRESSED_LEN) !== 0;\r\n  switch (algBits) {\r\n    case COMP_NONE:\r\n      return { alg: 'none', hasUncompressedLen };\r\n    case COMP_ZIP:\r\n      return { alg: 'zip', hasUncompressedLen };\r\n    case COMP_ZSTD:\r\n      return { alg: 'zstd', hasUncompressedLen };\r\n    case COMP_LZ4:\r\n      return { alg: 'lz4', hasUncompressedLen };\r\n    case COMP_BR:\r\n      return { alg: 'br', hasUncompressedLen };\r\n    default:\r\n      throw new Error(`Unknown compression value: 0x${algBits.toString(16)}`);\r\n  }\r\n}\r\n\r\nfunction readMetadata(r: ByteReader, header: MdocxHeader, limits: ReadLimits): MdocxMetadata | undefined {\r\n  if (header.metadataLength === 0) return undefined;\r\n  if (header.metadataLength > limits.maxMetadataLength) {\r\n    throw new Error(`MetadataLength too large: ${header.metadataLength}`);\r\n  }\r\n  const bytes = r.readBytes(header.metadataLength);\r\n  if ((header.headerFlags & HEADERFLAG_METADATA_JSON) === 0) {\r\n    // v1 only defines JSON when the flag is set; treat others as opaque.\r\n    return { raw: bytes } as unknown as MdocxMetadata;\r\n  }\r\n  const text = decodeUtf8(bytes);\r\n  const json = JSON.parse(text) as unknown;\r\n  if (!json || typeof json !== 'object' || Array.isArray(json)) throw new Error('Metadata JSON must be an object');\r\n  return json as MdocxMetadata;\r\n}\r\n\r\nfunction decodeSectionPayload(\r\n  r: ByteReader,\r\n  section: SectionHeader,\r\n  limits: ReadLimits,\r\n  expectedType: number,\r\n  maxUncompressed: number\r\n): Uint8Array {\r\n  if (section.sectionType !== expectedType) {\r\n    throw new Error(`Unexpected section type: ${section.sectionType}, expected ${expectedType}`);\r\n  }\r\n  if (section.reserved !== 0) throw new Error('Section reserved must be 0');\r\n  if (section.payloadLen > BigInt(limits.maxSectionPayloadLen)) {\r\n    throw new Error(`Section payloadLen too large: ${section.payloadLen}`);\r\n  }\r\n  const payloadLenNum = Number(section.payloadLen);\r\n  if (!Number.isSafeInteger(payloadLenNum) || payloadLenNum < 0) throw new Error('payloadLen is not a safe JS integer');\r\n\r\n  const payload = r.readBytes(payloadLenNum);\r\n  const { alg, hasUncompressedLen } = compressionFromFlags(section.sectionFlags);\r\n  if (alg === 'none') {\r\n    if (hasUncompressedLen) throw new Error('HAS_UNCOMPRESSED_LEN must be 0 for COMP_NONE');\r\n    return payload;\r\n  }\r\n\r\n  if (!hasUncompressedLen) throw new Error('Compressed payloads MUST set HAS_UNCOMPRESSED_LEN');\r\n  if (payload.byteLength < 8) throw new Error('Compressed payload missing UncompressedLen prefix');\r\n\r\n  const dv = new DataView(payload.buffer, payload.byteOffset, payload.byteLength);\r\n  const uncompressedLen = dv.getBigUint64(0, true);\r\n  if (uncompressedLen > BigInt(maxUncompressed)) throw new Error(`UncompressedLen too large: ${uncompressedLen}`);\r\n\r\n  const expectedSize = Number(uncompressedLen);\r\n  if (!Number.isSafeInteger(expectedSize) || expectedSize < 0) throw new Error('UncompressedLen is not a safe JS integer');\r\n\r\n  const compressedBytes = payload.subarray(8);\r\n  return decompressPayload(alg, compressedBytes, expectedSize);\r\n}\r\n\r\nexport async function readMdocx(bytes: Uint8Array, limits: ReadLimits = defaultReadLimits): Promise<MdocxDocument> {\r\n  const r = new ByteReader(bytes);\r\n  if (r.remaining() < FIXED_HEADER_SIZE_V1) throw new Error('File too small');\r\n\r\n  const header = parseHeader(r);\r\n  if (!bytesEqual(header.magic, MDOCX_MAGIC)) throw new Error('Bad magic');\r\n  if (header.fixedHeaderSize !== FIXED_HEADER_SIZE_V1) throw new Error(`FixedHeaderSize must be ${FIXED_HEADER_SIZE_V1}`);\r\n  if (header.version !== 1) throw new Error(`Unsupported version: ${header.version}`);\r\n  if (header.reserved0 !== 0 || header.reserved1 !== 0n) throw new Error('Reserved header fields must be 0');\r\n\r\n  const metadata = readMetadata(r, header, limits);\r\n\r\n  if (r.remaining() < SECTION_HEADER_SIZE) throw new Error('Missing markdown section header');\r\n  const mdSection = parseSectionHeader(r);\r\n  const mdGob = decodeSectionPayload(r, mdSection, limits, SECTION_TYPE_MARKDOWN, limits.maxMarkdownUncompressed);\r\n\r\n  if (r.remaining() < SECTION_HEADER_SIZE) throw new Error('Missing media section header');\r\n  const mediaSection = parseSectionHeader(r);\r\n\r\n  // Per RFC: MAY be empty.\r\n  let mediaGob: Uint8Array = new Uint8Array();\r\n  if (mediaSection.payloadLen === 0n) {\r\n    if (mediaSection.sectionType !== SECTION_TYPE_MEDIA) {\r\n      throw new Error(`Unexpected section type: ${mediaSection.sectionType}, expected ${SECTION_TYPE_MEDIA}`);\r\n    }\r\n    if (mediaSection.reserved !== 0) throw new Error('Section reserved must be 0');\r\n    mediaGob = new Uint8Array();\r\n  } else {\r\n    mediaGob = decodeSectionPayload(r, mediaSection, limits, SECTION_TYPE_MEDIA, limits.maxMediaUncompressed);\r\n  }\r\n\r\n  const decoder = new GobDecoder();\r\n  const markdown = decoder.decodeMarkdownBundle(mdGob);\r\n  const media = mediaGob.byteLength ? decoder.decodeMediaBundle(mediaGob) : { bundleVersion: 1, items: [] };\r\n\r\n  if (metadata) {\r\n    return { header, metadata, markdown, media };\r\n  }\r\n  return { header, markdown, media };\r\n}\r\n", "import type { MarkdownBundle, MediaBundle } from '../mdocx/types.js';\r\nimport { encodeGobSingleValue } from './internal.js';\r\n\r\ntype GobTypeId = number;\r\n\r\ntype GobType =\r\n  | { kind: 'array'; elem: GobTypeId; len: number; name?: string }\r\n  | { kind: 'slice'; elem: GobTypeId; name?: string }\r\n  | { kind: 'map'; key: GobTypeId; elem: GobTypeId; name?: string }\r\n  | { kind: 'struct'; fields: Array<{ name: string; typeId: GobTypeId }>; name?: string };\r\n\r\nconst T_UINT = 3;\r\nconst T_BYTES = 5;\r\nconst T_STRING = 6;\r\n\r\n// User type IDs (>=64). Deterministic IDs make our output stable.\r\nconst ID_MARKDOWN_BUNDLE = 65;\r\nconst ID_MARKDOWN_FILE = 66;\r\nconst ID_SLICE_MARKDOWN_FILE = 67;\r\nconst ID_SLICE_STRING = 68;\r\nconst ID_MAP_STRING_STRING = 69;\r\nconst ID_MEDIA_BUNDLE = 70;\r\nconst ID_MEDIA_ITEM = 71;\r\nconst ID_SLICE_MEDIA_ITEM = 72;\r\nconst ID_ARRAY_32_UINT8 = 73;\r\n\r\nfunction buildMdocxTypeRegistry(): Map<number, GobType> {\r\n  const reg = new Map<number, GobType>();\r\n\r\n  reg.set(ID_SLICE_STRING, { kind: 'slice', name: '[]string', elem: T_STRING });\r\n  reg.set(ID_MAP_STRING_STRING, { kind: 'map', name: 'map[string]string', key: T_STRING, elem: T_STRING });\r\n\r\n  reg.set(ID_MARKDOWN_FILE, {\r\n    kind: 'struct',\r\n    name: 'MarkdownFile',\r\n    fields: [\r\n      { name: 'Path', typeId: T_STRING },\r\n      { name: 'Content', typeId: T_BYTES },\r\n      { name: 'MediaRefs', typeId: ID_SLICE_STRING },\r\n      { name: 'Attributes', typeId: ID_MAP_STRING_STRING }\r\n    ]\r\n  });\r\n\r\n  reg.set(ID_SLICE_MARKDOWN_FILE, { kind: 'slice', name: '[]MarkdownFile', elem: ID_MARKDOWN_FILE });\r\n\r\n  reg.set(ID_MARKDOWN_BUNDLE, {\r\n    kind: 'struct',\r\n    name: 'MarkdownBundle',\r\n    fields: [\r\n      { name: 'BundleVersion', typeId: T_UINT },\r\n      { name: 'RootPath', typeId: T_STRING },\r\n      { name: 'Files', typeId: ID_SLICE_MARKDOWN_FILE }\r\n    ]\r\n  });\r\n\r\n  reg.set(ID_ARRAY_32_UINT8, { kind: 'array', name: '[32]uint8', elem: T_UINT, len: 32 });\r\n\r\n  reg.set(ID_MEDIA_ITEM, {\r\n    kind: 'struct',\r\n    name: 'MediaItem',\r\n    fields: [\r\n      { name: 'ID', typeId: T_STRING },\r\n      { name: 'Path', typeId: T_STRING },\r\n      { name: 'MimeType', typeId: T_STRING },\r\n      { name: 'Data', typeId: T_BYTES },\r\n      { name: 'SHA256', typeId: ID_ARRAY_32_UINT8 },\r\n      { name: 'Attributes', typeId: ID_MAP_STRING_STRING }\r\n    ]\r\n  });\r\n\r\n  reg.set(ID_SLICE_MEDIA_ITEM, { kind: 'slice', name: '[]MediaItem', elem: ID_MEDIA_ITEM });\r\n\r\n  reg.set(ID_MEDIA_BUNDLE, {\r\n    kind: 'struct',\r\n    name: 'MediaBundle',\r\n    fields: [\r\n      { name: 'BundleVersion', typeId: T_UINT },\r\n      { name: 'Items', typeId: ID_SLICE_MEDIA_ITEM }\r\n    ]\r\n  });\r\n\r\n  return reg;\r\n}\r\n\r\n/**\r\n * Minimal gob encoder for the MDOCX v1 canonical structs.\r\n *\r\n * NOTE: Go's encoding/gob wire format is non-trivial; this implementation supports\r\n * a constrained subset sufficient for MDOCX v1 bundles.\r\n */\r\nexport class GobEncoder {\r\n  encodeMarkdownBundle(_bundle: MarkdownBundle): Uint8Array {\r\n    const reg = buildMdocxTypeRegistry();\r\n    const value = {\r\n      BundleVersion: _bundle.bundleVersion,\r\n      RootPath: _bundle.rootPath ?? '',\r\n      Files: _bundle.files.map((f) => ({\r\n        Path: f.path,\r\n        Content: f.content,\r\n        MediaRefs: f.mediaRefs ?? [],\r\n        ...(f.attributes ? { Attributes: f.attributes } : {})\r\n      }))\r\n    };\r\n    return encodeGobSingleValue(ID_MARKDOWN_BUNDLE, reg, value);\r\n  }\r\n\r\n  encodeMediaBundle(_bundle: MediaBundle): Uint8Array {\r\n    const reg = buildMdocxTypeRegistry();\r\n    const value = {\r\n      BundleVersion: _bundle.bundleVersion,\r\n      Items: _bundle.items.map((it) => ({\r\n        ID: it.id,\r\n        Path: it.path ?? '',\r\n        MimeType: it.mimeType ?? '',\r\n        Data: it.data,\r\n        SHA256: it.sha256 ?? new Uint8Array(32),\r\n        ...(it.attributes ? { Attributes: it.attributes } : {})\r\n      }))\r\n    };\r\n    return encodeGobSingleValue(ID_MEDIA_BUNDLE, reg, value);\r\n  }\r\n}\r\n", "import {\r\n  COMP_BR,\r\n  COMP_LZ4,\r\n  COMP_NONE,\r\n  COMP_ZIP,\r\n  COMP_ZSTD,\r\n  FIXED_HEADER_SIZE_V1,\r\n  HEADERFLAG_METADATA_JSON,\r\n  MDOCX_MAGIC,\r\n  SECTIONFLAG_HAS_UNCOMPRESSED_LEN,\r\n  SECTION_TYPE_MARKDOWN,\r\n  SECTION_TYPE_MEDIA\r\n} from './constants.js';\r\nimport { ByteWriter, encodeUtf8 } from './binary.js';\r\nimport type { MdocxDocument, MdocxMetadata, MdocxCompression, MarkdownBundle, MediaBundle, MediaItem } from './types.js';\r\nimport { compressPayload, compressPayloadAsync, initZstd } from './compression.js';\r\nimport { GobEncoder } from '../gob/encoder.js';\r\nimport { createHash } from 'node:crypto';\r\n\r\nfunction compToBits(comp: MdocxCompression): number {\r\n  switch (comp) {\r\n    case 'none':\r\n      return COMP_NONE;\r\n    case 'zip':\r\n      return COMP_ZIP;\r\n    case 'zstd':\r\n      return COMP_ZSTD;\r\n    case 'lz4':\r\n      return COMP_LZ4;\r\n    case 'br':\r\n      return COMP_BR;\r\n  }\r\n}\r\n\r\nfunction writeFixedHeader(w: ByteWriter, metadataLength: number, headerFlags: number): void {\r\n  w.writeBytes(MDOCX_MAGIC);\r\n  w.writeU16LE(1);\r\n  w.writeU16LE(headerFlags);\r\n  w.writeU32LE(FIXED_HEADER_SIZE_V1);\r\n  w.writeU32LE(metadataLength);\r\n  w.writeU32LE(0);\r\n  w.writeU64LE(0n);\r\n}\r\n\r\nfunction writeSection(w: ByteWriter, sectionType: number, comp: MdocxCompression, gobBytes: Uint8Array): void {\r\n  const compBits = compToBits(comp);\r\n  let sectionFlags = compBits;\r\n  let payload: Uint8Array;\r\n\r\n  if (comp === 'none') {\r\n    payload = gobBytes;\r\n  } else {\r\n    sectionFlags |= SECTIONFLAG_HAS_UNCOMPRESSED_LEN;\r\n    const compressed = compressPayload(comp, gobBytes);\r\n    const ww = new ByteWriter();\r\n    ww.writeU64LE(BigInt(gobBytes.byteLength));\r\n    ww.writeBytes(compressed);\r\n    payload = ww.concat();\r\n  }\r\n\r\n  w.writeU16LE(sectionType);\r\n  w.writeU16LE(sectionFlags);\r\n  w.writeU64LE(BigInt(payload.byteLength));\r\n  w.writeU32LE(0);\r\n  w.writeBytes(payload);\r\n}\r\n\r\nasync function writeSectionAsync(w: ByteWriter, sectionType: number, comp: MdocxCompression, gobBytes: Uint8Array): Promise<void> {\r\n  const compBits = compToBits(comp);\r\n  let sectionFlags = compBits;\r\n  let payload: Uint8Array;\r\n\r\n  if (comp === 'none') {\r\n    payload = gobBytes;\r\n  } else {\r\n    sectionFlags |= SECTIONFLAG_HAS_UNCOMPRESSED_LEN;\r\n    const compressed = await compressPayloadAsync(comp, gobBytes);\r\n    const ww = new ByteWriter();\r\n    ww.writeU64LE(BigInt(gobBytes.byteLength));\r\n    ww.writeBytes(compressed);\r\n    payload = ww.concat();\r\n  }\r\n\r\n  w.writeU16LE(sectionType);\r\n  w.writeU16LE(sectionFlags);\r\n  w.writeU64LE(BigInt(payload.byteLength));\r\n  w.writeU32LE(0);\r\n  w.writeBytes(payload);\r\n}\r\n\r\n/**\r\n * Compute SHA256 hash of data.\r\n */\r\nfunction computeSha256(data: Uint8Array): Uint8Array {\r\n  return createHash('sha256').update(data).digest();\r\n}\r\n\r\n/**\r\n * Ensure all media items have SHA256 hashes populated.\r\n * Per RFC 10, writers SHOULD populate SHA256 for each MediaItem.\r\n */\r\nfunction ensureMediaSha256(media: MediaBundle): MediaBundle {\r\n  const items = media.items.map((item): MediaItem => {\r\n    if (item.sha256) return item;\r\n    return { ...item, sha256: computeSha256(item.data) };\r\n  });\r\n  return { ...media, items };\r\n}\r\n\r\nexport type WriteOptions = {\r\n  /** Metadata to include in the file header. */\r\n  metadata?: MdocxMetadata;\r\n  /** Compression algorithm for markdown section. Default: 'zip'. */\r\n  markdownCompression?: MdocxCompression;\r\n  /** Compression algorithm for media section. Default: 'zip'. */\r\n  mediaCompression?: MdocxCompression;\r\n  /** \r\n   * Auto-populate SHA256 hashes for media items that don't have them.\r\n   * Default: true (per RFC 10).\r\n   */\r\n  autoPopulateSha256?: boolean;\r\n};\r\n\r\n/**\r\n * Write MDOCX file synchronously.\r\n * Note: ZSTD compression requires `initZstd()` to be called first.\r\n * Use `writeMdocxAsync` for automatic ZSTD initialization.\r\n */\r\nexport function writeMdocx(markdown: MarkdownBundle, media: MediaBundle, opts: WriteOptions = {}): Uint8Array {\r\n  const encoder = new GobEncoder();\r\n  const mdGob = encoder.encodeMarkdownBundle(markdown);\r\n  \r\n  const processedMedia = opts.autoPopulateSha256 !== false ? ensureMediaSha256(media) : media;\r\n  const mediaGob = processedMedia.items.length ? encoder.encodeMediaBundle(processedMedia) : new Uint8Array();\r\n\r\n  const metaBytes = opts.metadata ? encodeUtf8(JSON.stringify(opts.metadata)) : new Uint8Array();\r\n  const headerFlags = opts.metadata ? HEADERFLAG_METADATA_JSON : 0;\r\n\r\n  const w = new ByteWriter();\r\n  writeFixedHeader(w, metaBytes.byteLength, headerFlags);\r\n  if (metaBytes.byteLength) w.writeBytes(metaBytes);\r\n\r\n  writeSection(w, SECTION_TYPE_MARKDOWN, opts.markdownCompression ?? 'zip', mdGob);\r\n\r\n  if (mediaGob.byteLength === 0) {\r\n    // Emit empty media section\r\n    w.writeU16LE(SECTION_TYPE_MEDIA);\r\n    w.writeU16LE(COMP_NONE);\r\n    w.writeU64LE(0n);\r\n    w.writeU32LE(0);\r\n  } else {\r\n    writeSection(w, SECTION_TYPE_MEDIA, opts.mediaCompression ?? 'zip', mediaGob);\r\n  }\r\n\r\n  return w.concat();\r\n}\r\n\r\n/**\r\n * Write MDOCX file asynchronously with automatic ZSTD initialization.\r\n * Preferred method when using ZSTD compression.\r\n */\r\nexport async function writeMdocxAsync(markdown: MarkdownBundle, media: MediaBundle, opts: WriteOptions = {}): Promise<Uint8Array> {\r\n  const encoder = new GobEncoder();\r\n  const mdGob = encoder.encodeMarkdownBundle(markdown);\r\n  \r\n  const processedMedia = opts.autoPopulateSha256 !== false ? ensureMediaSha256(media) : media;\r\n  const mediaGob = processedMedia.items.length ? encoder.encodeMediaBundle(processedMedia) : new Uint8Array();\r\n\r\n  const metaBytes = opts.metadata ? encodeUtf8(JSON.stringify(opts.metadata)) : new Uint8Array();\r\n  const headerFlags = opts.metadata ? HEADERFLAG_METADATA_JSON : 0;\r\n\r\n  const w = new ByteWriter();\r\n  writeFixedHeader(w, metaBytes.byteLength, headerFlags);\r\n  if (metaBytes.byteLength) w.writeBytes(metaBytes);\r\n\r\n  await writeSectionAsync(w, SECTION_TYPE_MARKDOWN, opts.markdownCompression ?? 'zip', mdGob);\r\n\r\n  if (mediaGob.byteLength === 0) {\r\n    // Emit empty media section\r\n    w.writeU16LE(SECTION_TYPE_MEDIA);\r\n    w.writeU16LE(COMP_NONE);\r\n    w.writeU64LE(0n);\r\n    w.writeU32LE(0);\r\n  } else {\r\n    await writeSectionAsync(w, SECTION_TYPE_MEDIA, opts.mediaCompression ?? 'zip', mediaGob);\r\n  }\r\n\r\n  return w.concat();\r\n}\r\n\r\n/**\r\n * Convert an MdocxDocument to bytes synchronously.\r\n */\r\nexport function documentToMdocxBytes(doc: MdocxDocument, opts: Omit<WriteOptions, 'metadata'> = {}): Uint8Array {\r\n  if (doc.metadata) {\r\n    return writeMdocx(doc.markdown, doc.media, { ...opts, metadata: doc.metadata });\r\n  }\r\n  return writeMdocx(doc.markdown, doc.media, opts);\r\n}\r\n\r\n/**\r\n * Convert an MdocxDocument to bytes asynchronously.\r\n * Preferred when using ZSTD compression.\r\n */\r\nexport async function documentToMdocxBytesAsync(doc: MdocxDocument, opts: Omit<WriteOptions, 'metadata'> = {}): Promise<Uint8Array> {\r\n  if (doc.metadata) {\r\n    return writeMdocxAsync(doc.markdown, doc.media, { ...opts, metadata: doc.metadata });\r\n  }\r\n  return writeMdocxAsync(doc.markdown, doc.media, opts);\r\n}\r\n\r\n/**\r\n * Initialize ZSTD compression support.\r\n * Must be called before using writeMdocx with zstd compression.\r\n * Not needed if using writeMdocxAsync.\r\n */\r\nexport { initZstd } from './compression.js';\r\n", "import { createHash } from 'node:crypto';\r\nimport type { MdocxDocument, MarkdownFile, MediaItem } from './types.js';\r\n\r\n/**\r\n * Validation issue severity levels.\r\n */\r\nexport type ValidationSeverity = 'error' | 'warning' | 'info';\r\n\r\n/**\r\n * A validation issue with location and severity.\r\n */\r\nexport type ValidationIssue = {\r\n  /** Severity level */\r\n  severity: ValidationSeverity;\r\n  /** Human-readable message */\r\n  message: string;\r\n  /** Path to the problematic element (e.g., 'markdown.files[0].path') */\r\n  path?: string;\r\n  /** Additional context */\r\n  details?: Record<string, unknown>;\r\n};\r\n\r\n/**\r\n * Validation options.\r\n */\r\nexport type ValidationOptions = {\r\n  /** Check SHA256 hashes (default: true) */\r\n  verifyHashes?: boolean;\r\n  /** Check path validity (default: true) */\r\n  checkPaths?: boolean;\r\n  /** Check for duplicate IDs/paths (default: true) */\r\n  checkDuplicates?: boolean;\r\n  /** Report missing optional fields as warnings (default: false) */\r\n  warnOnMissingOptional?: boolean;\r\n  /** Include info-level issues (default: false) */\r\n  includeInfo?: boolean;\r\n};\r\n\r\n/**\r\n * Validation result.\r\n */\r\nexport type ValidationResult = {\r\n  /** Whether the document is valid (no errors) */\r\n  valid: boolean;\r\n  /** All issues found */\r\n  issues: ValidationIssue[];\r\n  /** Count of errors */\r\n  errorCount: number;\r\n  /** Count of warnings */\r\n  warningCount: number;\r\n  /** Summary statistics */\r\n  stats: {\r\n    markdownFileCount: number;\r\n    mediaItemCount: number;\r\n    totalMarkdownBytes: number;\r\n    totalMediaBytes: number;\r\n  };\r\n};\r\n\r\nfunction isSafeRelativePath(p: string): boolean {\r\n  if (!p) return false;\r\n  if (p.startsWith('/')) return false;\r\n  const parts = p.split('/');\r\n  if (parts.some((s) => s === '..')) return false;\r\n  if (parts.some((s) => s.length === 0)) return false;\r\n  return true;\r\n}\r\n\r\nfunction toHex(bytes: Uint8Array): string {\r\n  return Buffer.from(bytes).toString('hex');\r\n}\r\n\r\n/**\r\n * Validate an MDOCX document with detailed issue reporting.\r\n */\r\nexport function validateMdocxDetailed(\r\n  doc: MdocxDocument,\r\n  options: ValidationOptions = {}\r\n): ValidationResult {\r\n  const issues: ValidationIssue[] = [];\r\n  const opts = {\r\n    verifyHashes: true,\r\n    checkPaths: true,\r\n    checkDuplicates: true,\r\n    warnOnMissingOptional: false,\r\n    includeInfo: false,\r\n    ...options\r\n  };\r\n\r\n  const addIssue = (\r\n    severity: ValidationSeverity,\r\n    message: string,\r\n    path?: string,\r\n    details?: Record<string, unknown>\r\n  ) => {\r\n    if (severity === 'info' && !opts.includeInfo) return;\r\n    const issue: ValidationIssue = { severity, message };\r\n    if (path !== undefined) issue.path = path;\r\n    if (details !== undefined) issue.details = details;\r\n    issues.push(issue);\r\n  };\r\n\r\n  // Validate markdown bundle\r\n  if (doc.markdown.bundleVersion !== 1) {\r\n    addIssue('error', 'markdown.bundleVersion must be 1', 'markdown.bundleVersion');\r\n  }\r\n  \r\n  if (!doc.markdown.files.length) {\r\n    addIssue('error', 'markdown.files must be non-empty', 'markdown.files');\r\n  }\r\n\r\n  const mdPaths = new Set<string>();\r\n  doc.markdown.files.forEach((f, idx) => {\r\n    const basePath = `markdown.files[${idx}]`;\r\n    \r\n    if (opts.checkPaths && !isSafeRelativePath(f.path)) {\r\n      addIssue('error', `Invalid markdown path: \"${f.path}\"`, `${basePath}.path`, { path: f.path });\r\n    }\r\n    \r\n    if (opts.checkDuplicates) {\r\n      if (mdPaths.has(f.path)) {\r\n        addIssue('error', `Duplicate markdown path: \"${f.path}\"`, `${basePath}.path`);\r\n      }\r\n      mdPaths.add(f.path);\r\n    }\r\n\r\n    // Optional field warnings\r\n    if (opts.warnOnMissingOptional) {\r\n      if (!f.mediaRefs?.length) {\r\n        addIssue('info', 'No media references', `${basePath}.mediaRefs`);\r\n      }\r\n    }\r\n  });\r\n\r\n  // Validate media bundle\r\n  if (doc.media.bundleVersion !== 1) {\r\n    addIssue('error', 'media.bundleVersion must be 1', 'media.bundleVersion');\r\n  }\r\n\r\n  const mediaIds = new Set<string>();\r\n  doc.media.items.forEach((m, idx) => {\r\n    const basePath = `media.items[${idx}]`;\r\n    \r\n    if (!m.id) {\r\n      addIssue('error', 'MediaItem.id must be non-empty', `${basePath}.id`);\r\n    }\r\n    \r\n    if (opts.checkDuplicates) {\r\n      if (mediaIds.has(m.id)) {\r\n        addIssue('error', `Duplicate media ID: \"${m.id}\"`, `${basePath}.id`);\r\n      }\r\n      mediaIds.add(m.id);\r\n    }\r\n\r\n    if (opts.checkPaths && m.path && !isSafeRelativePath(m.path)) {\r\n      addIssue('error', `Invalid media path: \"${m.path}\"`, `${basePath}.path`, { path: m.path });\r\n    }\r\n\r\n    if (opts.verifyHashes && m.sha256) {\r\n      if (m.sha256.byteLength !== 32) {\r\n        addIssue('error', `MediaItem.sha256 must be 32 bytes for id=\"${m.id}\"`, `${basePath}.sha256`);\r\n      } else {\r\n        const computed = createHash('sha256').update(m.data).digest();\r\n        if (toHex(computed) !== toHex(m.sha256)) {\r\n          addIssue('error', `MediaItem.sha256 mismatch for id=\"${m.id}\"`, `${basePath}.sha256`, {\r\n            stored: toHex(m.sha256),\r\n            computed: toHex(computed)\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    // Optional field warnings\r\n    if (opts.warnOnMissingOptional) {\r\n      if (!m.mimeType) {\r\n        addIssue('warning', `Missing MIME type for id=\"${m.id}\"`, `${basePath}.mimeType`);\r\n      }\r\n      if (!m.sha256) {\r\n        addIssue('warning', `Missing SHA256 hash for id=\"${m.id}\"`, `${basePath}.sha256`);\r\n      }\r\n    }\r\n  });\r\n\r\n  // Compute stats\r\n  const stats = {\r\n    markdownFileCount: doc.markdown.files.length,\r\n    mediaItemCount: doc.media.items.length,\r\n    totalMarkdownBytes: doc.markdown.files.reduce((acc, f) => acc + f.content.byteLength, 0),\r\n    totalMediaBytes: doc.media.items.reduce((acc, m) => acc + m.data.byteLength, 0)\r\n  };\r\n\r\n  const errorCount = issues.filter(i => i.severity === 'error').length;\r\n  const warningCount = issues.filter(i => i.severity === 'warning').length;\r\n\r\n  return {\r\n    valid: errorCount === 0,\r\n    issues,\r\n    errorCount,\r\n    warningCount,\r\n    stats\r\n  };\r\n}\r\n\r\n/**\r\n * Simple validation that returns a list of error messages.\r\n * For backward compatibility.\r\n */\r\nexport function validateMdocx(doc: MdocxDocument): string[] {\r\n  const result = validateMdocxDetailed(doc);\r\n  return result.issues\r\n    .filter(i => i.severity === 'error')\r\n    .map(i => i.message);\r\n}\r\n\r\n/**\r\n * Check if a document is valid.\r\n */\r\nexport function isValidMdocx(doc: MdocxDocument): boolean {\r\n  return validateMdocxDetailed(doc).valid;\r\n}\r\n", "/**\r\n * Media reference resolution utilities for MDOCX files.\r\n * \r\n * Per RFC 8, MDOCX supports two reference schemes:\r\n * - By ID: `mdocx://media/<ID>`\r\n * - By container path: relative paths like `assets/logo.png`\r\n */\r\n\r\nimport type { MediaItem, MdocxDocument, MediaBundle, MarkdownFile } from './types.js';\r\n\r\n/** URI scheme for media references by ID */\r\nexport const MDOCX_MEDIA_URI_PREFIX = 'mdocx://media/';\r\n\r\n/**\r\n * Parsed media reference.\r\n */\r\nexport type MediaReference = \r\n  | { type: 'id'; id: string }\r\n  | { type: 'path'; path: string };\r\n\r\n/**\r\n * Parse a media reference string.\r\n * \r\n * @param ref - The reference string (e.g., 'mdocx://media/logo_png' or 'assets/logo.png')\r\n * @returns Parsed reference or undefined if not a valid media reference\r\n */\r\nexport function parseMediaReference(ref: string): MediaReference | undefined {\r\n  if (!ref) return undefined;\r\n  \r\n  if (ref.startsWith(MDOCX_MEDIA_URI_PREFIX)) {\r\n    const id = ref.slice(MDOCX_MEDIA_URI_PREFIX.length);\r\n    if (id) return { type: 'id', id };\r\n    return undefined;\r\n  }\r\n  \r\n  // Treat as path reference if it doesn't look like an absolute URL\r\n  if (!ref.includes('://')) {\r\n    return { type: 'path', path: ref };\r\n  }\r\n  \r\n  return undefined;\r\n}\r\n\r\n/**\r\n * Create a media reference URI for an ID.\r\n */\r\nexport function createMediaIdRef(id: string): string {\r\n  return `${MDOCX_MEDIA_URI_PREFIX}${id}`;\r\n}\r\n\r\n/**\r\n * Resolve a media reference to a MediaItem.\r\n * \r\n * Per RFC 8:\r\n * - Resolves `mdocx://media/<ID>` against MediaItem.ID\r\n * - Resolves relative paths against MediaItem.Path\r\n * - ID resolution takes precedence for mdocx:// URIs\r\n * \r\n * @param ref - The reference string\r\n * @param media - The media bundle to search\r\n * @param basePath - Optional base path for resolving relative references\r\n * @returns The matched MediaItem or undefined\r\n */\r\nexport function resolveMediaReference(\r\n  ref: string,\r\n  media: MediaBundle,\r\n  basePath?: string\r\n): MediaItem | undefined {\r\n  const parsed = parseMediaReference(ref);\r\n  if (!parsed) return undefined;\r\n  \r\n  if (parsed.type === 'id') {\r\n    return media.items.find(item => item.id === parsed.id);\r\n  }\r\n  \r\n  // Path resolution\r\n  const targetPath = normalizePath(parsed.path, basePath);\r\n  return media.items.find(item => \r\n    item.path && normalizePath(item.path) === targetPath\r\n  );\r\n}\r\n\r\n/**\r\n * Normalize a path for comparison.\r\n */\r\nfunction normalizePath(path: string, basePath?: string): string {\r\n  // Resolve relative path against base\r\n  if (basePath && !path.startsWith('/')) {\r\n    const baseDir = basePath.includes('/') \r\n      ? basePath.substring(0, basePath.lastIndexOf('/'))\r\n      : '';\r\n    path = baseDir ? `${baseDir}/${path}` : path;\r\n  }\r\n  \r\n  // Normalize: remove redundant slashes, resolve . and ..\r\n  const parts = path.split('/').filter(p => p && p !== '.');\r\n  const result: string[] = [];\r\n  \r\n  for (const part of parts) {\r\n    if (part === '..') {\r\n      result.pop();\r\n    } else {\r\n      result.push(part);\r\n    }\r\n  }\r\n  \r\n  return result.join('/');\r\n}\r\n\r\n/**\r\n * Create a resolver bound to a specific document.\r\n */\r\nexport class MediaResolver {\r\n  constructor(private readonly doc: MdocxDocument) {}\r\n\r\n  /**\r\n   * Resolve a media reference from a markdown file.\r\n   * \r\n   * @param ref - The reference string\r\n   * @param fromFile - The markdown file containing the reference (for relative path resolution)\r\n   */\r\n  resolve(ref: string, fromFile?: MarkdownFile): MediaItem | undefined {\r\n    return resolveMediaReference(ref, this.doc.media, fromFile?.path);\r\n  }\r\n\r\n  /**\r\n   * Get a media item by ID.\r\n   */\r\n  getById(id: string): MediaItem | undefined {\r\n    return this.doc.media.items.find(item => item.id === id);\r\n  }\r\n\r\n  /**\r\n   * Get a media item by path.\r\n   */\r\n  getByPath(path: string): MediaItem | undefined {\r\n    const normalized = normalizePath(path);\r\n    return this.doc.media.items.find(item => \r\n      item.path && normalizePath(item.path) === normalized\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get all media items referenced by a markdown file.\r\n   */\r\n  getReferencedMedia(file: MarkdownFile): MediaItem[] {\r\n    if (!file.mediaRefs) return [];\r\n    \r\n    const items: MediaItem[] = [];\r\n    for (const ref of file.mediaRefs) {\r\n      const item = this.getById(ref);\r\n      if (item) items.push(item);\r\n    }\r\n    return items;\r\n  }\r\n\r\n  /**\r\n   * Get all media items in the document.\r\n   */\r\n  getAllMedia(): MediaItem[] {\r\n    return [...this.doc.media.items];\r\n  }\r\n\r\n  /**\r\n   * Check if a media ID exists.\r\n   */\r\n  hasId(id: string): boolean {\r\n    return this.doc.media.items.some(item => item.id === id);\r\n  }\r\n\r\n  /**\r\n   * Get the MIME type of a media item.\r\n   */\r\n  getMimeType(item: MediaItem): string {\r\n    return item.mimeType ?? 'application/octet-stream';\r\n  }\r\n}\r\n\r\n/**\r\n * Extract all media references from markdown content.\r\n * Finds both mdocx:// URIs and potential relative paths in markdown syntax.\r\n * \r\n * @param content - The markdown content\r\n * @returns Array of unique reference strings found\r\n */\r\nexport function extractMediaReferences(content: string | Uint8Array): string[] {\r\n  const text = typeof content === 'string' \r\n    ? content \r\n    : new TextDecoder().decode(content);\r\n  \r\n  const refs = new Set<string>();\r\n  \r\n  // Match markdown image/link syntax: ![alt](ref) or [text](ref)\r\n  const markdownLinkRegex = /!?\\[([^\\]]*)\\]\\(([^)]+)\\)/g;\r\n  let match: RegExpExecArray | null;\r\n  \r\n  while ((match = markdownLinkRegex.exec(text)) !== null) {\r\n    const ref = match[2];\r\n    if (ref) {\r\n      // Remove any title portion: \"path/to/image.png \"title\"\"\r\n      const cleanRef = ref.split(/\\s+/)[0];\r\n      if (cleanRef) {\r\n        const parsed = parseMediaReference(cleanRef);\r\n        if (parsed) refs.add(cleanRef);\r\n      }\r\n    }\r\n  }\r\n  \r\n  // Also match HTML img tags: <img src=\"...\">\r\n  const htmlImgRegex = /<img[^>]+src=[\"']([^\"']+)[\"']/gi;\r\n  while ((match = htmlImgRegex.exec(text)) !== null) {\r\n    const ref = match[1];\r\n    if (ref) {\r\n      const parsed = parseMediaReference(ref);\r\n      if (parsed) refs.add(ref);\r\n    }\r\n  }\r\n  \r\n  return [...refs];\r\n}\r\n\r\n/**\r\n * Validate media references in a markdown file against available media.\r\n * \r\n * @returns Array of unresolved references\r\n */\r\nexport function findUnresolvedReferences(\r\n  file: MarkdownFile,\r\n  media: MediaBundle\r\n): string[] {\r\n  const refs = extractMediaReferences(file.content);\r\n  const unresolved: string[] = [];\r\n  \r\n  for (const ref of refs) {\r\n    if (!resolveMediaReference(ref, media, file.path)) {\r\n      unresolved.push(ref);\r\n    }\r\n  }\r\n  \r\n  return unresolved;\r\n}\r\n", "/**\r\n * Builder utilities for creating MDOCX documents.\r\n * \r\n * Provides a fluent API for constructing MarkdownBundle, MediaBundle,\r\n * and complete MDOCX documents.\r\n */\r\n\r\nimport { createHash } from 'node:crypto';\r\nimport type {\r\n  MarkdownBundle,\r\n  MarkdownFile,\r\n  MediaBundle,\r\n  MediaItem,\r\n  MdocxDocument,\r\n  MdocxHeader,\r\n  MdocxMetadata,\r\n  MdocxCompression\r\n} from './types.js';\r\nimport { MDOCX_MAGIC, FIXED_HEADER_SIZE_V1 } from './constants.js';\r\n\r\n/**\r\n * Encode a string to UTF-8 bytes.\r\n */\r\nfunction toBytes(content: string | Uint8Array): Uint8Array {\r\n  return typeof content === 'string' \r\n    ? new TextEncoder().encode(content) \r\n    : content;\r\n}\r\n\r\n/**\r\n * Compute SHA256 hash of data.\r\n */\r\nfunction sha256(data: Uint8Array): Uint8Array {\r\n  return createHash('sha256').update(data).digest();\r\n}\r\n\r\n/**\r\n * Guess MIME type from file extension.\r\n */\r\nfunction guessMimeType(path: string): string {\r\n  const ext = path.split('.').pop()?.toLowerCase();\r\n  const mimeTypes: Record<string, string> = {\r\n    'png': 'image/png',\r\n    'jpg': 'image/jpeg',\r\n    'jpeg': 'image/jpeg',\r\n    'gif': 'image/gif',\r\n    'webp': 'image/webp',\r\n    'svg': 'image/svg+xml',\r\n    'ico': 'image/x-icon',\r\n    'bmp': 'image/bmp',\r\n    'mp3': 'audio/mpeg',\r\n    'wav': 'audio/wav',\r\n    'ogg': 'audio/ogg',\r\n    'mp4': 'video/mp4',\r\n    'webm': 'video/webm',\r\n    'pdf': 'application/pdf',\r\n    'json': 'application/json',\r\n    'xml': 'application/xml',\r\n    'zip': 'application/zip',\r\n    'txt': 'text/plain',\r\n    'css': 'text/css',\r\n    'js': 'application/javascript',\r\n    'html': 'text/html',\r\n    'md': 'text/markdown',\r\n    'markdown': 'text/markdown'\r\n  };\r\n  return ext ? (mimeTypes[ext] ?? 'application/octet-stream') : 'application/octet-stream';\r\n}\r\n\r\n/**\r\n * Generate a safe ID from a path.\r\n */\r\nfunction pathToId(path: string): string {\r\n  return path\r\n    .replace(/[^a-zA-Z0-9_-]/g, '_')\r\n    .replace(/_+/g, '_')\r\n    .replace(/^_|_$/g, '');\r\n}\r\n\r\n/**\r\n * Options for adding a markdown file.\r\n */\r\nexport type AddMarkdownOptions = {\r\n  /** Referenced media IDs */\r\n  mediaRefs?: string[];\r\n  /** Custom attributes */\r\n  attributes?: Record<string, string>;\r\n};\r\n\r\n/**\r\n * Options for adding a media item.\r\n */\r\nexport type AddMediaOptions = {\r\n  /** Explicit MIME type (auto-detected from path if not provided) */\r\n  mimeType?: string;\r\n  /** Container path (defaults to ID if not provided) */\r\n  path?: string;\r\n  /** Custom attributes */\r\n  attributes?: Record<string, string>;\r\n  /** Auto-compute SHA256 hash (default: true) */\r\n  computeSha256?: boolean;\r\n};\r\n\r\n/**\r\n * Builder for creating MarkdownBundle.\r\n */\r\nexport class MarkdownBundleBuilder {\r\n  private files: MarkdownFile[] = [];\r\n  private rootPath?: string;\r\n\r\n  /**\r\n   * Set the root markdown file path.\r\n   */\r\n  root(path: string): this {\r\n    this.rootPath = path;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add a markdown file.\r\n   * \r\n   * @param path - Container path (e.g., 'docs/readme.md')\r\n   * @param content - Markdown content as string or bytes\r\n   * @param opts - Additional options\r\n   */\r\n  addFile(path: string, content: string | Uint8Array, opts: AddMarkdownOptions = {}): this {\r\n    this.files.push({\r\n      path,\r\n      content: toBytes(content),\r\n      ...(opts.mediaRefs?.length ? { mediaRefs: opts.mediaRefs } : {}),\r\n      ...(opts.attributes && Object.keys(opts.attributes).length ? { attributes: opts.attributes } : {})\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add multiple markdown files.\r\n   */\r\n  addFiles(files: Array<{ path: string; content: string | Uint8Array } & AddMarkdownOptions>): this {\r\n    for (const file of files) {\r\n      this.addFile(file.path, file.content, file);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Build the MarkdownBundle.\r\n   */\r\n  build(): MarkdownBundle {\r\n    if (this.files.length === 0) {\r\n      throw new Error('MarkdownBundle must contain at least one file');\r\n    }\r\n    \r\n    return {\r\n      bundleVersion: 1,\r\n      ...(this.rootPath ? { rootPath: this.rootPath } : {}),\r\n      files: this.files\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Builder for creating MediaBundle.\r\n */\r\nexport class MediaBundleBuilder {\r\n  private items: MediaItem[] = [];\r\n  private usedIds = new Set<string>();\r\n\r\n  /**\r\n   * Add a media item.\r\n   * \r\n   * @param id - Unique identifier for the media\r\n   * @param data - Media data as bytes\r\n   * @param opts - Additional options\r\n   */\r\n  addItem(id: string, data: Uint8Array, opts: AddMediaOptions = {}): this {\r\n    if (this.usedIds.has(id)) {\r\n      throw new Error(`Duplicate media ID: ${id}`);\r\n    }\r\n    this.usedIds.add(id);\r\n\r\n    const item: MediaItem = {\r\n      id,\r\n      data,\r\n      ...(opts.path ? { path: opts.path } : {}),\r\n      mimeType: opts.mimeType ?? (opts.path ? guessMimeType(opts.path) : 'application/octet-stream'),\r\n      ...(opts.computeSha256 !== false ? { sha256: sha256(data) } : {}),\r\n      ...(opts.attributes && Object.keys(opts.attributes).length ? { attributes: opts.attributes } : {})\r\n    };\r\n    \r\n    this.items.push(item);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add a media item with auto-generated ID from path.\r\n   */\r\n  addFromPath(path: string, data: Uint8Array, opts: Omit<AddMediaOptions, 'path'> = {}): this {\r\n    const id = pathToId(path);\r\n    return this.addItem(id, data, { ...opts, path });\r\n  }\r\n\r\n  /**\r\n   * Add multiple media items.\r\n   */\r\n  addItems(items: Array<{ id: string; data: Uint8Array } & AddMediaOptions>): this {\r\n    for (const item of items) {\r\n      this.addItem(item.id, item.data, item);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Build the MediaBundle.\r\n   */\r\n  build(): MediaBundle {\r\n    return {\r\n      bundleVersion: 1,\r\n      items: this.items\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create an empty MediaBundle.\r\n   */\r\n  static empty(): MediaBundle {\r\n    return { bundleVersion: 1, items: [] };\r\n  }\r\n}\r\n\r\n/**\r\n * Builder for creating complete MDOCX documents.\r\n */\r\nexport class MdocxBuilder {\r\n  private markdownBuilder = new MarkdownBundleBuilder();\r\n  private mediaBuilder = new MediaBundleBuilder();\r\n  private metadata?: MdocxMetadata;\r\n\r\n  /**\r\n   * Set document metadata.\r\n   */\r\n  setMetadata(metadata: MdocxMetadata): this {\r\n    this.metadata = metadata;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add or update metadata fields.\r\n   */\r\n  addMetadata(fields: Record<string, unknown>): this {\r\n    this.metadata = { ...(this.metadata ?? {}), ...fields };\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Set the document title in metadata.\r\n   */\r\n  title(title: string): this {\r\n    return this.addMetadata({ title });\r\n  }\r\n\r\n  /**\r\n   * Set the document description in metadata.\r\n   */\r\n  description(description: string): this {\r\n    return this.addMetadata({ description });\r\n  }\r\n\r\n  /**\r\n   * Set the root markdown file.\r\n   */\r\n  root(path: string): this {\r\n    this.markdownBuilder.root(path);\r\n    this.addMetadata({ root: path });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add a markdown file.\r\n   */\r\n  addMarkdown(path: string, content: string | Uint8Array, opts: AddMarkdownOptions = {}): this {\r\n    this.markdownBuilder.addFile(path, content, opts);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add a media item.\r\n   */\r\n  addMedia(id: string, data: Uint8Array, opts: AddMediaOptions = {}): this {\r\n    this.mediaBuilder.addItem(id, data, opts);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add a media item with auto-generated ID from path.\r\n   */\r\n  addMediaFromPath(path: string, data: Uint8Array, opts: Omit<AddMediaOptions, 'path'> = {}): this {\r\n    this.mediaBuilder.addFromPath(path, data, opts);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Access the markdown builder for advanced operations.\r\n   */\r\n  markdown(): MarkdownBundleBuilder {\r\n    return this.markdownBuilder;\r\n  }\r\n\r\n  /**\r\n   * Access the media builder for advanced operations.\r\n   */\r\n  media(): MediaBundleBuilder {\r\n    return this.mediaBuilder;\r\n  }\r\n\r\n  /**\r\n   * Build the MdocxDocument.\r\n   */\r\n  build(): MdocxDocument {\r\n    const header: MdocxHeader = {\r\n      magic: MDOCX_MAGIC,\r\n      version: 1,\r\n      headerFlags: this.metadata ? 0x0001 : 0,\r\n      fixedHeaderSize: FIXED_HEADER_SIZE_V1,\r\n      metadataLength: 0, // Will be set during write\r\n      reserved0: 0,\r\n      reserved1: 0n\r\n    };\r\n\r\n    const doc: MdocxDocument = {\r\n      header,\r\n      markdown: this.markdownBuilder.build(),\r\n      media: this.mediaBuilder.build()\r\n    };\r\n\r\n    if (this.metadata) {\r\n      doc.metadata = this.metadata;\r\n    }\r\n\r\n    return doc;\r\n  }\r\n}\r\n\r\n/**\r\n * Create a simple MDOCX document with a single markdown file.\r\n * \r\n * @param path - Path for the markdown file\r\n * @param content - Markdown content\r\n * @param metadata - Optional metadata\r\n */\r\nexport function createSimpleDocument(\r\n  path: string,\r\n  content: string | Uint8Array,\r\n  metadata?: MdocxMetadata\r\n): MdocxDocument {\r\n  const builder = new MdocxBuilder()\r\n    .addMarkdown(path, content)\r\n    .root(path);\r\n  \r\n  if (metadata) {\r\n    builder.setMetadata(metadata);\r\n  }\r\n  \r\n  return builder.build();\r\n}\r\n\r\n/**\r\n * Create a new MdocxBuilder.\r\n */\r\nexport function createBuilder(): MdocxBuilder {\r\n  return new MdocxBuilder();\r\n}\r\n", "import * as vscode from 'vscode';\r\nimport { MdocxPreviewEditorProvider } from './mdocxPreviewEditorProvider.js';\r\nimport { MdocxFileSystemProvider } from './mdocxFileSystemProvider.js';\r\nimport { MdocxCompletionProvider } from './mdocxCompletionProvider.js';\r\n\r\nexport function activate(context: vscode.ExtensionContext) {\r\n  context.subscriptions.push(MdocxFileSystemProvider.register(context));\r\n  context.subscriptions.push(MdocxPreviewEditorProvider.register(context));\r\n  context.subscriptions.push(MdocxCompletionProvider.register(context));\r\n\r\n  // Register command to create new MDOCX file\r\n  context.subscriptions.push(\r\n    vscode.commands.registerCommand('mdocx.createNew', async (uri?: vscode.Uri) => {\r\n      await createNewMdocxFile(uri);\r\n    })\r\n  );\r\n}\r\n\r\nasync function createNewMdocxFile(contextUri?: vscode.Uri): Promise<void> {\r\n  // Determine default folder\r\n  let defaultFolder: vscode.Uri | undefined;\r\n  if (contextUri) {\r\n    const stat = await vscode.workspace.fs.stat(contextUri);\r\n    if (stat.type === vscode.FileType.Directory) {\r\n      defaultFolder = contextUri;\r\n    } else {\r\n      defaultFolder = vscode.Uri.joinPath(contextUri, '..');\r\n    }\r\n  } else if (vscode.workspace.workspaceFolders?.[0]) {\r\n    defaultFolder = vscode.workspace.workspaceFolders[0].uri;\r\n  }\r\n\r\n  // Prompt for file name\r\n  const fileName = await vscode.window.showInputBox({\r\n    prompt: 'Enter the name for the new MDOCX file',\r\n    value: 'document.mdocx',\r\n    validateInput: (value) => {\r\n      if (!value || value.trim().length === 0) {\r\n        return 'File name cannot be empty';\r\n      }\r\n      if (!value.endsWith('.mdocx')) {\r\n        return 'File name must end with .mdocx';\r\n      }\r\n      return undefined;\r\n    }\r\n  });\r\n\r\n  if (!fileName) {\r\n    return; // User cancelled\r\n  }\r\n\r\n  // Prompt for save location\r\n  const saveUri = await vscode.window.showSaveDialog({\r\n    defaultUri: defaultFolder ? vscode.Uri.joinPath(defaultFolder, fileName) : undefined,\r\n    filters: {\r\n      'MDOCX Files': ['mdocx']\r\n    },\r\n    saveLabel: 'Create MDOCX'\r\n  });\r\n\r\n  if (!saveUri) {\r\n    return; // User cancelled\r\n  }\r\n\r\n  try {\r\n    const { writeMdocxAsync } = await import('ts-mdocx');\r\n\r\n    // Create default markdown content\r\n    const defaultMarkdown = `# New Document\r\n\r\nWelcome to your new MDOCX document!\r\n\r\n## Getting Started\r\n\r\nStart editing this file or add more markdown files to build your document.\r\n`;\r\n\r\n    const encoder = new TextEncoder();\r\n    const markdownBundle = {\r\n      bundleVersion: 1,\r\n      files: [\r\n        {\r\n          path: 'README.md',\r\n          content: encoder.encode(defaultMarkdown)\r\n        }\r\n      ],\r\n      rootPath: 'README.md'\r\n    };\r\n\r\n    const mediaBundle = {\r\n      bundleVersion: 1,\r\n      items: []\r\n    };\r\n\r\n    const metadata = {\r\n      title: fileName.replace('.mdocx', ''),\r\n      created: new Date().toISOString()\r\n    };\r\n\r\n    const bytes = await writeMdocxAsync(markdownBundle, mediaBundle, {\r\n      metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(saveUri, bytes);\r\n\r\n    // Open the newly created file\r\n    await vscode.commands.executeCommand('vscode.openWith', saveUri, 'mdocx.preview');\r\n\r\n    void vscode.window.showInformationMessage(`Created MDOCX file: ${saveUri.fsPath}`);\r\n  } catch (error) {\r\n    const message = error instanceof Error ? error.message : String(error);\r\n    void vscode.window.showErrorMessage(`Failed to create MDOCX file: ${message}`);\r\n  }\r\n}\r\n\r\nexport function deactivate() {}\r\n", "import * as vscode from 'vscode';\r\nimport { Buffer } from 'buffer';\r\nimport * as path from 'path';\r\nimport { TextDecoder } from 'util';\r\nimport { marked } from 'marked';\r\nimport { MdocxFileSystemProvider } from './mdocxFileSystemProvider.js';\r\n\r\ntype RenderRequestMessage =\r\n  | { type: 'ready'; selectedPath?: string }\r\n  | { type: 'select'; path: string }\r\n  | { type: 'copy'; path?: string }\r\n  | { type: 'edit'; path?: string }\r\n  | { type: 'editExternal'; path?: string }\r\n  | { type: 'saveContent'; path: string; content: string }\r\n  | { type: 'saveMetadata'; metadata: MetadataFields }\r\n  | { type: 'addMedia' }\r\n  | { type: 'removeMedia'; id: string }\r\n  | { type: 'replaceMedia'; id: string }\r\n  | { type: 'addMarkdown' }\r\n  | { type: 'renameMarkdown'; oldPath: string; newPath: string }\r\n  | { type: 'deleteMarkdown'; path: string }\r\n  | { type: 'getMarkdownContent'; path: string };\r\n\r\ntype MetadataFields = {\r\n  title?: string;\r\n  description?: string;\r\n  author?: string;\r\n  root?: string;\r\n  tags?: string[];\r\n};\r\n\r\ntype MediaItemInfo = {\r\n  id: string;\r\n  path?: string;\r\n  mimeType?: string;\r\n  size: number;\r\n  dataUri?: string;\r\n};\r\n\r\ntype RenderResponseMessage = {\r\n  type: 'render';\r\n  path: string;\r\n  title?: string;\r\n  description?: string;\r\n  html: string;\r\n  markdown?: string;\r\n  error?: string;\r\n  fileList: string[];\r\n  metadata?: MetadataFields;\r\n  mediaItems?: MediaItemInfo[];\r\n};\r\n\r\nconst viewType = 'mdocx.preview';\r\n\r\nexport class MdocxPreviewEditorProvider implements vscode.CustomReadonlyEditorProvider {\r\n  public static register(context: vscode.ExtensionContext): vscode.Disposable {\r\n    const provider = new MdocxPreviewEditorProvider(context);\r\n    return vscode.window.registerCustomEditorProvider(viewType, provider, {\r\n      webviewOptions: {\r\n        retainContextWhenHidden: true\r\n      }\r\n    });\r\n  }\r\n\r\n  constructor(private readonly _context: vscode.ExtensionContext) {}\r\n\r\n  async openCustomDocument(\r\n    uri: vscode.Uri,\r\n    _openContext: vscode.CustomDocumentOpenContext,\r\n    _token: vscode.CancellationToken\r\n  ): Promise<vscode.CustomDocument> {\r\n    return {\r\n      uri,\r\n      dispose: () => {\r\n        // No-op: readonly documents do not need explicit cleanup here.\r\n      }\r\n    };\r\n  }\r\n\r\n  async resolveCustomEditor(\r\n    document: vscode.CustomDocument,\r\n    webviewPanel: vscode.WebviewPanel,\r\n    _token: vscode.CancellationToken\r\n  ): Promise<void> {\r\n    webviewPanel.webview.options = {\r\n      enableScripts: true\r\n    };\r\n\r\n    let selectedPath: string | undefined;\r\n    let hasReceivedReady = false;\r\n\r\n    const postRender = async (path?: string) => {\r\n      const response = await this.renderDocument(document.uri, path ?? selectedPath);\r\n      selectedPath = response.path || path || selectedPath;\r\n      await webviewPanel.webview.postMessage(response);\r\n    };\r\n\r\n    // Set up message handler BEFORE setting HTML to avoid race condition\r\n    const messageDisposable = webviewPanel.webview.onDidReceiveMessage(async (message: RenderRequestMessage) => {\r\n      if (!message || typeof (message as any).type !== 'string') return;\r\n\r\n      if (message.type === 'ready') {\r\n        hasReceivedReady = true;\r\n        if (typeof message.selectedPath === 'string' && message.selectedPath.length > 0) {\r\n          selectedPath = message.selectedPath;\r\n        }\r\n        await postRender(selectedPath);\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'select' && typeof message.path === 'string') {\r\n        selectedPath = message.path;\r\n        await postRender(selectedPath);\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'copy') {\r\n        const pathToCopy = typeof message.path === 'string' && message.path.length > 0 ? message.path : selectedPath;\r\n        const text = await this.getMarkdownText(document.uri, pathToCopy);\r\n        if (!text) {\r\n          void vscode.window.showWarningMessage('MDOCX: No markdown content to copy.');\r\n          return;\r\n        }\r\n        await vscode.env.clipboard.writeText(text);\r\n        void vscode.window.showInformationMessage('MDOCX: Markdown copied to clipboard.');\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'edit') {\r\n        // Edit mode is now handled in the webview - this is kept for backwards compatibility\r\n        // The webview will request markdown content via getMarkdownContent\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'editExternal') {\r\n        const pathToEdit = typeof message.path === 'string' && message.path.length > 0 ? message.path : selectedPath;\r\n        if (!pathToEdit) {\r\n          void vscode.window.showWarningMessage('MDOCX: No markdown file selected to edit.');\r\n          return;\r\n        }\r\n        const editUri = MdocxFileSystemProvider.buildUri(document.uri, pathToEdit);\r\n        await vscode.window.showTextDocument(editUri, { preview: false });\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'getMarkdownContent') {\r\n        const pathToGet = message.path;\r\n        if (!pathToGet) {\r\n          return;\r\n        }\r\n        const text = await this.getMarkdownText(document.uri, pathToGet);\r\n        await webviewPanel.webview.postMessage({\r\n          type: 'markdownContent',\r\n          path: pathToGet,\r\n          content: text || ''\r\n        });\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'saveContent') {\r\n        const pathToSave = message.path;\r\n        const content = message.content;\r\n        if (!pathToSave) {\r\n          void vscode.window.showWarningMessage('MDOCX: No file path specified.');\r\n          return;\r\n        }\r\n        await this.saveMarkdownContent(document.uri, pathToSave, content);\r\n        void vscode.window.showInformationMessage('MDOCX: File saved.');\r\n        await postRender(selectedPath);\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'saveMetadata') {\r\n        await this.saveMetadata(document.uri, message.metadata);\r\n        void vscode.window.showInformationMessage('MDOCX: Metadata saved.');\r\n        await postRender(selectedPath);\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'addMedia') {\r\n        const files = await vscode.window.showOpenDialog({\r\n          canSelectMany: true,\r\n          openLabel: 'Add Media',\r\n          filters: {\r\n            'Images': ['png', 'jpg', 'jpeg', 'gif', 'webp', 'svg'],\r\n            'All Files': ['*']\r\n          }\r\n        });\r\n        if (files && files.length > 0) {\r\n          await this.addMediaFiles(document.uri, files);\r\n          void vscode.window.showInformationMessage(`MDOCX: Added ${files.length} media file(s).`);\r\n          await postRender(selectedPath);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'removeMedia') {\r\n        const confirm = await vscode.window.showWarningMessage(\r\n          `Remove media \"${message.id}\" from MDOCX?`,\r\n          { modal: true },\r\n          'Remove'\r\n        );\r\n        if (confirm === 'Remove') {\r\n          await this.removeMedia(document.uri, message.id);\r\n          void vscode.window.showInformationMessage('MDOCX: Media removed.');\r\n          await postRender(selectedPath);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'replaceMedia') {\r\n        const files = await vscode.window.showOpenDialog({\r\n          canSelectMany: false,\r\n          openLabel: 'Replace Media',\r\n          filters: {\r\n            'Images': ['png', 'jpg', 'jpeg', 'gif', 'webp', 'svg'],\r\n            'All Files': ['*']\r\n          }\r\n        });\r\n        if (files && files.length > 0) {\r\n          await this.replaceMedia(document.uri, message.id, files[0]);\r\n          void vscode.window.showInformationMessage('MDOCX: Media replaced.');\r\n          await postRender(selectedPath);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'addMarkdown') {\r\n        const fileName = await vscode.window.showInputBox({\r\n          prompt: 'Enter the path for the new markdown file',\r\n          value: 'new-file.md',\r\n          validateInput: (value) => {\r\n            if (!value || value.trim().length === 0) {\r\n              return 'File name cannot be empty';\r\n            }\r\n            if (!value.endsWith('.md') && !value.endsWith('.markdown')) {\r\n              return 'File must have .md or .markdown extension';\r\n            }\r\n            return undefined;\r\n          }\r\n        });\r\n        if (fileName) {\r\n          await this.addMarkdownFile(document.uri, fileName);\r\n          void vscode.window.showInformationMessage(`MDOCX: Added ${fileName}`);\r\n          selectedPath = fileName;\r\n          await postRender(selectedPath);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'renameMarkdown') {\r\n        await this.renameMarkdownFile(document.uri, message.oldPath, message.newPath);\r\n        void vscode.window.showInformationMessage(`MDOCX: Renamed to ${message.newPath}`);\r\n        if (selectedPath === message.oldPath) {\r\n          selectedPath = message.newPath;\r\n        }\r\n        await postRender(selectedPath);\r\n        return;\r\n      }\r\n\r\n      if (message.type === 'deleteMarkdown') {\r\n        const confirm = await vscode.window.showWarningMessage(\r\n          `Delete \"${message.path}\" from MDOCX? This cannot be undone.`,\r\n          { modal: true },\r\n          'Delete'\r\n        );\r\n        if (confirm === 'Delete') {\r\n          await this.deleteMarkdownFile(document.uri, message.path);\r\n          void vscode.window.showInformationMessage('MDOCX: File deleted.');\r\n          if (selectedPath === message.path) {\r\n            selectedPath = undefined;\r\n          }\r\n          await postRender(selectedPath);\r\n        }\r\n        return;\r\n      }\r\n    });\r\n\r\n    const pattern = new vscode.RelativePattern(path.dirname(document.uri.fsPath), path.basename(document.uri.fsPath));\r\n    const watcher = vscode.workspace.createFileSystemWatcher(pattern);\r\n\r\n    const onDiskChange = async () => {\r\n      await postRender(selectedPath);\r\n    };\r\n\r\n    const watcherDisposables = [\r\n      watcher,\r\n      watcher.onDidChange(onDiskChange),\r\n      watcher.onDidCreate(onDiskChange),\r\n      watcher.onDidDelete(async () => {\r\n        await webviewPanel.webview.postMessage({\r\n          type: 'render',\r\n          path: '',\r\n          title: 'MDOCX',\r\n          description: undefined,\r\n          html: '',\r\n          fileList: [],\r\n          error: 'The file was deleted from disk.'\r\n        } satisfies RenderResponseMessage);\r\n      })\r\n    ];\r\n\r\n    // Now set the HTML after message handler is ready\r\n    webviewPanel.webview.html = this.getWebviewHtml(webviewPanel.webview);\r\n\r\n    // Fallback: if we don't receive 'ready' within 500ms, render anyway\r\n    // This handles cases where the message was lost due to timing\r\n    setTimeout(async () => {\r\n      if (!hasReceivedReady) {\r\n        await postRender(selectedPath);\r\n      }\r\n    }, 500);\r\n\r\n    webviewPanel.onDidDispose(() => {\r\n      messageDisposable.dispose();\r\n      watcherDisposables.forEach(d => d.dispose());\r\n    });\r\n  }\r\n\r\n  private async renderDocument(resource: vscode.Uri, selectedPath?: string): Promise<RenderResponseMessage> {\r\n    try {\r\n      const bytes = await vscode.workspace.fs.readFile(resource);\r\n      const { readMdocx, MediaResolver } = await import('ts-mdocx');\r\n      const doc = await readMdocx(bytes);\r\n\r\n      // Ensure expected structures exist to avoid runtime errors for malformed docs\r\n      doc.markdown = doc.markdown || { files: [] };\r\n      if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n      doc.media = doc.media || { items: [] };\r\n      if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n      const fileList = doc.markdown.files.map((file: { path: string }) => file.path).sort((a: string, b: string) => a.localeCompare(b));\r\n\r\n      const rootPath =\r\n        selectedPath ??\r\n        doc.markdown.rootPath ??\r\n        (typeof doc.metadata?.root === 'string' ? doc.metadata.root : undefined) ??\r\n        doc.markdown.files[0]?.path;\r\n\r\n      const rootFile = doc.markdown.files.find((file: { path: string }) => file.path === rootPath) ?? doc.markdown.files[0];\r\n      if (!rootFile) {\r\n        return {\r\n          type: 'render',\r\n          path: selectedPath ?? '',\r\n          html: '',\r\n          fileList,\r\n          error: 'No markdown files found in this MDOCX.'\r\n        };\r\n      }\r\n\r\n      const decoder = new TextDecoder('utf-8');\r\n      const markdownText = decoder.decode(rootFile.content);\r\n\r\n      const resolver = new MediaResolver(doc);\r\n\r\n      const html = this.renderMarkdownToHtml(markdownText, {\r\n        resolveMediaHref: (href) => this.tryResolveMediaHrefToDataUri(resolver, href, rootFile)\r\n      });\r\n\r\n      const title = typeof (doc.metadata as any)?.title === 'string' ? (doc.metadata as any).title : undefined;\r\n      const description =\r\n        typeof (doc.metadata as any)?.description === 'string' ? (doc.metadata as any).description : undefined;\r\n\r\n      // Extract metadata fields\r\n      const metadata: MetadataFields = {\r\n        title,\r\n        description,\r\n        author: typeof (doc.metadata as any)?.creator === 'string' ? (doc.metadata as any).creator : undefined,\r\n        root: doc.markdown.rootPath ?? (doc.metadata as any)?.root,\r\n        tags: Array.isArray((doc.metadata as any)?.tags) ? (doc.metadata as any).tags : undefined\r\n      };\r\n\r\n      // Extract media items info with thumbnails for images\r\n      const mediaItems: MediaItemInfo[] = (doc.media.items || []).map((item: any) => {\r\n        const info: MediaItemInfo = {\r\n          id: item.id,\r\n          path: item.path,\r\n          mimeType: item.mimeType,\r\n          size: item.data?.byteLength ?? 0\r\n        };\r\n        // Generate small thumbnail for images\r\n        if (item.mimeType?.startsWith('image/') && item.data && item.data.byteLength < 500 * 1024) {\r\n          info.dataUri = `data:${item.mimeType};base64,${Buffer.from(item.data).toString('base64')}`;\r\n        }\r\n        return info;\r\n      });\r\n\r\n      return {\r\n        type: 'render',\r\n        path: rootFile.path,\r\n        title,\r\n        description,\r\n        html,\r\n        markdown: markdownText,\r\n        fileList,\r\n        metadata,\r\n        mediaItems\r\n      };\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : String(error);\r\n      return {\r\n        type: 'render',\r\n        path: selectedPath ?? '',\r\n        html: '',\r\n        fileList: [],\r\n        error: `Failed to read MDOCX: ${message}`\r\n      };\r\n    }\r\n  }\r\n\r\n  private async getMarkdownText(resource: vscode.Uri, selectedPath?: string): Promise<string | undefined> {\r\n    try {\r\n      const bytes = await vscode.workspace.fs.readFile(resource);\r\n      const { readMdocx } = await import('ts-mdocx');\r\n      const doc = await readMdocx(bytes);\r\n\r\n      // Defensive normalization\r\n      doc.markdown = doc.markdown || { files: [] };\r\n      if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n      const rootPath =\r\n        selectedPath ??\r\n        doc.markdown.rootPath ??\r\n        (typeof doc.metadata?.root === 'string' ? doc.metadata.root : undefined) ??\r\n        doc.markdown.files[0]?.path;\r\n\r\n      const rootFile = doc.markdown.files.find((file: { path: string }) => file.path === rootPath) ?? doc.markdown.files[0];\r\n      if (!rootFile) return undefined;\r\n\r\n      const decoder = new TextDecoder('utf-8');\r\n      return decoder.decode(rootFile.content);\r\n    } catch {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  private async saveMarkdownContent(resource: vscode.Uri, filePath: string, content: string): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    doc.media = doc.media || { items: [] };\r\n    if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n\r\n    const file = doc.markdown.files.find((f: { path: string }) => f.path === filePath);\r\n    if (!file) {\r\n      throw new Error(`File \"${filePath}\" not found in this MDOCX`);\r\n    }\r\n\r\n    // Update the content\r\n    const encoder = new TextEncoder();\r\n    file.content = encoder.encode(content);\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async saveMetadata(resource: vscode.Uri, metadata: MetadataFields): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    // Update metadata\r\n    const existingMetadata = (doc.metadata || {}) as Record<string, any>;\r\n    if (metadata.title !== undefined) existingMetadata.title = metadata.title;\r\n    if (metadata.description !== undefined) existingMetadata.description = metadata.description;\r\n    if (metadata.author !== undefined) existingMetadata.creator = metadata.author;\r\n    if (metadata.root !== undefined) existingMetadata.root = metadata.root;\r\n    if (metadata.tags !== undefined) existingMetadata.tags = metadata.tags;\r\n\r\n    // Update root path in markdown bundle\r\n    if (metadata.root !== undefined) {\r\n      doc.markdown.rootPath = metadata.root;\r\n    }\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: existingMetadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async addMediaFiles(resource: vscode.Uri, files: vscode.Uri[]): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    doc.media = doc.media || { items: [] };\r\n    if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n    const baseTime = Date.now();\r\n    let index = 0;\r\n    for (const file of files) {\r\n      const data = await vscode.workspace.fs.readFile(file);\r\n      const fileName = path.basename(file.fsPath);\r\n      const ext = path.extname(fileName).toLowerCase();\r\n      const id = fileName.replace(/[^a-zA-Z0-9_-]/g, '_') + '_' + (baseTime + index++);\r\n      const mimeType = this.getMimeTypeFromExtension(ext);\r\n\r\n      doc.media.items.push({\r\n        id,\r\n        path: `media/${fileName}`,\r\n        mimeType,\r\n        data: new Uint8Array(data)\r\n      });\r\n    }\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async addMarkdownFile(resource: vscode.Uri, filePath: string): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    doc.media = doc.media || { items: [] };\r\n    if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n\r\n    // Check if file already exists\r\n    const existing = doc.markdown.files.find((f: { path: string }) => f.path === filePath);\r\n    if (existing) {\r\n      throw new Error(`File \"${filePath}\" already exists in this MDOCX`);\r\n    }\r\n\r\n    // Create default content\r\n    const fileName = path.basename(filePath, path.extname(filePath));\r\n    const defaultContent = `# ${fileName}\\n\\nStart writing here...\\n`;\r\n    const encoder = new TextEncoder();\r\n\r\n    doc.markdown.files.push({\r\n      path: filePath,\r\n      content: encoder.encode(defaultContent)\r\n    });\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async renameMarkdownFile(resource: vscode.Uri, oldPath: string, newPath: string): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    doc.media = doc.media || { items: [] };\r\n    if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n\r\n    const file = doc.markdown.files.find((f: { path: string }) => f.path === oldPath);\r\n    if (!file) {\r\n      throw new Error(`File \"${oldPath}\" not found in this MDOCX`);\r\n    }\r\n\r\n    // Check if new path already exists\r\n    const existing = doc.markdown.files.find((f: { path: string }) => f.path === newPath);\r\n    if (existing) {\r\n      throw new Error(`File \"${newPath}\" already exists in this MDOCX`);\r\n    }\r\n\r\n    file.path = newPath;\r\n\r\n    // Update root path if it was pointing to the old file\r\n    if (doc.markdown.rootPath === oldPath) {\r\n      doc.markdown.rootPath = newPath;\r\n    }\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async deleteMarkdownFile(resource: vscode.Uri, filePath: string): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    doc.media = doc.media || { items: [] };\r\n    if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n\r\n    const index = doc.markdown.files.findIndex((f: { path: string }) => f.path === filePath);\r\n    if (index >= 0) {\r\n      doc.markdown.files.splice(index, 1);\r\n    }\r\n\r\n    // Update root path if it was pointing to deleted file\r\n    if (doc.markdown.rootPath === filePath && doc.markdown.files.length > 0) {\r\n      doc.markdown.rootPath = doc.markdown.files[0].path;\r\n    }\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async removeMedia(resource: vscode.Uri, mediaId: string): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    // Defensive normalization\r\n    doc.markdown = doc.markdown || { files: [] };\r\n    if (!Array.isArray(doc.markdown.files)) doc.markdown.files = [];\r\n    doc.media = doc.media || { items: [] };\r\n    if (!Array.isArray(doc.media.items)) doc.media.items = [];\r\n    const index = doc.media.items.findIndex((item: any) => item.id === mediaId);\r\n    if (index >= 0) {\r\n      doc.media.items.splice(index, 1);\r\n    }\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private async replaceMedia(resource: vscode.Uri, mediaId: string, newFile: vscode.Uri): Promise<void> {\r\n    const bytes = await vscode.workspace.fs.readFile(resource);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    const item = doc.media.items.find((i: any) => i.id === mediaId);\r\n    if (item) {\r\n      const data = await vscode.workspace.fs.readFile(newFile);\r\n      const fileName = path.basename(newFile.fsPath);\r\n      const ext = path.extname(fileName).toLowerCase();\r\n      item.data = new Uint8Array(data);\r\n      item.mimeType = this.getMimeTypeFromExtension(ext);\r\n      item.path = `media/${fileName}`;\r\n    }\r\n\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(resource, newBytes);\r\n  }\r\n\r\n  private getMimeTypeFromExtension(ext: string): string {\r\n    const mimeTypes: Record<string, string> = {\r\n      '.png': 'image/png',\r\n      '.jpg': 'image/jpeg',\r\n      '.jpeg': 'image/jpeg',\r\n      '.gif': 'image/gif',\r\n      '.webp': 'image/webp',\r\n      '.svg': 'image/svg+xml',\r\n      '.mp3': 'audio/mpeg',\r\n      '.wav': 'audio/wav',\r\n      '.mp4': 'video/mp4',\r\n      '.webm': 'video/webm',\r\n      '.pdf': 'application/pdf'\r\n    };\r\n    return mimeTypes[ext] || 'application/octet-stream';\r\n  }\r\n\r\n  private renderMarkdownToHtml(\r\n    markdown: string,\r\n    options?: {\r\n      resolveMediaHref?: (href: string) => string | undefined;\r\n    }\r\n  ): string {\r\n    const sanitizeHref = (href: string | null | undefined): string | null => {\r\n      const raw = (href ?? '').trim();\r\n      if (!raw) return null;\r\n      if (raw.startsWith('#')) return raw;\r\n      if (/^mailto:/i.test(raw)) return raw;\r\n      if (/^data:/i.test(raw)) return raw;\r\n      if (/^https?:\\/\\//i.test(raw)) return raw;\r\n      return null;\r\n    };\r\n\r\n    // Webview safety:\r\n    // - drop raw HTML\r\n    // - strip unsafe URLs (e.g. javascript:)\r\n    const renderer = new marked.Renderer();\r\n    renderer.html = () => '';\r\n    renderer.link = (href: string | null, title: string | null, text: string) => {\r\n      const safe = sanitizeHref(href);\r\n      if (!safe) return text;\r\n      const t = title ? ` title=\"${this.escapeHtmlAttr(title)}\"` : '';\r\n      const external = /^https?:\\/\\//i.test(safe);\r\n      const rel = external ? ' rel=\"noreferrer noopener\" target=\"_blank\"' : '';\r\n      return `<a href=\"${this.escapeHtmlAttr(safe)}\"${t}${rel}>${text}</a>`;\r\n    };\r\n    renderer.image = (href: string | null, title: string | null, text: string) => {\r\n      const safe = sanitizeHref(href);\r\n      if (!safe) return '';\r\n      const t = title ? ` title=\"${this.escapeHtmlAttr(title)}\"` : '';\r\n      const alt = this.escapeHtmlAttr(text ?? '');\r\n      return `<img src=\"${this.escapeHtmlAttr(safe)}\" alt=\"${alt}\"${t} />`;\r\n    };\r\n\r\n    const walkTokens = (token: any) => {\r\n      if (!options?.resolveMediaHref) return;\r\n      if (!token || typeof token.type !== 'string') return;\r\n\r\n      if ((token.type === 'image' || token.type === 'link') && typeof token.href === 'string') {\r\n        const rewritten = options.resolveMediaHref(token.href);\r\n        if (rewritten) {\r\n          token.href = rewritten;\r\n        }\r\n      }\r\n    };\r\n\r\n    const parsed = marked.parse(markdown, { renderer, walkTokens } as any);\r\n    return typeof parsed === 'string' ? parsed : '';\r\n  }\r\n\r\n  private tryResolveMediaHrefToDataUri(resolver: any, href: string, fromFile: { path: string }): string | undefined {\r\n    const rawHref = href.trim().replace(/^<|>$/g, '');\r\n    if (!rawHref) return undefined;\r\n\r\n    // Don't touch external links or existing data URIs.\r\n    // NOTE: `mdocx://media/...` is internal and should be resolved.\r\n    if (/^https?:\\/\\//i.test(rawHref) || /^data:/i.test(rawHref) || /^mailto:/i.test(rawHref) || rawHref.startsWith('#')) {\r\n      return undefined;\r\n    }\r\n\r\n    const withoutFragmentOrQuery = rawHref.split('#')[0]?.split('?')[0] ?? rawHref;\r\n    const normalizedSlashes = withoutFragmentOrQuery.replace(/\\\\/g, '/');\r\n\r\n    const candidates = new Set<string>([\r\n      normalizedSlashes,\r\n      normalizedSlashes.startsWith('./') ? normalizedSlashes.slice(2) : normalizedSlashes,\r\n      normalizedSlashes.startsWith('/') ? normalizedSlashes.slice(1) : normalizedSlashes\r\n    ]);\r\n\r\n    // Best-effort decode (handles spaces like %20)\r\n    try {\r\n      candidates.add(decodeURI(normalizedSlashes));\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    let item: any | undefined;\r\n    for (const candidate of candidates) {\r\n      try {\r\n        item = resolver.resolve(candidate, fromFile);\r\n        if (item) break;\r\n      } catch {\r\n        // ignore and try next candidate\r\n      }\r\n\r\n      // Fall back to explicit getters if available\r\n      try {\r\n        if (!item && typeof resolver.getByPath === 'function') {\r\n          item = resolver.getByPath(candidate);\r\n          if (item) break;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      try {\r\n        const m = /^mdocx:\\/\\/media\\/(.+)$/i.exec(candidate);\r\n        if (!item && m && typeof resolver.getById === 'function') {\r\n          item = resolver.getById(m[1]);\r\n          if (item) break;\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    if (!item || !item.data) return undefined;\r\n\r\n    const maxInlineBytes = this.getMaxInlineMediaBytes();\r\n    if (typeof item.data.byteLength === 'number' && item.data.byteLength > maxInlineBytes) {\r\n      return undefined;\r\n    }\r\n\r\n    const inferred = this.inferMimeType(item);\r\n    const mimeType = typeof item.mimeType === 'string' && item.mimeType.length > 0 ? item.mimeType : inferred;\r\n    const base64 = Buffer.from(item.data).toString('base64');\r\n    return `data:${mimeType};base64,${base64}`;\r\n  }\r\n\r\n  private inferMimeType(item: { mimeType?: string; path?: string; data?: Uint8Array }): string {\r\n    const p = typeof item.path === 'string' ? item.path.toLowerCase() : '';\r\n    if (p.endsWith('.png')) return 'image/png';\r\n    if (p.endsWith('.jpg') || p.endsWith('.jpeg')) return 'image/jpeg';\r\n    if (p.endsWith('.gif')) return 'image/gif';\r\n    if (p.endsWith('.webp')) return 'image/webp';\r\n    if (p.endsWith('.svg')) return 'image/svg+xml';\r\n\r\n    const bytes = item.data;\r\n    if (!bytes || bytes.length < 12) return 'application/octet-stream';\r\n\r\n    // PNG\r\n    if (\r\n      bytes[0] === 0x89 &&\r\n      bytes[1] === 0x50 &&\r\n      bytes[2] === 0x4e &&\r\n      bytes[3] === 0x47 &&\r\n      bytes[4] === 0x0d &&\r\n      bytes[5] === 0x0a &&\r\n      bytes[6] === 0x1a &&\r\n      bytes[7] === 0x0a\r\n    ) {\r\n      return 'image/png';\r\n    }\r\n\r\n    // JPEG\r\n    if (bytes[0] === 0xff && bytes[1] === 0xd8) {\r\n      return 'image/jpeg';\r\n    }\r\n\r\n    // GIF\r\n    if (bytes[0] === 0x47 && bytes[1] === 0x49 && bytes[2] === 0x46) {\r\n      return 'image/gif';\r\n    }\r\n\r\n    // WEBP: RIFF....WEBP\r\n    if (\r\n      bytes[0] === 0x52 &&\r\n      bytes[1] === 0x49 &&\r\n      bytes[2] === 0x46 &&\r\n      bytes[3] === 0x46 &&\r\n      bytes[8] === 0x57 &&\r\n      bytes[9] === 0x45 &&\r\n      bytes[10] === 0x42 &&\r\n      bytes[11] === 0x50\r\n    ) {\r\n      return 'image/webp';\r\n    }\r\n\r\n    // SVG (best-effort)\r\n    try {\r\n      const head = new TextDecoder('utf-8').decode(bytes.slice(0, 256));\r\n      if (head.includes('<svg') || head.includes('<?xml')) {\r\n        return 'image/svg+xml';\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    return 'application/octet-stream';\r\n  }\r\n\r\n  private getMaxInlineMediaBytes(): number {\r\n    const configured = vscode.workspace.getConfiguration('mdocx').get<number>('maxInlineMediaBytes');\r\n    if (typeof configured === 'number' && Number.isFinite(configured) && configured > 0) {\r\n      return configured;\r\n    }\r\n    return 25 * 1024 * 1024;\r\n  }\r\n\r\n  private getWebviewHtml(webview: vscode.Webview): string {\r\n    const nonce = String(Date.now());\r\n\r\n    return `<!doctype html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"utf-8\" />\r\n  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'none'; img-src data: https: http:; style-src 'unsafe-inline'; script-src 'nonce-${nonce}';\" />\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n  <title>MDOCX Preview</title>\r\n  <style>\r\n    :root {\r\n      color-scheme: light dark;\r\n      --border-color: var(--vscode-editorGroup-border);\r\n      --panel-bg: color-mix(in srgb, var(--vscode-editor-background) 92%, black);\r\n      --panel-hover-bg: color-mix(in srgb, var(--vscode-editor-background) 85%, black);\r\n      --danger-bg: var(--vscode-inputValidation-errorBackground, #5a1d1d);\r\n    }\r\n    * { box-sizing: border-box; }\r\n    body {\r\n      margin: 0;\r\n      padding: 0;\r\n      font-family: var(--vscode-font-family);\r\n      color: var(--vscode-foreground);\r\n      background: var(--vscode-editor-background);\r\n    }\r\n    header {\r\n      position: sticky;\r\n      top: 0;\r\n      z-index: 10;\r\n      padding: 12px 16px;\r\n      border-bottom: 1px solid var(--border-color);\r\n      background: var(--vscode-editor-background);\r\n      display: flex;\r\n      gap: 12px;\r\n      align-items: center;\r\n      flex-wrap: wrap;\r\n    }\r\n    header .meta {\r\n      flex: 1;\r\n      min-width: 200px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 2px;\r\n      overflow: hidden;\r\n    }\r\n    header .meta .title {\r\n      font-weight: 600;\r\n      font-size: 14px;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n    header .meta .desc {\r\n      opacity: 0.7;\r\n      font-size: 12px;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n    select, input, textarea {\r\n      padding: 6px 10px;\r\n      border: 1px solid var(--vscode-input-border, var(--border-color));\r\n      background: var(--vscode-input-background);\r\n      color: var(--vscode-input-foreground);\r\n      border-radius: 4px;\r\n      font-family: var(--vscode-font-family);\r\n      font-size: 13px;\r\n    }\r\n    select:focus, input:focus, textarea:focus {\r\n      outline: 1px solid var(--vscode-focusBorder);\r\n      outline-offset: -1px;\r\n    }\r\n    button {\r\n      border: 1px solid var(--vscode-button-border, transparent);\r\n      background: var(--vscode-button-background);\r\n      color: var(--vscode-button-foreground);\r\n      padding: 6px 12px;\r\n      border-radius: 4px;\r\n      cursor: pointer;\r\n      font-family: var(--vscode-font-family);\r\n      font-size: 12px;\r\n      font-weight: 500;\r\n      display: inline-flex;\r\n      align-items: center;\r\n      gap: 6px;\r\n      white-space: nowrap;\r\n      transition: background 0.1s;\r\n    }\r\n    button svg {\r\n      width: 14px;\r\n      height: 14px;\r\n      fill: currentColor;\r\n      opacity: 0.9;\r\n    }\r\n    button:hover {\r\n      background: var(--vscode-button-hoverBackground);\r\n    }\r\n    button:disabled {\r\n      opacity: 0.5;\r\n      cursor: not-allowed;\r\n    }\r\n    button.secondary {\r\n      background: var(--vscode-button-secondaryBackground);\r\n      color: var(--vscode-button-secondaryForeground);\r\n    }\r\n    button.secondary:hover {\r\n      background: var(--vscode-button-secondaryHoverBackground);\r\n    }\r\n    button.active {\r\n      background: var(--vscode-button-hoverBackground);\r\n      box-shadow: inset 0 0 0 1px var(--vscode-focusBorder);\r\n    }\r\n    button.danger {\r\n      background: var(--danger-bg);\r\n    }\r\n    button.small {\r\n      padding: 3px 8px;\r\n      font-size: 11px;\r\n    }\r\n    .layout {\r\n      display: grid;\r\n      grid-template-columns: 280px 1fr;\r\n      min-height: calc(100vh - 60px);\r\n    }\r\n    @media (max-width: 800px) {\r\n      .layout {\r\n        grid-template-columns: 1fr;\r\n      }\r\n      .sidebar {\r\n        border-right: none !important;\r\n        border-bottom: 1px solid var(--border-color);\r\n      }\r\n    }\r\n    .sidebar {\r\n      border-right: 1px solid var(--border-color);\r\n      background: var(--panel-bg);\r\n      overflow-y: auto;\r\n      max-height: calc(100vh - 60px);\r\n    }\r\n    .main-content {\r\n      padding: 20px 24px;\r\n      overflow-y: auto;\r\n      max-height: calc(100vh - 60px);\r\n      display: flex;\r\n      flex-direction: column;\r\n    }\r\n    .main-content img {\r\n      max-width: 100%;\r\n    }\r\n    .main-content pre {\r\n      padding: 12px;\r\n      overflow: auto;\r\n      background: var(--panel-bg);\r\n      border: 1px solid var(--border-color);\r\n      border-radius: 6px;\r\n    }\r\n    .main-content code {\r\n      font-family: var(--vscode-editor-font-family);\r\n    }\r\n    .main-content h1:first-child { margin-top: 0; }\r\n    .error {\r\n      color: var(--vscode-errorForeground);\r\n      padding: 12px 16px;\r\n      border: 1px solid var(--vscode-errorForeground);\r\n      border-radius: 6px;\r\n      margin: 12px 0;\r\n      white-space: pre-wrap;\r\n    }\r\n    \r\n    /* Sidebar sections */\r\n    .sidebar-section {\r\n      border-bottom: 1px solid var(--border-color);\r\n    }\r\n    .sidebar-section:last-child {\r\n      border-bottom: none;\r\n    }\r\n    .section-header {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      padding: 10px 12px;\r\n      cursor: pointer;\r\n      user-select: none;\r\n      font-weight: 600;\r\n      font-size: 11px;\r\n      text-transform: uppercase;\r\n      letter-spacing: 0.5px;\r\n      opacity: 0.8;\r\n    }\r\n    .section-header:hover {\r\n      background: var(--panel-hover-bg);\r\n    }\r\n    .section-header .chevron {\r\n      width: 12px;\r\n      height: 12px;\r\n      fill: currentColor;\r\n      transition: transform 0.15s;\r\n    }\r\n    .section-header.collapsed .chevron {\r\n      transform: rotate(-90deg);\r\n    }\r\n    .section-header.collapsed + .section-body {\r\n      display: none;\r\n    }\r\n    .section-body {\r\n      padding: 8px 12px 12px;\r\n    }\r\n    .section-actions {\r\n      display: flex;\r\n      gap: 6px;\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    /* File list */\r\n    .file-list {\r\n      list-style: none;\r\n      margin: 0;\r\n      padding: 0;\r\n    }\r\n    .file-item {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      padding: 6px 8px;\r\n      border-radius: 4px;\r\n      cursor: pointer;\r\n      font-size: 13px;\r\n    }\r\n    .file-item:hover {\r\n      background: var(--panel-hover-bg);\r\n    }\r\n    .file-item.selected {\r\n      background: var(--vscode-list-activeSelectionBackground);\r\n      color: var(--vscode-list-activeSelectionForeground);\r\n    }\r\n    .file-item .file-icon {\r\n      width: 16px;\r\n      height: 16px;\r\n      fill: currentColor;\r\n      opacity: 0.7;\r\n      flex-shrink: 0;\r\n    }\r\n    .file-item .file-name {\r\n      flex: 1;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n    }\r\n    .file-item .file-actions {\r\n      display: none;\r\n      gap: 4px;\r\n    }\r\n    .file-item:hover .file-actions {\r\n      display: flex;\r\n    }\r\n    .file-item .file-actions button {\r\n      padding: 2px 4px;\r\n      background: transparent;\r\n      border: none;\r\n      opacity: 0.7;\r\n    }\r\n    .file-item .file-actions button:hover {\r\n      opacity: 1;\r\n      background: var(--panel-hover-bg);\r\n    }\r\n    .file-item.root-file .file-name::after {\r\n      content: ' (root)';\r\n      opacity: 0.5;\r\n      font-size: 11px;\r\n    }\r\n\r\n    /* Media grid */\r\n    .media-grid {\r\n      display: grid;\r\n      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\r\n      gap: 8px;\r\n    }\r\n    .media-item {\r\n      border: 1px solid var(--border-color);\r\n      border-radius: 6px;\r\n      padding: 8px;\r\n      text-align: center;\r\n      background: var(--vscode-editor-background);\r\n    }\r\n    .media-item img {\r\n      max-width: 100%;\r\n      max-height: 60px;\r\n      object-fit: contain;\r\n      margin-bottom: 6px;\r\n      border-radius: 2px;\r\n    }\r\n    .media-item .placeholder {\r\n      width: 100%;\r\n      height: 50px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      background: var(--panel-bg);\r\n      border-radius: 4px;\r\n      margin-bottom: 6px;\r\n      font-size: 10px;\r\n      opacity: 0.6;\r\n    }\r\n    .media-item .info {\r\n      font-size: 10px;\r\n      word-break: break-all;\r\n      opacity: 0.8;\r\n    }\r\n    .media-item .actions {\r\n      margin-top: 6px;\r\n      display: flex;\r\n      gap: 4px;\r\n      justify-content: center;\r\n    }\r\n\r\n    /* Form elements */\r\n    .form-row {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 4px;\r\n      margin-bottom: 10px;\r\n    }\r\n    .form-row:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n    .form-row label {\r\n      font-size: 11px;\r\n      opacity: 0.7;\r\n      text-transform: uppercase;\r\n      letter-spacing: 0.3px;\r\n    }\r\n    .form-row textarea {\r\n      min-height: 50px;\r\n      resize: vertical;\r\n    }\r\n    .btn-row {\r\n      display: flex;\r\n      gap: 8px;\r\n      margin-top: 10px;\r\n    }\r\n\r\n    /* Empty state */\r\n    .empty-state {\r\n      text-align: center;\r\n      padding: 20px;\r\n      opacity: 0.6;\r\n      font-size: 12px;\r\n    }\r\n\r\n    /* Badge */\r\n    .badge {\r\n      background: var(--vscode-badge-background);\r\n      color: var(--vscode-badge-foreground);\r\n      font-size: 10px;\r\n      padding: 2px 6px;\r\n      border-radius: 10px;\r\n      margin-left: 6px;\r\n    }\r\n\r\n    /* View toggle */\r\n    .view-toggle {\r\n      display: flex;\r\n      border: 1px solid var(--vscode-button-border, var(--border-color));\r\n      border-radius: 4px;\r\n      overflow: hidden;\r\n    }\r\n    .view-toggle button {\r\n      border: none;\r\n      border-radius: 0;\r\n      background: var(--vscode-button-secondaryBackground);\r\n      color: var(--vscode-button-secondaryForeground);\r\n    }\r\n    .view-toggle button:first-child {\r\n      border-right: 1px solid var(--vscode-button-border, var(--border-color));\r\n    }\r\n    .view-toggle button.active {\r\n      background: var(--vscode-button-background);\r\n      color: var(--vscode-button-foreground);\r\n      box-shadow: none;\r\n    }\r\n    .view-toggle button:hover:not(.active) {\r\n      background: var(--vscode-button-secondaryHoverBackground);\r\n    }\r\n\r\n    /* Editor view */\r\n    #previewView {\r\n      flex: 1;\r\n    }\r\n    #editorView {\r\n      display: none;\r\n      flex: 1;\r\n      flex-direction: column;\r\n      gap: 12px;\r\n    }\r\n    #editorView.active {\r\n      display: flex;\r\n    }\r\n    #previewView.hidden {\r\n      display: none;\r\n    }\r\n    .editor-toolbar {\r\n      display: flex;\r\n      gap: 8px;\r\n      align-items: center;\r\n      padding-bottom: 12px;\r\n      border-bottom: 1px solid var(--border-color);\r\n    }\r\n    .editor-toolbar .file-path {\r\n      flex: 1;\r\n      font-size: 12px;\r\n      opacity: 0.8;\r\n      font-family: var(--vscode-editor-font-family);\r\n    }\r\n    .editor-container {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      min-height: 0;\r\n    }\r\n    #markdownEditor {\r\n      flex: 1;\r\n      width: 100%;\r\n      min-height: 400px;\r\n      padding: 12px;\r\n      border: 1px solid var(--vscode-input-border, var(--border-color));\r\n      background: var(--vscode-input-background);\r\n      color: var(--vscode-input-foreground);\r\n      border-radius: 6px;\r\n      font-family: var(--vscode-editor-font-family);\r\n      font-size: 13px;\r\n      line-height: 1.5;\r\n      resize: none;\r\n      tab-size: 2;\r\n    }\r\n    #markdownEditor:focus {\r\n      outline: 1px solid var(--vscode-focusBorder);\r\n      outline-offset: -1px;\r\n    }\r\n    .editor-status {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      padding-top: 8px;\r\n      font-size: 11px;\r\n      opacity: 0.7;\r\n    }\r\n    .editor-status .modified {\r\n      color: var(--vscode-gitDecoration-modifiedResourceForeground, #e2c08d);\r\n    }\r\n    .editor-actions {\r\n      display: flex;\r\n      gap: 8px;\r\n    }\r\n  </style>\r\n</head>\r\n<body>\r\n  <header>\r\n    <div class=\"meta\">\r\n      <div id=\"docTitle\" class=\"title\">MDOCX</div>\r\n      <div id=\"docDesc\" class=\"desc\"></div>\r\n    </div>\r\n    <div class=\"view-toggle\">\r\n      <button id=\"previewToggle\" type=\"button\" class=\"active\" title=\"Preview Mode\">\r\n        <svg viewBox=\"0 0 16 16\"><path d=\"M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z\"/><path d=\"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z\"/></svg>\r\n        Preview\r\n      </button>\r\n      <button id=\"editToggle\" type=\"button\" title=\"Edit Mode\">\r\n        <svg viewBox=\"0 0 16 16\"><path d=\"M12.146.854a.5.5 0 0 1 .708 0l2.292 2.292a.5.5 0 0 1 0 .708l-9.5 9.5a.5.5 0 0 1-.168.11l-4 1.5a.5.5 0 0 1-.638-.638l1.5-4a.5.5 0 0 1 .11-.168l9.5-9.5z\"/></svg>\r\n        Edit\r\n      </button>\r\n    </div>\r\n    <button id=\"copyBtn\" type=\"button\" class=\"secondary\" title=\"Copy Markdown to Clipboard\">\r\n      <svg viewBox=\"0 0 16 16\"><path d=\"M10 1H3.5A1.5 1.5 0 0 0 2 2.5V10h1V2.5a.5.5 0 0 1 .5-.5H10V1z\"/><path d=\"M5.5 4H12A2 2 0 0 1 14 6v6.5A2 2 0 0 1 12 14H5.5A2 2 0 0 1 3.5 12.5V6A2 2 0 0 1 5.5 4zm0 1A1 1 0 0 0 4.5 6v6.5a1 1 0 0 0 1 1H12a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H5.5z\"/></svg>\r\n      Copy\r\n    </button>\r\n    <button id=\"editExternalBtn\" type=\"button\" class=\"secondary\" title=\"Edit in VS Code Editor\">\r\n      <svg viewBox=\"0 0 16 16\"><path d=\"M4.5 1a.5.5 0 0 0-.5.5v13a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V4.207L10.793 1H4.5z\"/><path d=\"M10 1v3.5a.5.5 0 0 0 .5.5H14\"/></svg>\r\n      Open in Editor\r\n    </button>\r\n  </header>\r\n\r\n  <div class=\"layout\">\r\n    <aside class=\"sidebar\">\r\n      <!-- Files Section -->\r\n      <div class=\"sidebar-section\">\r\n        <div class=\"section-header\" id=\"filesHeader\">\r\n          <span>Files <span class=\"badge\" id=\"fileCount\">0</span></span>\r\n          <svg class=\"chevron\" viewBox=\"0 0 16 16\"><path d=\"M6 12l4-4-4-4\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"/></svg>\r\n        </div>\r\n        <div class=\"section-body\" id=\"filesBody\">\r\n          <div class=\"section-actions\">\r\n            <button type=\"button\" id=\"addFileBtn\" class=\"small\">+ Add File</button>\r\n          </div>\r\n          <ul class=\"file-list\" id=\"fileList\"></ul>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Media Section -->\r\n      <div class=\"sidebar-section\">\r\n        <div class=\"section-header\" id=\"mediaHeader\">\r\n          <span>Media <span class=\"badge\" id=\"mediaCount\">0</span></span>\r\n          <svg class=\"chevron\" viewBox=\"0 0 16 16\"><path d=\"M6 12l4-4-4-4\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"/></svg>\r\n        </div>\r\n        <div class=\"section-body\" id=\"mediaBody\">\r\n          <div class=\"section-actions\">\r\n            <button type=\"button\" id=\"addMediaBtn\" class=\"small\">+ Add Media</button>\r\n          </div>\r\n          <div class=\"media-grid\" id=\"mediaGrid\"></div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Metadata Section -->\r\n      <div class=\"sidebar-section\">\r\n        <div class=\"section-header collapsed\" id=\"metadataHeader\">\r\n          <span>Metadata</span>\r\n          <svg class=\"chevron\" viewBox=\"0 0 16 16\"><path d=\"M6 12l4-4-4-4\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"/></svg>\r\n        </div>\r\n        <div class=\"section-body\" id=\"metadataBody\">\r\n          <div class=\"form-row\">\r\n            <label for=\"metaTitle\">Title</label>\r\n            <input type=\"text\" id=\"metaTitle\" placeholder=\"Document title\" />\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <label for=\"metaDescription\">Description</label>\r\n            <textarea id=\"metaDescription\" placeholder=\"Description\"></textarea>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <label for=\"metaAuthor\">Author</label>\r\n            <input type=\"text\" id=\"metaAuthor\" placeholder=\"Author\" />\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <label for=\"metaRoot\">Root File</label>\r\n            <select id=\"metaRoot\"></select>\r\n          </div>\r\n          <div class=\"form-row\">\r\n            <label for=\"metaTags\">Tags</label>\r\n            <input type=\"text\" id=\"metaTags\" placeholder=\"tag1, tag2\" />\r\n          </div>\r\n          <div class=\"btn-row\">\r\n            <button type=\"button\" id=\"saveMetadataBtn\" class=\"small\">Save Metadata</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </aside>\r\n\r\n    <main class=\"main-content\">\r\n      <div id=\"error\" class=\"error\" style=\"display:none\"></div>\r\n      <div id=\"previewView\">\r\n        <div id=\"content\"></div>\r\n      </div>\r\n      <div id=\"editorView\">\r\n        <div class=\"editor-toolbar\">\r\n          <span class=\"file-path\" id=\"editorFilePath\"></span>\r\n          <button type=\"button\" id=\"discardBtn\" class=\"secondary small\">Discard</button>\r\n          <button type=\"button\" id=\"saveBtn\" class=\"small\">Save</button>\r\n        </div>\r\n        <div class=\"editor-container\">\r\n          <textarea id=\"markdownEditor\" placeholder=\"Enter markdown content...\"></textarea>\r\n        </div>\r\n        <div class=\"editor-status\">\r\n          <span id=\"editorStatus\"></span>\r\n          <div class=\"editor-actions\">\r\n            <span id=\"charCount\">0 characters</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  </div>\r\n\r\n  <script nonce=\"${nonce}\">\r\n    const vscode = acquireVsCodeApi();\r\n    const state = vscode.getState() || {};\r\n\r\n    // Elements\r\n    const content = document.getElementById('content');\r\n    const error = document.getElementById('error');\r\n    const docTitle = document.getElementById('docTitle');\r\n    const docDesc = document.getElementById('docDesc');\r\n    const fileList = document.getElementById('fileList');\r\n    const fileCount = document.getElementById('fileCount');\r\n    const mediaGrid = document.getElementById('mediaGrid');\r\n    const mediaCount = document.getElementById('mediaCount');\r\n    const metaTitle = document.getElementById('metaTitle');\r\n    const metaDescription = document.getElementById('metaDescription');\r\n    const metaAuthor = document.getElementById('metaAuthor');\r\n    const metaRoot = document.getElementById('metaRoot');\r\n    const metaTags = document.getElementById('metaTags');\r\n    const previewView = document.getElementById('previewView');\r\n    const editorView = document.getElementById('editorView');\r\n    const markdownEditor = document.getElementById('markdownEditor');\r\n    const editorFilePath = document.getElementById('editorFilePath');\r\n    const editorStatus = document.getElementById('editorStatus');\r\n    const charCount = document.getElementById('charCount');\r\n    const previewToggle = document.getElementById('previewToggle');\r\n    const editToggle = document.getElementById('editToggle');\r\n\r\n    let currentFiles = [];\r\n    let currentPath = '';\r\n    let rootPath = '';\r\n    let isEditMode = false;\r\n    let originalContent = '';\r\n    let isModified = false;\r\n\r\n    // Section toggle\r\n    document.querySelectorAll('.section-header').forEach(header => {\r\n      header.addEventListener('click', () => header.classList.toggle('collapsed'));\r\n    });\r\n\r\n    function setError(message) {\r\n      error.style.display = message ? 'block' : 'none';\r\n      error.textContent = message || '';\r\n    }\r\n\r\n    function escapeHtml(str) {\r\n      return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n    }\r\n\r\n    function formatBytes(bytes) {\r\n      if (bytes < 1024) return bytes + ' B';\r\n      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';\r\n      return (bytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n    }\r\n\r\n    function updateEditorStatus() {\r\n      const len = markdownEditor.value.length;\r\n      charCount.textContent = len + ' character' + (len !== 1 ? 's' : '');\r\n      isModified = markdownEditor.value !== originalContent;\r\n      if (isModified) {\r\n        editorStatus.innerHTML = '<span class=\"modified\">\u25CF Modified</span>';\r\n      } else {\r\n        editorStatus.textContent = '';\r\n      }\r\n    }\r\n\r\n    function switchToPreview() {\r\n      if (isModified) {\r\n        // Could prompt to save, but for simplicity just switch\r\n      }\r\n      isEditMode = false;\r\n      previewView.classList.remove('hidden');\r\n      editorView.classList.remove('active');\r\n      previewToggle.classList.add('active');\r\n      editToggle.classList.remove('active');\r\n    }\r\n\r\n    function switchToEdit() {\r\n      isEditMode = true;\r\n      previewView.classList.add('hidden');\r\n      editorView.classList.add('active');\r\n      previewToggle.classList.remove('active');\r\n      editToggle.classList.add('active');\r\n      editorFilePath.textContent = currentPath;\r\n      vscode.postMessage({ type: 'getMarkdownContent', path: currentPath });\r\n    }\r\n\r\n    function setFiles(files, selected, root) {\r\n      currentFiles = files || [];\r\n      currentPath = selected || currentFiles[0] || '';\r\n      rootPath = root || '';\r\n      fileCount.textContent = currentFiles.length;\r\n      fileList.innerHTML = '';\r\n      metaRoot.innerHTML = '';\r\n\r\n      if (currentFiles.length === 0) {\r\n        fileList.innerHTML = '<li class=\"empty-state\">No files yet</li>';\r\n        return;\r\n      }\r\n\r\n      for (const path of currentFiles) {\r\n        // File list item\r\n        const li = document.createElement('li');\r\n        li.className = 'file-item' + (path === currentPath ? ' selected' : '') + (path === rootPath ? ' root-file' : '');\r\n        li.innerHTML = \\`\r\n          <svg class=\"file-icon\" viewBox=\"0 0 16 16\"><path d=\"M4 0h5.5L14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 0v4.5H14L9.5 0zM4.5 12.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z\"/></svg>\r\n          <span class=\"file-name\">\\${escapeHtml(path)}</span>\r\n          <span class=\"file-actions\">\r\n            <button type=\"button\" title=\"Edit\" data-action=\"edit\" data-path=\"\\${escapeHtml(path)}\">\r\n              <svg viewBox=\"0 0 16 16\" width=\"12\" height=\"12\"><path fill=\"currentColor\" d=\"M12.146.854a.5.5 0 0 1 .708 0l2.292 2.292a.5.5 0 0 1 0 .708l-9.5 9.5a.5.5 0 0 1-.168.11l-4 1.5a.5.5 0 0 1-.638-.638l1.5-4a.5.5 0 0 1 .11-.168l9.5-9.5z\"/></svg>\r\n            </button>\r\n            <button type=\"button\" title=\"Delete\" data-action=\"delete\" data-path=\"\\${escapeHtml(path)}\">\r\n              <svg viewBox=\"0 0 16 16\" width=\"12\" height=\"12\"><path fill=\"currentColor\" d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/><path fill=\"currentColor\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/></svg>\r\n            </button>\r\n          </span>\r\n        \\`;\r\n        li.addEventListener('click', (e) => {\r\n          if (e.target.closest('button')) return;\r\n          // If in edit mode and modified, confirm before switching\r\n          if (isEditMode && isModified) {\r\n            if (!confirm('You have unsaved changes. Discard them?')) return;\r\n          }\r\n          vscode.postMessage({ type: 'select', path });\r\n        });\r\n        fileList.appendChild(li);\r\n\r\n        // Root select option\r\n        const opt = document.createElement('option');\r\n        opt.value = path;\r\n        opt.textContent = path;\r\n        metaRoot.appendChild(opt);\r\n      }\r\n\r\n      // Update root select\r\n      if (rootPath) metaRoot.value = rootPath;\r\n    }\r\n\r\n    function setMetadata(metadata) {\r\n      if (!metadata) return;\r\n      metaTitle.value = metadata.title || '';\r\n      metaDescription.value = metadata.description || '';\r\n      metaAuthor.value = metadata.author || '';\r\n      if (metadata.root) {\r\n        rootPath = metadata.root;\r\n        metaRoot.value = metadata.root;\r\n      }\r\n      metaTags.value = Array.isArray(metadata.tags) ? metadata.tags.join(', ') : '';\r\n    }\r\n\r\n    function setMediaItems(items) {\r\n      mediaCount.textContent = items ? items.length : 0;\r\n      mediaGrid.innerHTML = '';\r\n      if (!items || items.length === 0) {\r\n        mediaGrid.innerHTML = '<div class=\"empty-state\">No media</div>';\r\n        return;\r\n      }\r\n      for (const item of items) {\r\n        const div = document.createElement('div');\r\n        div.className = 'media-item';\r\n        div.innerHTML = \\`\r\n          \\${item.dataUri \r\n            ? \\`<img src=\"\\${item.dataUri}\" alt=\"\\${escapeHtml(item.id)}\" />\\`\r\n            : \\`<div class=\"placeholder\">\\${escapeHtml(item.mimeType || 'binary')}</div>\\`\r\n          }\r\n          <div class=\"info\">\\${escapeHtml(item.id)}<br/>\\${formatBytes(item.size)}</div>\r\n          <div class=\"actions\">\r\n            <button type=\"button\" class=\"small secondary\" data-action=\"replace\" data-id=\"\\${escapeHtml(item.id)}\">Replace</button>\r\n            <button type=\"button\" class=\"small danger\" data-action=\"remove\" data-id=\"\\${escapeHtml(item.id)}\">\u2715</button>\r\n          </div>\r\n        \\`;\r\n        mediaGrid.appendChild(div);\r\n      }\r\n    }\r\n\r\n    // Event delegation for file actions\r\n    fileList.addEventListener('click', (e) => {\r\n      const btn = e.target.closest('button[data-action]');\r\n      if (!btn) return;\r\n      const action = btn.dataset.action;\r\n      const path = btn.dataset.path;\r\n      if (action === 'edit') {\r\n        // Switch to inline edit for that file\r\n        if (isEditMode && isModified && currentPath !== path) {\r\n          if (!confirm('You have unsaved changes. Discard them?')) return;\r\n        }\r\n        vscode.postMessage({ type: 'select', path });\r\n        setTimeout(() => switchToEdit(), 100);\r\n      } else if (action === 'delete') {\r\n        vscode.postMessage({ type: 'deleteMarkdown', path });\r\n      }\r\n    });\r\n\r\n    // Event delegation for media actions\r\n    mediaGrid.addEventListener('click', (e) => {\r\n      const btn = e.target.closest('button[data-action]');\r\n      if (!btn) return;\r\n      const action = btn.dataset.action;\r\n      const id = btn.dataset.id;\r\n      if (action === 'replace') {\r\n        vscode.postMessage({ type: 'replaceMedia', id });\r\n      } else if (action === 'remove') {\r\n        vscode.postMessage({ type: 'removeMedia', id });\r\n      }\r\n    });\r\n\r\n    // Button handlers\r\n    document.getElementById('copyBtn').addEventListener('click', () => {\r\n      vscode.postMessage({ type: 'copy', path: currentPath });\r\n    });\r\n\r\n    document.getElementById('editExternalBtn').addEventListener('click', () => {\r\n      vscode.postMessage({ type: 'editExternal', path: currentPath });\r\n    });\r\n\r\n    previewToggle.addEventListener('click', () => {\r\n      if (!isEditMode) return;\r\n      if (isModified) {\r\n        if (!confirm('You have unsaved changes. Discard them?')) return;\r\n      }\r\n      switchToPreview();\r\n    });\r\n\r\n    editToggle.addEventListener('click', () => {\r\n      if (isEditMode) return;\r\n      switchToEdit();\r\n    });\r\n\r\n    document.getElementById('saveBtn').addEventListener('click', () => {\r\n      if (!currentPath) return;\r\n      vscode.postMessage({ type: 'saveContent', path: currentPath, content: markdownEditor.value });\r\n      originalContent = markdownEditor.value;\r\n      updateEditorStatus();\r\n    });\r\n\r\n    document.getElementById('discardBtn').addEventListener('click', () => {\r\n      if (isModified) {\r\n        if (!confirm('Discard all changes?')) return;\r\n      }\r\n      markdownEditor.value = originalContent;\r\n      updateEditorStatus();\r\n    });\r\n\r\n    markdownEditor.addEventListener('input', updateEditorStatus);\r\n\r\n    // Handle Ctrl+S in editor\r\n    markdownEditor.addEventListener('keydown', (e) => {\r\n      if ((e.ctrlKey || e.metaKey) && e.key === 's') {\r\n        e.preventDefault();\r\n        if (currentPath) {\r\n          vscode.postMessage({ type: 'saveContent', path: currentPath, content: markdownEditor.value });\r\n          originalContent = markdownEditor.value;\r\n          updateEditorStatus();\r\n        }\r\n      }\r\n    });\r\n\r\n    document.getElementById('addFileBtn').addEventListener('click', () => {\r\n      vscode.postMessage({ type: 'addMarkdown' });\r\n    });\r\n\r\n    document.getElementById('addMediaBtn').addEventListener('click', () => {\r\n      vscode.postMessage({ type: 'addMedia' });\r\n    });\r\n\r\n    document.getElementById('saveMetadataBtn').addEventListener('click', () => {\r\n      const tagsStr = metaTags.value.trim();\r\n      const tags = tagsStr ? tagsStr.split(',').map(t => t.trim()).filter(Boolean) : undefined;\r\n      vscode.postMessage({\r\n        type: 'saveMetadata',\r\n        metadata: {\r\n          title: metaTitle.value || undefined,\r\n          description: metaDescription.value || undefined,\r\n          author: metaAuthor.value || undefined,\r\n          root: metaRoot.value || undefined,\r\n          tags\r\n        }\r\n      });\r\n    });\r\n\r\n    // Init\r\n    vscode.postMessage({ type: 'ready', selectedPath: state.selectedPath });\r\n\r\n    // Message handler\r\n    window.addEventListener('message', (event) => {\r\n      const msg = event.data;\r\n      \r\n      // Handle markdown content for editor\r\n      if (msg && msg.type === 'markdownContent') {\r\n        markdownEditor.value = msg.content || '';\r\n        originalContent = msg.content || '';\r\n        editorFilePath.textContent = msg.path || currentPath;\r\n        updateEditorStatus();\r\n        markdownEditor.focus();\r\n        return;\r\n      }\r\n\r\n      if (!msg || msg.type !== 'render') return;\r\n\r\n      docTitle.textContent = msg.title || 'MDOCX';\r\n      docDesc.textContent = msg.description || '';\r\n\r\n      if (Array.isArray(msg.fileList)) {\r\n        setFiles(msg.fileList, msg.path, msg.metadata?.root);\r\n      }\r\n\r\n      if (msg.metadata) {\r\n        setMetadata(msg.metadata);\r\n      }\r\n\r\n      if (msg.mediaItems) {\r\n        setMediaItems(msg.mediaItems);\r\n      }\r\n\r\n      if (msg.path) {\r\n        vscode.setState({ selectedPath: msg.path });\r\n        // If in edit mode, update the editor content\r\n        if (isEditMode && msg.markdown) {\r\n          markdownEditor.value = msg.markdown;\r\n          originalContent = msg.markdown;\r\n          editorFilePath.textContent = msg.path;\r\n          updateEditorStatus();\r\n        }\r\n      }\r\n\r\n      setError(msg.error || null);\r\n\r\n      if (typeof msg.html === 'string') {\r\n        content.innerHTML = msg.html;\r\n      }\r\n    });\r\n  </script>\r\n</body>\r\n</html>`;\r\n  }\r\n\r\n  private escapeHtmlAttr(value: string): string {\r\n    return value\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;');\r\n  }\r\n}\r\n", "/**\n * Gets the original marked default options.\n */\nexport function _getDefaults() {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null\n    };\n}\nexport let _defaults = _getDefaults();\nexport function changeDefaults(newDefaults) {\n    _defaults = newDefaults;\n}\n", "/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = new RegExp(escapeTest.source, 'g');\nconst escapeTestNoEncode = /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/;\nconst escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');\nconst escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n};\nconst getEscapeReplacement = (ch) => escapeReplacements[ch];\nexport function escape(html, encode) {\n    if (encode) {\n        if (escapeTest.test(html)) {\n            return html.replace(escapeReplace, getEscapeReplacement);\n        }\n    }\n    else {\n        if (escapeTestNoEncode.test(html)) {\n            return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n    return html;\n}\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\nexport function unescape(html) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, (_, n) => {\n        n = n.toLowerCase();\n        if (n === 'colon')\n            return ':';\n        if (n.charAt(0) === '#') {\n            return n.charAt(1) === 'x'\n                ? String.fromCharCode(parseInt(n.substring(2), 16))\n                : String.fromCharCode(+n.substring(1));\n        }\n        return '';\n    });\n}\nconst caret = /(^|[^\\[])\\^/g;\nexport function edit(regex, opt) {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    const obj = {\n        replace: (name, val) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        }\n    };\n    return obj;\n}\nexport function cleanUrl(href) {\n    try {\n        href = encodeURI(href).replace(/%25/g, '%');\n    }\n    catch (e) {\n        return null;\n    }\n    return href;\n}\nexport const noopTest = { exec: () => null };\nexport function splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n        let escaped = false;\n        let curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\')\n            escaped = !escaped;\n        if (escaped) {\n            // odd number of slashes means | is escaped\n            // so we leave it alone\n            return '|';\n        }\n        else {\n            // add space before unescaped |\n            return ' |';\n        }\n    }), cells = row.split(/ \\|/);\n    let i = 0;\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n        cells.pop();\n    }\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        }\n        else {\n            while (cells.length < count)\n                cells.push('');\n        }\n    }\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n    return cells;\n}\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nexport function rtrim(str, c, invert) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && !invert) {\n            suffLen++;\n        }\n        else if (currChar !== c && invert) {\n            suffLen++;\n        }\n        else {\n            break;\n        }\n    }\n    return str.slice(0, l - suffLen);\n}\nexport function findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        }\n        else if (str[i] === b[0]) {\n            level++;\n        }\n        else if (str[i] === b[1]) {\n            level--;\n            if (level < 0) {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n", "import { _defaults } from './defaults.ts';\nimport { rtrim, splitCells, escape, findClosingBracket } from './helpers.ts';\nfunction outputLink(cap, link, raw, lexer) {\n    const href = link.href;\n    const title = link.title ? escape(link.title) : null;\n    const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text)\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text: escape(text)\n    };\n}\nfunction indentCodeCompensation(raw, text) {\n    const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n    if (matchIndentToCode === null) {\n        return text;\n    }\n    const indentToCode = matchIndentToCode[1];\n    return text\n        .split('\\n')\n        .map(node => {\n        const matchIndentInNode = node.match(/^\\s+/);\n        if (matchIndentInNode === null) {\n            return node;\n        }\n        const [indentInNode] = matchIndentInNode;\n        if (indentInNode.length >= indentToCode.length) {\n            return node.slice(indentToCode.length);\n        }\n        return node;\n    })\n        .join('\\n');\n}\n/**\n * Tokenizer\n */\nexport class _Tokenizer {\n    options;\n    rules; // set by the lexer\n    lexer; // set by the lexer\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(src) {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0]\n            };\n        }\n    }\n    code(src) {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(/^ {1,4}/gm, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text\n            };\n        }\n    }\n    fences(src) {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '');\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text\n            };\n        }\n    }\n    heading(src) {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n            // remove trailing #s\n            if (/#$/.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                }\n                else if (!trimmed || / $/.test(trimmed)) {\n                    // CommonMark requires space before trailing #s\n                    text = trimmed.trim();\n                }\n            }\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text)\n            };\n        }\n    }\n    hr(src) {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: cap[0]\n            };\n        }\n    }\n    blockquote(src) {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            // precede setext continuation with 4 spaces so it isn't a setext\n            let text = cap[0].replace(/\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g, '\\n    $1');\n            text = rtrim(text.replace(/^ *>[ \\t]?/gm, ''), '\\n');\n            const top = this.lexer.state.top;\n            this.lexer.state.top = true;\n            const tokens = this.lexer.blockTokens(text);\n            this.lexer.state.top = top;\n            return {\n                type: 'blockquote',\n                raw: cap[0],\n                tokens,\n                text\n            };\n        }\n    }\n    list(src) {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n            const list = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: []\n            };\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n            // Get next list item\n            const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`);\n            let raw = '';\n            let itemContents = '';\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n                raw = cap[0];\n                src = src.substring(raw.length);\n                let line = cap[2].split('\\n', 1)[0].replace(/^\\t+/, (t) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                }\n                else {\n                    indent = cap[2].search(/[^ ]/); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n                let blankLine = false;\n                if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n                if (!endEarly) {\n                    const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`);\n                    const hrRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`);\n                    const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`);\n                    const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        nextLine = rawLine;\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n                        }\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n                        // Horizontal rule found\n                        if (hrRegex.test(src)) {\n                            break;\n                        }\n                        if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLine.slice(indent);\n                        }\n                        else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.search(/[^ ]/) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n                            itemContents += '\\n' + nextLine;\n                        }\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLine.slice(indent);\n                    }\n                }\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    }\n                    else if (/\\n *\\n *$/.test(raw)) {\n                        endsWithBlankLine = true;\n                    }\n                }\n                let istask = null;\n                let ischecked;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = /^\\[[ xX]\\] /.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n                    }\n                }\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: []\n                });\n                list.raw += raw;\n            }\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n            list.items[list.items.length - 1].raw = raw.trimEnd();\n            (list.items[list.items.length - 1]).text = itemContents.trimEnd();\n            list.raw = list.raw.trimEnd();\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\\n.*\\n/.test(t.raw));\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n            return list;\n        }\n    }\n    html(src) {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0]\n            };\n            return token;\n        }\n    }\n    def(src) {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n            const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, '$1') : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title\n            };\n        }\n    }\n    table(src) {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n        if (!/[:|]/.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(/^\\||\\| *$/g, '').split('|');\n        const rows = cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : [];\n        const item = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: []\n        };\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n        for (const align of aligns) {\n            if (/^ *-+: *$/.test(align)) {\n                item.align.push('right');\n            }\n            else if (/^ *:-+: *$/.test(align)) {\n                item.align.push('center');\n            }\n            else if (/^ *:-+ *$/.test(align)) {\n                item.align.push('left');\n            }\n            else {\n                item.align.push(null);\n            }\n        }\n        for (const header of headers) {\n            item.header.push({\n                text: header,\n                tokens: this.lexer.inline(header)\n            });\n        }\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map(cell => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell)\n                };\n            }));\n        }\n        return item;\n    }\n    lheading(src) {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1])\n            };\n        }\n    }\n    paragraph(src) {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text)\n            };\n        }\n    }\n    text(src) {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0])\n            };\n        }\n    }\n    escape(src) {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: escape(cap[1])\n            };\n        }\n    }\n    tag(src) {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            }\n            else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n                this.lexer.state.inLink = false;\n            }\n            if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            }\n            else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = false;\n            }\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0]\n            };\n        }\n    }\n    link(src) {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(/>$/.test(trimmedUrl))) {\n                    return;\n                }\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            }\n            else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            }\n            else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n            href = href.trim();\n            if (/^</.test(href)) {\n                if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                }\n                else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title\n            }, cap[0], this.lexer);\n        }\n    }\n    reflink(src, links) {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer);\n        }\n    }\n    emStrong(src, maskedSrc, prevChar = '') {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match)\n            return;\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u))\n            return;\n        const nextChar = match[1] || match[2] || '';\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...match[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n            const endReg = match[0][0] === '*' ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n                if (!rDelim)\n                    continue; // skip single * in __abc*abc__\n                rLength = [...rDelim].length;\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                }\n                else if (match[5] || match[6]) { // either Left or Right Delim\n                    if (lLength % 3 && !((lLength + rLength) % 3)) {\n                        midDelimTotal += rLength;\n                        continue; // CommonMark Emphasis Rules 9-10\n                    }\n                }\n                delimTotal -= rLength;\n                if (delimTotal > 0)\n                    continue; // Haven't found enough closing delimiters\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...match[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text)\n                    };\n                }\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text)\n                };\n            }\n        }\n    }\n    codespan(src) {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(/\\n/g, ' ');\n            const hasNonSpaceChars = /[^ ]/.test(text);\n            const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            text = escape(text, true);\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text\n            };\n        }\n    }\n    br(src) {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0]\n            };\n        }\n    }\n    del(src) {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2])\n            };\n        }\n    }\n    autolink(src) {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape(cap[1]);\n                href = 'mailto:' + text;\n            }\n            else {\n                text = escape(cap[1]);\n                href = text;\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text\n                    }\n                ]\n            };\n        }\n    }\n    url(src) {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape(cap[0]);\n                href = 'mailto:' + text;\n            }\n            else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                } while (prevCapZero !== cap[0]);\n                text = escape(cap[0]);\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                }\n                else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text\n                    }\n                ]\n            };\n        }\n    }\n    inlineText(src) {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            let text;\n            if (this.lexer.state.inRawBlock) {\n                text = cap[0];\n            }\n            else {\n                text = escape(cap[0]);\n            }\n            return {\n                type: 'text',\n                raw: cap[0],\n                text\n            };\n        }\n    }\n}\n", "import { edit, noopTest } from './helpers.ts';\n/**\n * Block-Level Grammar\n */\nconst newline = /^(?: *(?:\\n|$))+/;\nconst blockCode = /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheading = edit(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, / {4}/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n *)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title'\n    + '|tr|track|ul';\nconst _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\nconst html = edit('^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n/**\n * Normal Block Grammar\n */\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText\n};\n/**\n * GFM Block Grammar\n */\nconst gfmTable = edit('^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', ' {4}[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockGfm = {\n    ...blockNormal,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex()\n};\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\nconst blockPedantic = {\n    ...blockNormal,\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n        + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n        + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n        + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex()\n};\n/**\n * Inline-Level Grammar\n */\nconst escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = '\\\\p{P}\\\\p{S}';\nconst punctuation = edit(/^((?![*_])[\\spunctuation])/, 'u')\n    .replace(/punctuation/g, _punctuation).getRegex();\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\([^\\(\\)]*?\\)|`[^`]*?`|<[^<>]*?>/g;\nconst emStrongLDelim = edit(/^(?:\\*+(?:((?!\\*)[punct])|[^\\s*]))|^_+(?:((?!_)[punct])|([^\\s_]))/, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst emStrongRDelimAst = edit('^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)[punct](\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?!\\\\*)(?=[punct\\\\s]|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)[punct\\\\s](\\\\*+)(?=[^punct\\\\s])' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=[punct])' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)[punct](\\\\*+)(?!\\\\*)(?=[punct])' // (5) #***# can be either Left or Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?=[^punct\\\\s])', 'gu') // (6) a***a can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit('^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)[punct](_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|[^punct\\\\s](_+)(?!_)(?=[punct\\\\s]|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)[punct\\\\s](_+)(?=[^punct\\\\s])' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=[punct])' // (4) ___# can only be Left Delimiter\n    + '|(?!_)[punct](_+)(?!_)(?=[punct])', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst anyPunctuation = edit(/\\\\([punct])/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email', /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/)\n    .getRegex();\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit('^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n/**\n * Normal Inline Grammar\n */\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest\n};\n/**\n * Pedantic Inline Grammar\n */\nconst inlinePedantic = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex()\n};\n/**\n * GFM Inline Grammar\n */\nconst inlineGfm = {\n    ...inlineNormal,\n    escape: edit(escape).replace('])', '~|])').getRegex(),\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\n};\n/**\n * GFM + Line Breaks Inline Grammar\n */\nconst inlineBreaks = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex()\n};\n/**\n * exports\n */\nexport const block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic\n};\nexport const inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic\n};\n", "import { _Tokenizer } from './Tokenizer.ts';\nimport { _defaults } from './defaults.ts';\nimport { block, inline } from './rules.ts';\n/**\n * Block Lexer\n */\nexport class _Lexer {\n    tokens;\n    options;\n    state;\n    tokenizer;\n    inlineQueue;\n    constructor(options) {\n        // TokenList cannot be created in one go\n        this.tokens = [];\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true\n        };\n        const rules = {\n            block: block.normal,\n            inline: inline.normal\n        };\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        }\n        else if (this.options.gfm) {\n            rules.block = block.gfm;\n            if (this.options.breaks) {\n                rules.inline = inline.breaks;\n            }\n            else {\n                rules.inline = inline.gfm;\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline\n        };\n    }\n    /**\n     * Static Lex Method\n     */\n    static lex(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    lex(src) {\n        src = src\n            .replace(/\\r\\n|\\r/g, '\\n');\n        this.blockTokens(src, this.tokens);\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n        return this.tokens;\n    }\n    blockTokens(src, tokens = []) {\n        if (this.options.pedantic) {\n            src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n        }\n        else {\n            src = src.replace(/^( *)(\\t+)/gm, (_, leading, tabs) => {\n                return leading + '    '.repeat(tabs.length);\n            });\n        }\n        let token;\n        let lastToken;\n        let cutSrc;\n        let lastParagraphClipped;\n        while (src) {\n            if (this.options.extensions\n                && this.options.extensions.block\n                && this.options.extensions.block.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.length === 1 && tokens.length > 0) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    tokens[tokens.length - 1].raw += '\\n';\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else if (!this.tokens.links[token.tag]) {\n                    this.tokens.links[token.tag] = {\n                        href: token.href,\n                        title: token.title\n                    };\n                }\n                continue;\n            }\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                lastToken = tokens[tokens.length - 1];\n                if (lastParagraphClipped && lastToken.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = (cutSrc.length !== src.length);\n                src = src.substring(token.raw.length);\n                continue;\n            }\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        this.state.top = true;\n        return tokens;\n    }\n    inline(src, tokens = []) {\n        this.inlineQueue.push({ src, tokens });\n        return tokens;\n    }\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src, tokens = []) {\n        let token, lastToken, cutSrc;\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match;\n        let keepPrevChar, prevChar;\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n            // extensions\n            if (this.options.extensions\n                && this.options.extensions.inline\n                && this.options.extensions.inline.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        return tokens;\n    }\n}\n", "import { _defaults } from './defaults.ts';\nimport { cleanUrl, escape } from './helpers.ts';\n/**\n * Renderer\n */\nexport class _Renderer {\n    options;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    code(code, infostring, escaped) {\n        const lang = (infostring || '').match(/^\\S*/)?.[0];\n        code = code.replace(/\\n$/, '') + '\\n';\n        if (!lang) {\n            return '<pre><code>'\n                + (escaped ? code : escape(code, true))\n                + '</code></pre>\\n';\n        }\n        return '<pre><code class=\"language-'\n            + escape(lang)\n            + '\">'\n            + (escaped ? code : escape(code, true))\n            + '</code></pre>\\n';\n    }\n    blockquote(quote) {\n        return `<blockquote>\\n${quote}</blockquote>\\n`;\n    }\n    html(html, block) {\n        return html;\n    }\n    heading(text, level, raw) {\n        // ignore IDs\n        return `<h${level}>${text}</h${level}>\\n`;\n    }\n    hr() {\n        return '<hr>\\n';\n    }\n    list(body, ordered, start) {\n        const type = ordered ? 'ol' : 'ul';\n        const startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n    listitem(text, task, checked) {\n        return `<li>${text}</li>\\n`;\n    }\n    checkbox(checked) {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n    paragraph(text) {\n        return `<p>${text}</p>\\n`;\n    }\n    table(header, body) {\n        if (body)\n            body = `<tbody>${body}</tbody>`;\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n    tablerow(content) {\n        return `<tr>\\n${content}</tr>\\n`;\n    }\n    tablecell(content, flags) {\n        const type = flags.header ? 'th' : 'td';\n        const tag = flags.align\n            ? `<${type} align=\"${flags.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n    /**\n     * span level renderer\n     */\n    strong(text) {\n        return `<strong>${text}</strong>`;\n    }\n    em(text) {\n        return `<em>${text}</em>`;\n    }\n    codespan(text) {\n        return `<code>${text}</code>`;\n    }\n    br() {\n        return '<br>';\n    }\n    del(text) {\n        return `<del>${text}</del>`;\n    }\n    link(href, title, text) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + title + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n    image(href, title, text) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${title}\"`;\n        }\n        out += '>';\n        return out;\n    }\n    text(text) {\n        return text;\n    }\n}\n", "/**\n * TextRenderer\n * returns only the textual part of the token\n */\nexport class _TextRenderer {\n    // no need for block level renderers\n    strong(text) {\n        return text;\n    }\n    em(text) {\n        return text;\n    }\n    codespan(text) {\n        return text;\n    }\n    del(text) {\n        return text;\n    }\n    html(text) {\n        return text;\n    }\n    text(text) {\n        return text;\n    }\n    link(href, title, text) {\n        return '' + text;\n    }\n    image(href, title, text) {\n        return '' + text;\n    }\n    br() {\n        return '';\n    }\n}\n", "import { _Renderer } from './Renderer.ts';\nimport { _TextRenderer } from './TextRenderer.ts';\nimport { _defaults } from './defaults.ts';\nimport { unescape } from './helpers.ts';\n/**\n * Parsing & Compiling\n */\nexport class _Parser {\n    options;\n    renderer;\n    textRenderer;\n    constructor(options) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.textRenderer = new _TextRenderer();\n    }\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    parse(tokens, top = true) {\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n                const genericToken = token;\n                const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\n                if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            switch (token.type) {\n                case 'space': {\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr();\n                    continue;\n                }\n                case 'heading': {\n                    const headingToken = token;\n                    out += this.renderer.heading(this.parseInline(headingToken.tokens), headingToken.depth, unescape(this.parseInline(headingToken.tokens, this.textRenderer)));\n                    continue;\n                }\n                case 'code': {\n                    const codeToken = token;\n                    out += this.renderer.code(codeToken.text, codeToken.lang, !!codeToken.escaped);\n                    continue;\n                }\n                case 'table': {\n                    const tableToken = token;\n                    let header = '';\n                    // header\n                    let cell = '';\n                    for (let j = 0; j < tableToken.header.length; j++) {\n                        cell += this.renderer.tablecell(this.parseInline(tableToken.header[j].tokens), { header: true, align: tableToken.align[j] });\n                    }\n                    header += this.renderer.tablerow(cell);\n                    let body = '';\n                    for (let j = 0; j < tableToken.rows.length; j++) {\n                        const row = tableToken.rows[j];\n                        cell = '';\n                        for (let k = 0; k < row.length; k++) {\n                            cell += this.renderer.tablecell(this.parseInline(row[k].tokens), { header: false, align: tableToken.align[k] });\n                        }\n                        body += this.renderer.tablerow(cell);\n                    }\n                    out += this.renderer.table(header, body);\n                    continue;\n                }\n                case 'blockquote': {\n                    const blockquoteToken = token;\n                    const body = this.parse(blockquoteToken.tokens);\n                    out += this.renderer.blockquote(body);\n                    continue;\n                }\n                case 'list': {\n                    const listToken = token;\n                    const ordered = listToken.ordered;\n                    const start = listToken.start;\n                    const loose = listToken.loose;\n                    let body = '';\n                    for (let j = 0; j < listToken.items.length; j++) {\n                        const item = listToken.items[j];\n                        const checked = item.checked;\n                        const task = item.task;\n                        let itemBody = '';\n                        if (item.task) {\n                            const checkbox = this.renderer.checkbox(!!checked);\n                            if (loose) {\n                                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                                    }\n                                }\n                                else {\n                                    item.tokens.unshift({\n                                        type: 'text',\n                                        text: checkbox + ' '\n                                    });\n                                }\n                            }\n                            else {\n                                itemBody += checkbox + ' ';\n                            }\n                        }\n                        itemBody += this.parse(item.tokens, loose);\n                        body += this.renderer.listitem(itemBody, task, !!checked);\n                    }\n                    out += this.renderer.list(body, ordered, start);\n                    continue;\n                }\n                case 'html': {\n                    const htmlToken = token;\n                    out += this.renderer.html(htmlToken.text, htmlToken.block);\n                    continue;\n                }\n                case 'paragraph': {\n                    const paragraphToken = token;\n                    out += this.renderer.paragraph(this.parseInline(paragraphToken.tokens));\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token;\n                    let body = textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text;\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i];\n                        body += '\\n' + (textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text);\n                    }\n                    out += top ? this.renderer.paragraph(body) : body;\n                    continue;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens, renderer) {\n        renderer = renderer || this.renderer;\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n                const ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);\n                if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            switch (token.type) {\n                case 'escape': {\n                    const escapeToken = token;\n                    out += renderer.text(escapeToken.text);\n                    break;\n                }\n                case 'html': {\n                    const tagToken = token;\n                    out += renderer.html(tagToken.text);\n                    break;\n                }\n                case 'link': {\n                    const linkToken = token;\n                    out += renderer.link(linkToken.href, linkToken.title, this.parseInline(linkToken.tokens, renderer));\n                    break;\n                }\n                case 'image': {\n                    const imageToken = token;\n                    out += renderer.image(imageToken.href, imageToken.title, imageToken.text);\n                    break;\n                }\n                case 'strong': {\n                    const strongToken = token;\n                    out += renderer.strong(this.parseInline(strongToken.tokens, renderer));\n                    break;\n                }\n                case 'em': {\n                    const emToken = token;\n                    out += renderer.em(this.parseInline(emToken.tokens, renderer));\n                    break;\n                }\n                case 'codespan': {\n                    const codespanToken = token;\n                    out += renderer.codespan(codespanToken.text);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br();\n                    break;\n                }\n                case 'del': {\n                    const delToken = token;\n                    out += renderer.del(this.parseInline(delToken.tokens, renderer));\n                    break;\n                }\n                case 'text': {\n                    const textToken = token;\n                    out += renderer.text(textToken.text);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n", "import { _defaults } from './defaults.ts';\nexport class _Hooks {\n    options;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens'\n    ]);\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown) {\n        return markdown;\n    }\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html) {\n        return html;\n    }\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens) {\n        return tokens;\n    }\n}\n", "import { _getDefaults } from './defaults.ts';\nimport { _Lexer } from './Lexer.ts';\nimport { _Parser } from './Parser.ts';\nimport { _Hooks } from './Hooks.ts';\nimport { _Renderer } from './Renderer.ts';\nimport { _Tokenizer } from './Tokenizer.ts';\nimport { _TextRenderer } from './TextRenderer.ts';\nimport { escape } from './helpers.ts';\nexport class Marked {\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.#parseMarkdown(_Lexer.lex, _Parser.parse);\n    parseInline = this.#parseMarkdown(_Lexer.lexInline, _Parser.parseInline);\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Lexer = _Lexer;\n    Tokenizer = _Tokenizer;\n    Hooks = _Hooks;\n    constructor(...args) {\n        this.use(...args);\n    }\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens, callback) {\n        let values = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity);\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    }\n                    else if (genericToken.tokens) {\n                        values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                    }\n                }\n            }\n        }\n        return values;\n    }\n    use(...args) {\n        const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = { ...pack };\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        }\n                        else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error(\"extension level must be 'block' or 'inline'\");\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        }\n                        else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                }\n                                else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            }\n                            else if (ext.level === 'inline') {\n                                if (extensions.startInline) {\n                                    extensions.startInline.push(ext.start);\n                                }\n                                else {\n                                    extensions.startInline = [ext.start];\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop;\n                    const rendererFunc = pack.renderer[rendererProp];\n                    const prevRenderer = renderer[rendererProp];\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp];\n                    const prevTokenizer = tokenizer[tokenizerProp];\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-expect-error cannot type tokenizer function dynamically\n                    tokenizer[tokenizerProp] = (...args) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const hooksProp = prop;\n                    const hooksFunc = pack.hooks[hooksProp];\n                    const prevHook = hooks[hooksProp];\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (arg) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    }\n                    else {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (...args) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n            this.defaults = { ...this.defaults, ...opts };\n        });\n        return this;\n    }\n    setOptions(opt) {\n        this.defaults = { ...this.defaults, ...opt };\n        return this;\n    }\n    lexer(src, options) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n    parser(tokens, options) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n    #parseMarkdown(lexer, parser) {\n        return (src, options) => {\n            const origOpt = { ...options };\n            const opt = { ...this.defaults, ...origOpt };\n            // Show warning if an extension set async to true but the parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                if (!opt.silent) {\n                    console.warn('marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored.');\n                }\n                opt.async = true;\n            }\n            const throwError = this.#onError(!!opt.silent, !!opt.async);\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n            }\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                    .then(src => lexer(src, opt))\n                    .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                    .then(tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens)\n                    .then(tokens => parser(tokens, opt))\n                    .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                    .catch(throwError);\n            }\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src);\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens);\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html);\n                }\n                return html;\n            }\n            catch (e) {\n                return throwError(e);\n            }\n        };\n    }\n    #onError(silent, async) {\n        return (e) => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n}\n", "import { _Lexer } from './Lexer.ts';\nimport { _Parser } from './Parser.ts';\nimport { _Tokenizer } from './Tokenizer.ts';\nimport { _Renderer } from './Renderer.ts';\nimport { _TextRenderer } from './TextRenderer.ts';\nimport { _Hooks } from './Hooks.ts';\nimport { Marked } from './Instance.ts';\nimport { _getDefaults, changeDefaults, _defaults } from './defaults.ts';\nconst markedInstance = new Marked();\nexport function marked(src, opt) {\n    return markedInstance.parse(src, opt);\n}\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\nmarked.defaults = _defaults;\n/**\n * Use Extension\n */\nmarked.use = function (...args) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n/**\n * Run callback for every token\n */\nmarked.walkTokens = function (tokens, callback) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\nexport const options = marked.options;\nexport const setOptions = marked.setOptions;\nexport const use = marked.use;\nexport const walkTokens = marked.walkTokens;\nexport const parseInline = marked.parseInline;\nexport const parse = marked;\nexport const parser = _Parser.parse;\nexport const lexer = _Lexer.lex;\nexport { _defaults as defaults, _getDefaults as getDefaults } from './defaults.ts';\nexport { _Lexer as Lexer } from './Lexer.ts';\nexport { _Parser as Parser } from './Parser.ts';\nexport { _Tokenizer as Tokenizer } from './Tokenizer.ts';\nexport { _Renderer as Renderer } from './Renderer.ts';\nexport { _TextRenderer as TextRenderer } from './TextRenderer.ts';\nexport { _Hooks as Hooks } from './Hooks.ts';\nexport { Marked } from './Instance.ts';\n", "import * as vscode from 'vscode';\r\nimport { Buffer } from 'buffer';\r\nimport { TextDecoder, TextEncoder } from 'util';\r\n\r\n/**\r\n * Virtual FileSystemProvider for embedded markdown files within MDOCX containers.\r\n *\r\n * URI scheme: mdocx-md://<encoded-mdocx-path>/<embedded-path>\r\n *\r\n * Example:\r\n *   mdocx-md:///D%3A%2FDocs%2Fexample.mdocx/docs/readme.md\r\n *\r\n * Authority is the percent-encoded path to the .mdocx file on disk.\r\n * Path is the embedded markdown file path inside the container.\r\n */\r\nexport class MdocxFileSystemProvider implements vscode.FileSystemProvider {\r\n  public static readonly scheme = 'mdocx-md';\r\n\r\n  private readonly _onDidChangeFile = new vscode.EventEmitter<vscode.FileChangeEvent[]>();\r\n  readonly onDidChangeFile = this._onDidChangeFile.event;\r\n\r\n  public static register(context: vscode.ExtensionContext): vscode.Disposable {\r\n    const provider = new MdocxFileSystemProvider();\r\n    return vscode.workspace.registerFileSystemProvider(MdocxFileSystemProvider.scheme, provider, {\r\n      isCaseSensitive: true,\r\n      isReadonly: false\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Build a URI for an embedded markdown file.\r\n   */\r\n  public static buildUri(mdocxUri: vscode.Uri, embeddedPath: string): vscode.Uri {\r\n    const encodedMdocx = encodeURIComponent(mdocxUri.fsPath);\r\n    // Ensure embeddedPath starts with /\r\n    const normalizedPath = embeddedPath.startsWith('/') ? embeddedPath : '/' + embeddedPath;\r\n    return vscode.Uri.parse(`${MdocxFileSystemProvider.scheme}://${encodedMdocx}${normalizedPath}`);\r\n  }\r\n\r\n  /**\r\n   * Parse a mdocx-md URI back to (mdocxUri, embeddedPath).\r\n   * Returns null if the URI is malformed.\r\n   */\r\n  public static parseUri(uri: vscode.Uri): { mdocxUri: vscode.Uri; embeddedPath: string } | null {\r\n    try {\r\n      if (!uri.authority) {\r\n        return null;\r\n      }\r\n      const mdocxFsPath = decodeURIComponent(uri.authority);\r\n      if (!mdocxFsPath) {\r\n        return null;\r\n      }\r\n      const embeddedPath = uri.path.startsWith('/') ? uri.path.slice(1) : uri.path;\r\n      if (!embeddedPath) {\r\n        return null;\r\n      }\r\n      return {\r\n        mdocxUri: vscode.Uri.file(mdocxFsPath),\r\n        embeddedPath\r\n      };\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // --- FileSystemProvider implementation ---\r\n\r\n  watch(_uri: vscode.Uri): vscode.Disposable {\r\n    // No-op watcher; we rely on explicit change events.\r\n    return new vscode.Disposable(() => {});\r\n  }\r\n\r\n  async stat(uri: vscode.Uri): Promise<vscode.FileStat> {\r\n    try {\r\n      const parsed = MdocxFileSystemProvider.parseUri(uri);\r\n      if (!parsed) {\r\n        throw vscode.FileSystemError.FileNotFound(uri);\r\n      }\r\n      const { mdocxUri, embeddedPath } = parsed;\r\n      const file = await this.findFile(mdocxUri, embeddedPath);\r\n      if (!file) {\r\n        throw vscode.FileSystemError.FileNotFound(uri);\r\n      }\r\n      return {\r\n        type: vscode.FileType.File,\r\n        ctime: 0,\r\n        mtime: Date.now(),\r\n        size: file.content.byteLength\r\n      };\r\n    } catch (e) {\r\n      if (e instanceof vscode.FileSystemError) {\r\n        throw e;\r\n      }\r\n      throw vscode.FileSystemError.FileNotFound(uri);\r\n    }\r\n  }\r\n\r\n  async readDirectory(_uri: vscode.Uri): Promise<[string, vscode.FileType][]> {\r\n    // Not used; we don't expose directory browsing.\r\n    return [];\r\n  }\r\n\r\n  createDirectory(_uri: vscode.Uri): void | Thenable<void> {\r\n    throw vscode.FileSystemError.NoPermissions('Cannot create directories in MDOCX.');\r\n  }\r\n\r\n  async readFile(uri: vscode.Uri): Promise<Uint8Array> {\r\n    try {\r\n      const parsed = MdocxFileSystemProvider.parseUri(uri);\r\n      if (!parsed) {\r\n        throw vscode.FileSystemError.FileNotFound(uri);\r\n      }\r\n      const { mdocxUri, embeddedPath } = parsed;\r\n      const file = await this.findFile(mdocxUri, embeddedPath);\r\n      if (!file) {\r\n        throw vscode.FileSystemError.FileNotFound(uri);\r\n      }\r\n      return file.content;\r\n    } catch (e) {\r\n      if (e instanceof vscode.FileSystemError) {\r\n        throw e;\r\n      }\r\n      throw vscode.FileSystemError.FileNotFound(uri);\r\n    }\r\n  }\r\n\r\n  async writeFile(\r\n    uri: vscode.Uri,\r\n    content: Uint8Array,\r\n    _options: { create: boolean; overwrite: boolean }\r\n  ): Promise<void> {\r\n    const parsed = MdocxFileSystemProvider.parseUri(uri);\r\n    if (!parsed) {\r\n      throw vscode.FileSystemError.FileNotFound(uri);\r\n    }\r\n    const { mdocxUri, embeddedPath } = parsed;\r\n\r\n    const bytes = await vscode.workspace.fs.readFile(mdocxUri);\r\n    const { readMdocx, writeMdocxAsync } = await import('ts-mdocx');\r\n    const doc = await readMdocx(bytes);\r\n\r\n    const file = doc.markdown.files.find((f: { path: string }) => f.path === embeddedPath);\r\n    if (!file) {\r\n      throw vscode.FileSystemError.FileNotFound(uri);\r\n    }\r\n\r\n    // Update the content\r\n    file.content = content;\r\n\r\n    // Re-write the MDOCX\r\n    const newBytes = await writeMdocxAsync(doc.markdown, doc.media, {\r\n      metadata: doc.metadata,\r\n      markdownCompression: 'zip',\r\n      mediaCompression: 'zip'\r\n    });\r\n\r\n    await vscode.workspace.fs.writeFile(mdocxUri, newBytes);\r\n\r\n    this._onDidChangeFile.fire([{ type: vscode.FileChangeType.Changed, uri }]);\r\n  }\r\n\r\n  delete(_uri: vscode.Uri, _options: { recursive: boolean }): void | Thenable<void> {\r\n    throw vscode.FileSystemError.NoPermissions('Cannot delete files from MDOCX via this provider.');\r\n  }\r\n\r\n  rename(_oldUri: vscode.Uri, _newUri: vscode.Uri, _options: { overwrite: boolean }): void | Thenable<void> {\r\n    throw vscode.FileSystemError.NoPermissions('Cannot rename files in MDOCX via this provider.');\r\n  }\r\n\r\n  // --- Helpers ---\r\n\r\n  private async findFile(\r\n    mdocxUri: vscode.Uri,\r\n    embeddedPath: string\r\n  ): Promise<{ path: string; content: Uint8Array } | undefined> {\r\n    try {\r\n      const bytes = await vscode.workspace.fs.readFile(mdocxUri);\r\n      const { readMdocx } = await import('ts-mdocx');\r\n      const doc = await readMdocx(bytes);\r\n      return doc.markdown.files.find((f: { path: string }) => f.path === embeddedPath);\r\n    } catch {\r\n      return undefined;\r\n    }\r\n  }\r\n}\r\n", "import * as vscode from 'vscode';\r\nimport { MdocxFileSystemProvider } from './mdocxFileSystemProvider.js';\r\n\r\n/**\r\n * Provides autocomplete suggestions for media references when editing\r\n * markdown files embedded in MDOCX containers.\r\n */\r\nexport class MdocxCompletionProvider implements vscode.CompletionItemProvider {\r\n  public static readonly scheme = MdocxFileSystemProvider.scheme;\r\n\r\n  // Trigger on common image/link patterns\r\n  public static readonly triggerCharacters = ['/', '(', '[', '!', '.', '\"', \"'\"];\r\n\r\n  public static register(context: vscode.ExtensionContext): vscode.Disposable {\r\n    const provider = new MdocxCompletionProvider();\r\n    return vscode.languages.registerCompletionItemProvider(\r\n      { scheme: MdocxCompletionProvider.scheme, language: 'markdown' },\r\n      provider,\r\n      ...MdocxCompletionProvider.triggerCharacters\r\n    );\r\n  }\r\n\r\n  async provideCompletionItems(\r\n    document: vscode.TextDocument,\r\n    position: vscode.Position,\r\n    _token: vscode.CancellationToken,\r\n    _context: vscode.CompletionContext\r\n  ): Promise<vscode.CompletionItem[] | undefined> {\r\n    // Only for mdocx-md:// URIs\r\n    if (document.uri.scheme !== MdocxCompletionProvider.scheme) {\r\n      return undefined;\r\n    }\r\n\r\n    const parsed = MdocxFileSystemProvider.parseUri(document.uri);\r\n    if (!parsed) {\r\n      return undefined;\r\n    }\r\n\r\n    // Check if we're in a context where media references make sense\r\n    const line = document.lineAt(position.line).text;\r\n    const textBefore = line.substring(0, position.character);\r\n\r\n    // Match patterns like:\r\n    // ![alt](  - image\r\n    // [text](  - link\r\n    // src=\"    - HTML attribute\r\n    // href=\"   - HTML attribute\r\n    // ![       - starting image syntax\r\n    const isImageOrLinkContext = \r\n      /!\\[[^\\]]*\\]\\([^)]*$/.test(textBefore) ||  // ![alt](path\r\n      /\\[[^\\]]*\\]\\([^)]*$/.test(textBefore) ||   // [text](path\r\n      /src=[\"'][^\"']*$/.test(textBefore) ||       // src=\"path\r\n      /href=[\"'][^\"']*$/.test(textBefore) ||      // href=\"path\r\n      /!\\[$/.test(textBefore) ||                  // ![\r\n      /!\\[[^\\]]*$/.test(textBefore);              // ![alt text\r\n\r\n    if (!isImageOrLinkContext) {\r\n      return undefined;\r\n    }\r\n\r\n    try {\r\n      const mediaItems = await this.getMediaItems(parsed.mdocxUri);\r\n      if (!mediaItems || mediaItems.length === 0) {\r\n        return undefined;\r\n      }\r\n\r\n      const completions: vscode.CompletionItem[] = [];\r\n\r\n      for (const item of mediaItems) {\r\n        // Create completion for path-based reference\r\n        if (item.path) {\r\n          const pathCompletion = new vscode.CompletionItem(\r\n            item.path,\r\n            vscode.CompletionItemKind.File\r\n          );\r\n          pathCompletion.detail = `${item.mimeType || 'media'} (${this.formatBytes(item.size)})`;\r\n          pathCompletion.documentation = new vscode.MarkdownString(\r\n            `**Media ID:** ${item.id}\\n\\n**Path:** ${item.path}\\n\\n**Type:** ${item.mimeType || 'unknown'}\\n\\n**Size:** ${this.formatBytes(item.size)}`\r\n          );\r\n          pathCompletion.insertText = item.path;\r\n          pathCompletion.sortText = '0_' + item.path; // Sort paths first\r\n          completions.push(pathCompletion);\r\n        }\r\n\r\n        // Create completion for ID-based reference (mdocx://media/id)\r\n        const idRef = `mdocx://media/${item.id}`;\r\n        const idCompletion = new vscode.CompletionItem(\r\n          idRef,\r\n          vscode.CompletionItemKind.Reference\r\n        );\r\n        idCompletion.detail = `${item.mimeType || 'media'} by ID`;\r\n        idCompletion.documentation = new vscode.MarkdownString(\r\n          `**Media ID:** ${item.id}\\n\\n**Path:** ${item.path || 'N/A'}\\n\\n**Type:** ${item.mimeType || 'unknown'}\\n\\n**Size:** ${this.formatBytes(item.size)}`\r\n        );\r\n        idCompletion.insertText = idRef;\r\n        idCompletion.sortText = '1_' + item.id; // Sort IDs after paths\r\n        completions.push(idCompletion);\r\n      }\r\n\r\n      // If we're at the start of image syntax, offer to complete the full syntax\r\n      if (/!\\[$/.test(textBefore)) {\r\n        for (const item of mediaItems) {\r\n          if (item.mimeType?.startsWith('image/')) {\r\n            const fullSyntax = `[${item.id}](${item.path || `mdocx://media/${item.id}`})`;\r\n            const snippetCompletion = new vscode.CompletionItem(\r\n              `Image: ${item.id}`,\r\n              vscode.CompletionItemKind.Snippet\r\n            );\r\n            snippetCompletion.detail = 'Insert complete image markdown';\r\n            snippetCompletion.documentation = new vscode.MarkdownString(\r\n              `Inserts: \\`![${item.id}](${item.path || `mdocx://media/${item.id}`})\\``\r\n            );\r\n            snippetCompletion.insertText = new vscode.SnippetString(\r\n              `[\\${1:${item.id}}](${item.path || `mdocx://media/${item.id}`})`\r\n            );\r\n            snippetCompletion.sortText = '2_' + item.id;\r\n            completions.push(snippetCompletion);\r\n          }\r\n        }\r\n      }\r\n\r\n      return completions;\r\n    } catch {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  private async getMediaItems(mdocxUri: vscode.Uri): Promise<MediaItemInfo[]> {\r\n    try {\r\n      const bytes = await vscode.workspace.fs.readFile(mdocxUri);\r\n      const { readMdocx } = await import('ts-mdocx');\r\n      const doc = await readMdocx(bytes);\r\n\r\n      return (doc.media.items || []).map((item: any) => ({\r\n        id: item.id,\r\n        path: item.path,\r\n        mimeType: item.mimeType,\r\n        size: item.data?.byteLength ?? 0\r\n      }));\r\n    } catch {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  private formatBytes(bytes: number): string {\r\n    if (bytes < 1024) return bytes + ' B';\r\n    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';\r\n    return (bytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n  }\r\n}\r\n\r\ntype MediaItemInfo = {\r\n  id: string;\r\n  path?: string;\r\n  mimeType?: string;\r\n  size: number;\r\n};\r\n"],
  "mappings": "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AA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAmjBvI,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA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",
  "names": ["_a", "require", "l", "mlb", "_b", "i", "fl", "err", "u8", "u16", "i32", "slc", "ec", "b4", "init_esm", "bits", "_a", "fdt", "_b", "exports", "err", "_a", "init", "module", "exports", "exports", "decompress", "exports", "compress", "exports", "exports", "exports", "init", "exports", "exports", "exports", "exports", "hashTable", "decompress", "compress", "initZstdWasm", "zstdDecompress", "lz4Decompress", "zstdWasmCompress", "lz4Compress", "out", "payloadWriter", "options", "path", "createHash", "TextDecoder", "TextEncoder", "sha256", "vscode", "vscode", "import_util", "escape", "html", "link", "lexer", "options", "list", "tag", "text", "block", "parser", "tokens", "args", "ret", "walkTokens", "src", "readMdocx", "writeMdocxAsync", "path", "readMdocx", "MediaResolver", "html", "writeMdocxAsync", "options", "walkTokens", "vscode", "readMdocx", "writeMdocxAsync"]
}
